!function(e){"use strict";window.Hustle=function(e,t,i){var s={},o={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g},n=function(o,n){var a=o.split(".");if(a.length){var d=function(s,o){var a=s.split("."),l=a.splice(0,1)[0];if(l){if(a.length)o[l]=o[l]||{};else{var r=n.call(null,e,t,i);o[l]=_.isFunction(r)||"undefined"==typeof r?r:_.extend(o[l]||{},r)}a.length&&l&&d(a.join("."),o[l])}};d(o,s)}else{var l=s[o]||{};s[o]=_.extend(l,n.call(null,e,t,i))}},a=function(){return s},d=function(e){if(e.split(".").length){var t=!1,i=function(e,s){var o=e.split("."),n=o.splice(0,1)[0];t=s[n],o.length&&i(o.join("."),s[n])};return i(e,s),t}return s[e]||!1},l=_.extend({},Backbone.Events),r=Backbone.View.extend({__base_events:{"click .wph-tabs--wrap .wph-tabs--nav li label":"__base_toggle_tab"},initialize:function(){this.events=_.extend({},this.events,this.__base_events),_.isFunction(this.init_mix)&&this.init_mix.apply(this,arguments),this.render&&(this.render=_.wrap(this.render,function(e){this.trigger("before_render"),e.call(this),l.trigger("view.rendered",this),this.trigger("rendered")})),_.isFunction(this.init)&&this.init.apply(this,arguments)},__base_toggle_tab:function(e){var t=this.$(e.target),i=(t.attr("href")||"").replace(/^\#/,""),s=!!i&&this.$("#"+i),o=t.closest(".wph-tabs--wrap"),n=t.closest("li");s&&s.length&&(o.find(".wph-tabs--content").not(s).removeClass("current"),s.addClass("current"),n.addClass("current"),n.siblings().removeClass("current"))}}),c=_.memoize(function(e){var t;return function(i){return t=t||_.template(document.getElementById(e).innerHTML,null,o),t(i).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),u=_.memoize(function(e){var t;return function(i){return(t=t||_.template(e,null,o))(i)}}),p=function(){return e.extend(!0,{},o)},m=function(){var t=function(e){var t,i,s,o=document.cookie.split(";");for(s=e+"=",t=0;t<o.length;t+=1){for(i=o[t];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(s)){var n=i.substring(s.length,i.length);return n?JSON.parse(n):n}}return null},i=function(t,i,s){var o,n;i=e.isArray(i)||e.isPlainObject(i)?JSON.stringify(i):i,isNaN(s)?n="":(o=new Date,o.setTime(o.getTime()+24*s*60*60*1e3),n="; expires="+o.toGMTString()),document.cookie=t+"="+i+n+"; path=/"};return{set:i,get:t}}(),h=function(){return{Module_Show_Count:"hustle_module_show_count-"}}();return{define:n,get_modules:a,get:d,Events:l,View:r,template:c,create_template:u,get_template_options:p,cookie:m,consts:h}}(jQuery,document,window)}(jQuery);var Optin=Optin||{};Optin.View={},Optin.Models={},Optin.Events={},"undefined"!=typeof Backbone&&_.extend(Optin.Events,Backbone.Events),function(e){"use strict";Optin.COOKIE_PREFIX="inc_optin_long_hidden-",Optin.POPUP_COOKIE_PREFIX="inc_optin_popup_long_hidden-",Optin.SLIDE_IN_COOKIE_PREFIX="inc_optin_slide_in_long_hidden-",Optin.SLIDE_IN_COOKIE_HIDE_ALL="inc_optin_slide_in_hide_all",Optin.EMBEDDED_COOKIE_PREFIX="inc_optin_embedded_long_hidden-",Optin.global_mixin=function(){_.mixin({log:function(){console.log(arguments)},toBool:function(e){return _.isBoolean(e)?e:_.isString(e)&&["true","false","1"].indexOf(e.toLowerCase())!==-1?"true"===e.toLowerCase()||"1"===e.toLowerCase():_.isNumber(e)?!!e:!(_.isUndefined(e)||_.isNull(e)||_.isNaN(e))&&e},isTrue:function(e){return!(_.isUndefined(e)||_.isNull(e)||_.isNaN(e))&&(_.isNumber(e)?0!==e:(e=e.toString().toLowerCase(),["1","true","on"].indexOf(e)!==-1))},isFalse:function(e){return!_.isTrue(e)},control_base:function(e,t,i){return i=_.isUndefined(i)?"checked":i,e=_.toBool(e),t=_.isBoolean(e)?_.isTrue(t):t,_.isEqual(e,t)?i+"="+i:""},checked:function(e,t){return _.control_base(e,t,"checked")},selected:function(e,t){return _.control_base(e,t,"selected")},disabled:function(e,t){return _.control_base(e,t,"disabled")},"class":function(e,t,i){return _.isTrue(e)?t:"undefined"!=typeof i?i:""},add_class:function(e,t,i){return"class={class}".replace("{class}",_["class"](e,t,i))},toUpperCase:function(e){return _.isString(e)?e.toUpperCase():""}}),_.findKey||_.mixin({findKey:function(e,t,i){t=cb(t,i);for(var s,o=_.keys(e),n=0,a=o.length;n<a;n++)if(s=o[n],t(e[s],s,e))return s}})},Optin.global_mixin(),Backbone.Model.prototype.toJSON=function(){var e=_.clone(this.attributes);for(var t in e)(e[t]instanceof Backbone.Model||Backbone.Collection&&e[t]instanceof Backbone.Collection)&&(e[t]=e[t].toJSON());return e},String.prototype.toInt=function(){return parseInt(this,10)},String.prototype.isEmpty=function(){return 0===this.length||!this.trim()},Optin.template=_.memoize(function(t){var i,s={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return function(o){return i=i||_.template(e("#"+t).html(),null,s),i(o).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),Optin.template_compat=_.memoize(function(t){var i;return function(s){return i=i||_.template(e("#"+t).html()),i(s).replace("/*<![CDATA[*/","").replace("/*]]>*/","")}}),Optin.cookie=Hustle.cookie,e(document).on("blur",".hustle-modal-optin_form input, .hustle-modal-optin_form textarea, .hustle-modal-optin_form select",function(){var t=e(this);t.is(":input[type=button], :input[type=submit], :input[type=reset]")||(t.val()&&t.val().trim&&""!==t.val().trim()?t.closest(".hustle-modal-optin_field").addClass("hustle-input-filled"):t.closest(".hustle-modal-optin_field").removeClass("hustle-input-filled"))}),Optin.Mixins={_mixins:{},_services_mixins:{},_desing_mixins:{},_display_mixins:{},add:function(e,t){this._mixins[e]=t},get_mixins:function(){return this._mixins},add_services_mixin:function(e,t){this._services_mixins[e]=t},get_services_mixins:function(){return this._services_mixins}}}(jQuery),Hustle.define("Modal_Email",function(e){"use strict";var t={};return Backbone.View.extend({id:"wph-modal-email",className:"wpmudev-modal",template:Optin.template("hustle-modal-email-tpl"),list_header_template:Optin.template("wpoi-email-list-header-tpl"),list_template:Optin.template("wpoi-emails-list-tpl"),show_delay:350,events:{"click .wpmudev-modal-mask, .wpmudev-i_close, .wpmudev-i_close path":"hide"},initialize:function(){return this.render()},render:function(){var i=this,s=this.template(this.model);return s=s.replace("__id",this.model.id),s=s.replace("__type",this.model.type),this.$el.html(s),t[this.model.id]||(t[this.model.id]=e.ajax({url:ajaxurl,type:"GET",data:{action:"hustle_get_email_lists",id:i.model.id,_ajax_nonce:e("#hustle_get_emails_list_nonce").val()}}),this.delay_show=0),t[this.model.id].then(function(e){if(e.success){var t=e.data.module_fields,s=[];i.model.module_fields.length||(i.model.module_fields=t,i.$(".wpmudev-listing-head").html(i.list_header_template({module_fields:t})),_.each(t,function(e){s.push({name:e.name,label:e.label})}));var o=i.list_template({subscriptions:e.data.subscriptions,module_fields:s});i.$(".wpmudev-listing-body").html(o)}}),this.$el.appendTo("#wpmudev-hustle"),this.show(),this},show:function(){e("body").addClass("wpmudev-modal-is_active"),this.$el.addClass("wpmudev-modal-active"),this.$el.find(".wpmudev-box-modal").addClass("wpmudev-show").removeClass("wpmudev-hide")},close:function(e){e.preventDefault(),this.$el.removeClass("show"),_.delay(function(){this.remove()}.bind(this),350)},hide:function(t){var i=e(t.target),s=this.$el.find(".wpmudev-box-modal"),o=this;(i.hasClass("wpmudev-modal-mask")||i.hasClass("wpmudev-i_close")||i.parent().hasClass("wpmudev-i_close"))&&(s.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){o.$el.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),s.removeClass("wpmudev-hide")},500))}})}),Hustle.define("Modal_Error",function(e){"use strict";var t=Backbone.View.extend({template:Optin.template("hustle-error-list-tpl"),className:"wpmudev-listing-row",controller:!1,initialize:function(e){this.controller=e.controller,this.module_fields=e.module_fields,this.render()},render:function(){var e=this.template({model:this.model,module_fields:this.module_fields});this.$el.html(e),this.$el.appendTo(this.controller.$(".wpmudev-listing-body"))}});return Backbone.View.extend({id:"wph-modal-error",template:Optin.template("hustle-modal-error-tpl"),list_header_template:Optin.template("hustle-error-header-list-tpl"),className:"wpmudev-modal",events:{"click .inc-opt-close-error-list":"toggleErrorLog","click .wpmudev-button-clear-logs":"clearLogs","click .wpmudev-button-delete-logs":"_clean","click .wpmudev-button-cancel-delete-logs":"cancelDelete","click .wpmudev-modal-mask, .wpmudev-i_close, .wpmudev-i_close path":"hide"},initialize:function(e){return this.$el.html(this.template({id:this.model.id})),this.button=e.button,this.render()},render:function(){var i=this,s=this.template(this.model);return s=s.replace("__id",this.model.id),s=s.replace("__type",this.model.type),this.clearLogButton=this.$(".wpmudev-button-clear-logs"),this.exportButton=this.$(".wpmudev-button-download-csv"),this.deleteConfirmation=this.$(".hustle-delete-logs-confirmation"),e.getJSON(window.ajaxurl,{id:this.model.id,_wpnonce:optin_vars.error_log_nonce,action:"get_error_list"},function(e){if(e.success&&e.data&&e.data.logs){var s=e.data.module_fields;i.model.module_fields=s,i.$(".wpmudev-listing-head").html(i.list_header_template({module_fields:s})),_.each(e.data.logs,function(e){new t({module_fields:s,model:e,controller:i})}),i.show()}}),this.$el.html(s),e("#wph-modal-error").length>0?e("#wph-modal-error").html(this.$el):this.$el.appendTo("#wpmudev-hustle"),this.show(),this},show:function(){e("body").addClass("wpmudev-modal-is_active"),this.$el.addClass("wpmudev-modal-active"),this.$el.find(".wpmudev-box-modal").addClass("wpmudev-show").removeClass("wpmudev-hide")},hide:function(t){var i=e(t.target),s=this.$el.find(".wpmudev-box-modal"),o=this;(i.hasClass("wpmudev-modal-mask")||i.hasClass("wpmudev-i_close")||i.parent().hasClass("wpmudev-i_close"))&&(s.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){o.$el.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),s.removeClass("wpmudev-hide")},500))},toggleErrorLog:function(){this.$el.removeClass("show")},clearLogs:function(t){e(t.target).parents(".wpmudev-footer-clear").find(".hustle-delete-logs-confirmation").removeClass("wpmudev-hidden"),this.clearLogButton.attr("disabled",!0),this.exportButton.attr("disabled",!0)},_clean:function(){var t=this;e.get(window.ajaxurl,{id:this.model.id,_wpnonce:optin_vars.clear_log_nonce,action:"clear_logs"},function(e){e.success&&(t.toggleErrorLog(),_.delay(function(){t.button.remove(),t.remove()},350))})},cancelDelete:function(t){e(t.target).parents(".hustle-delete-logs-confirmation").addClass("wpmudev-hidden"),this.clearLogButton.removeAttr("disabled"),this.exportButton.removeAttr("disabled")}})}),Hustle.define("Modal_Import",function(e){"use strict";return Backbone.View.extend({id:"wph-modal-import",className:"wpmudev-modal",template:Optin.template("hustle-modal-import-tpl"),show_delay:350,events:{"click .wpmudev-button-confirm-import":"import","click .wpmudev-button-cancel-import":"cancelImport","click .wpmudev-modal-mask, .wpmudev-i_close, .wpmudev-i_close path":"hide","click #wpmudev-button-import":"preImport"},initialize:function(){return this.render()},render:function(){var e=this.template(this.model);return this.importButton=this.$("#wpmudev-button-import"),this.$el.html(e),this.$el.appendTo("#wpmudev-hustle"),this.show(),this},cancelImport:function(t){e(t.target).parents(".hustle-confirmation").addClass("wpmudev-hidden"),this.importButton.prop("disabled",!1)},preImport:function(t){e("#wph-optin-service-import-form input").val()&&(e(t.target).parents(".wpmudev-box-footer").find(".hustle-confirmation").removeClass("wpmudev-hidden"),this.importButton.prop("disabled",!0))},"import":function(t){var i,s=e(t.target),o=e("#wph-optin-service-import-form input[type=file]").get(0).files[0];i=new FormData,i.append("action","hustle_import_module"),i.append("id",s.data("id")),i.append("type",s.data("type")),i.append("_ajax_nonce",s.data("nonce")),i.append("file",o),e.ajax({url:ajaxurl,type:"POST",data:i,cache:!1,processData:!1,contentType:!1,success:function(t){t.success?location.reload():(e("#import_error").html(e("<label><span>"+t.data+"</span></label>").prop({"class":"wpmudev-label--notice"})),e("#import_error label").delay(5e3).fadeOut("slow",function(){e(this).remove()}))}})},show:function(){e("body").addClass("wpmudev-modal-is_active"),this.$el.addClass("wpmudev-modal-active"),this.$el.find(".wpmudev-box-modal").addClass("wpmudev-show").removeClass("wpmudev-hide")},hide:function(t){var i=e(t.target),s=this.$el.find(".wpmudev-box-modal"),o=this;(i.hasClass("wpmudev-modal-mask")||i.hasClass("wpmudev-i_close")||i.parent().hasClass("wpmudev-i_close"))&&(s.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){o.$el.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),s.removeClass("wpmudev-hide")},500))}})}),function(e){"use strict";Hustle.Events.on("modules.view.rendered",function(t){Hustle.Events.trigger("modules.view.select.render",t),t instanceof Backbone.View&&(e(".wpmudev-box-close").each(function(){var t=e(this),i=t.find(".wpmudev-box-action"),s=t.find(".wpmudev-box-body");i.on("click",function(e){e.stopPropagation(),s.slideToggle()})}),e(".wpmudev-box-close").each(function(){var t=e(this),i=t.find(".wpmudev-i_close");i.on("click",function(e){e.stopPropagation(),t.removeClass("wpmudev-show").addClass("wpmudev-hide")})}),function(){function t(){var t=e(window).scrollTop(),i=e(".wpmudev-preview-anchor");i.length&&(i=i.offset().top,t>i?(e(".wpmudev-menu").addClass("wpmudev-preview-on"),e(".wpmudev-preview").addClass("wpmudev-preview-sticky"),e(".wpmudev-preview-anchor").height(e(".wpmudev-preview").outerHeight())):(e(".wpmudev-menu").removeClass("wpmudev-preview-on"),e(".wpmudev-preview").removeClass("wpmudev-preview-sticky"),e(".wpmudev-preview-anchor").height(0)))}e(function(){e(window).scroll(t),t()})}(),e("#wph-add-new-service-modal").each(function(){var t=e(this),i=(e("#wph-add-another-service"),t.find(".wpmudev-i_close")),s=t.find("#wph-cancel-add-service"),o=t.find(".wpmudev-box-modal");i.on("click",function(i){i.stopPropagation(),o.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),o.removeClass("wpmudev-hide")},1e3)}),s.on("click",function(i){i.preventDefault(),i.stopPropagation(),o.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),o.removeClass("wpmudev-hide")},1e3)})}),e("input#group_instructions").each(function(){var t=e(this);t.val('<label class="wpmudev-label--notice">'+skbl+"</label>")}),e("#wph-edit-form-modal").each(function(){var t=e(this),i=(e("#wph-edit-form"),t.find(".wpmudev-i_close")),s=t.find("#wph-cancel-edit-form"),o=t.find(".wpmudev-box-modal");i.on("click",function(i){i.stopPropagation(),o.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),o.removeClass("wpmudev-hide")},1e3)}),s.on("click",function(i){i.preventDefault(),i.stopPropagation(),o.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),o.removeClass("wpmudev-hide")},1e3)})}),e("#wph-preview-modal").each(function(){var i=e(this),s=(e(".wpmudev-preview"),i.find(".hustle-modal"),i.find(".hustle-modal-success")),o=(i.find(".hustle-modal-close .hustle-icon"),i.find(".hustle-modal-cta")),n=i.find("a"),a=i.find("button");o.on("click",function(e){e.preventDefault()}),n.on("click",function(e){e.preventDefault()}),s.length?a.on("click",function(e){e.preventDefault(),s.addClass("hustle-modal-success_show"),Hustle.Events.trigger("modules.view.preview.success",t)}):a.on("click",function(e){e.preventDefault()})}),e(".wpmudev-table-body-row").each(function(){var t=e(this),i=t.find(".wpmudev-preview-item-manage");i.click(function(e){e.stopPropagation(),t.toggleClass("wpmudev-open")})}),e(".hustle-modal-three .hustle-modal-optin_form").each(function(){var t=e(this),i=t.find(".hustle-modal-optin_field"),s=e('<div class="hustle-modal-optin_half" />'),o=i.length;if(t.hasClass("hustle-modal-optin_groups")){t.find(".hustle-modal-optin_group").addClass("hustle-modal-half_enabled");for(var n=0;n<o;n+=2)i.filter(":eq("+n+"),:eq("+(n+1)+")").wrapAll(s)}}),e(".hustle-modal-four .hustle-modal-optin_form").each(function(){var t=e(this),i=t.find(".hustle-modal-optin_field"),s=e('<div class="hustle-modal-optin_half" />'),o=i.length;if(t.hasClass("hustle-modal-optin_groups")){t.find(".hustle-modal-optin_group").addClass("hustle-modal-half_enabled");for(var n=0;n<o;n+=2)i.filter(":eq("+n+"),:eq("+(n+1)+")").wrapAll(s)}}),console.log("view rendered"))});var t={allowClear:!1,containerCssClass:"wpmudev-select2",dropdownCssClass:"wpmudev-select2-dropdown",tags:"true",width:"100%",createTag:function(){return!1}};pagenow.indexOf("listing")!==-1&&(t.minimumResultsForSearch=-1);var i=function(){e(".wpmudev-select").wpmuiSelect(t)};i(),e(document).ready(function(){e("#hustle-notice-pro-is-available .notice-dismiss").on("click",function(t){var i={action:"hustle_dismiss_admin_notice",dismissed_notice:"hustle_pro_is_available"};e.post(ajaxurl,i,function(e){})})}),Hustle.Events.on("modules.view.select.render",function(e){i()})}(jQuery),Hustle.define("Delete_Confirmation",function(e){"use strict";return Backbone.View.extend({el:"#wph-delete-module-confirmation",opts:{id:"",multiple:0,ids:"",nonce:"",action:"",url:ajaxurl},events:{"click .hustle-delete-module-confirm":"confirm","click .hustle-delete-module-cancel":"cancel"},initialize:function(e){this.opts=_.extend({},this.opts,e)},confirm:function(t){t.preventDefault(),t.stopPropagation();var i=this,s=this.$(t.target);s.addClass("wpmudev-button-onload"),e.ajax({url:this.opts.url,type:"POST",data:{action:this.opts.action,_ajax_nonce:this.opts.nonce,id:this.opts.id,multiple:this.opts.multiple,ids:this.opts.ids},success:function(e){i.opts.onSuccess&&_.isFunction(i.opts.onSuccess)&&i.opts.onSuccess.call(this,e,i)}})},cancel:function(e){e.preventDefault(),e.stopPropagation(),this.$el.removeClass("wpmudev-modal-active")}})}),Hustle.define("Featured_Image_Holder",function(e){"use strict";return Backbone.View.extend({template:Optin.template("wph-popup-choose_image"),target_div:"",media_frame:!1,options:{attribute:"feature_image",title:optin_vars.messages.media_uploader.select_or_upload,button_text:optin_vars.messages.media_uploader.use_this_image,multiple:!1},initialize:function(t){if(this.options=_.extend({},this.options,t),!this.model||!this.options.attribute)throw new Error("Undefined model or attribute");t.module_type&&(this.template=Optin.template("wph-"+t.module_type+"-choose_image")),this.target_div=t.target_div,e(document).on("click","button#wpmudev-feature-image-browse",e.proxy(this.open,this)),e(document).on("click",".wpmudev-feature-image-src-input_text",e.proxy(this.open,this)),e(document).on("click","button#wpmudev-feature-image-clear",e.proxy(this.clear,this)),this.render()},render:function(){var e=this.template({image:this.model.get(this.options.attribute)});return this.setElement(e),this.define_media_frame(),this.show_or_hide_clear_button(),this},show_or_hide_clear_button:function(){var e=this.model.get("feature_image");""===e||"undefined"==typeof e?(this.$el.find(".wpmudev-clear_image .wpmudev-button").hide(),this.$el.find(".wpmudev-feature-image-src-input_text").css("pointer-events","auto")):(this.$el.find(".wpmudev-clear_image .wpmudev-button").show(),this.$el.find(".wpmudev-feature-image-src-input_text").css("pointer-events","none"))},define_media_frame:function(){var e=this;this.media_frame=wp.media({title:e.options.title,button:{text:e.options.button_text},multiple:e.options.multiple}).on("select",function(){var t=e.media_frame.state().get("selection").first().toJSON();if(t&&t.url){var i=t.url,s="";t.sizes&&t.sizes.thumbnail&&t.sizes.thumbnail.url&&(s=t.sizes.thumbnail.url),e.target_div.find(".wpmudev-feature-image-src-input_text").val(i),e.target_div.find(".wpmudev-inserted_image").css("background-image","url("+s+")"),e.model.set("feature_image",i,{silent:!0}),e.show_or_hide_clear_button()}})},open:function(e){e.preventDefault(),this.media_frame.open()},clear:function(e){e.preventDefault(),this.target_div.find(".wpmudev-feature-image-src-input_text").val(""),this.target_div.find(".wpmudev-inserted_image").css("background-image","url()"),this.model.set("feature_image","",{silent:!0}),this.show_or_hide_clear_button()}})}),Hustle.define("Media_Holder",function(){"use strict";return Backbone.View.extend({template:Optin.template("hustle-media-holder-tpl"),media_frame:!1,options:{attribute:"image",title:optin_vars.messages.media_uploader.select_or_upload,button_text:optin_vars.messages.media_uploader.use_this_image,multiple:!1},events:{"click .wph-media--add":"open","click .wph-button--dots":"toggle_options","click .i-close":"toggle_options","click .wpoi-swap-image-button":"swap_image","click .wpoi-delete-image-button":"delete_image"},initialize:function(e){if(this.options=_.extend({},this.options,e),!this.model||!this.options.attribute)throw new Error("Undefined model or attribute");jQuery(document).on("click",this.close_media_options),this.render()},render:function(){var e=this.template({image:this.model.get(this.options.attribute)});return this.setElement(e),this.define_media_frame(),this},define_media_frame:function(){var e=this,t=this.$(".wph-media--preview"),i=this.$(".wph-media--holder"),s=this.$(".wph-media--options");this.media_frame=wp.media({title:e.options.title,button:{text:e.options.button_text},multiple:e.options.multiple}).on("select",function(){var o=e.media_frame.state().get("selection").first().toJSON();o&&o.url&&(t.css("background-image","url({url})".replace("{url}",o.url)),i.addClass("has-image"),e.model.set(e.options.attribute,o.url),s.removeClass("hidden"),e.$(".wph-media--add").addClass("hidden"))})},open:function(e){e.preventDefault();var t=this.$(".wph-media--holder");t.removeClass("has-image"),this.media_frame.open()},toggle_options:function(){this.$("wph-media--list").toggleClass("wph-open"),this.$(".wph-media--items").toggleClass("hidden"),this.$(".svg-triangle").toggleClass("hidden")},close_media_options:function(e){var t=jQuery(e.target),i=t.closest(".wph-media--list");if(0===i.length&&!t.hasClass("wph-button wph-button--dots")){var s=jQuery(".wph-media--list"),o=s.find(".wph-media--items"),n=s.find(".svg-triangle");o.hasClass("hidden")||o.addClass("hidden"),n.hasClass("hidden")||n.addClass("hidden")}},swap_image:function(e){e.preventDefault(),this.media_frame&&(this.media_frame.open(),this.toggle_options())},delete_image:function(e){e.preventDefault();var t=this.$(".wph-media--preview");this.model.set(this.options.attribute,""),t.css("background-image","url('')"),this.toggle_options(),this.$(".wph-media--add").removeClass("hidden"),this.$(".wph-media--options").addClass("hidden")}})}),Hustle.define("Upgrade_Modal",function(e){"use strict";return Backbone.View.extend({el:"#wph-upgrade-modal",opts:{},events:{"click .wpmudev-i_close":"close"},initialize:function(e){this.opts=_.extend({},this.opts,e)},close:function(e){e.preventDefault(),e.stopPropagation(),this.$el.removeClass("wpmudev-modal-active")}})}),Hustle.define("Mixins.Model_Updater",function(e,t,i){"use strict";return{init_mix:function(){this.events=_.extend({},this.events,this._events),this.delegateEvents()},_events:{"change input[type='text']":"_update_text","change input[type='number']":"_update_text","change input[type='checkbox']":"_update_checkbox","change input[type=radio]":"_update_radios","change select":"_update_select"},_update_text:function(t){var i=e(t.target),s=i.data("attribute"),o=this[i.data("model")||"model"],n=_.isTrue(i.data("silent"))?{silent:!0}:{};o&&s&&(t.stopPropagation(),o.set.call(o,s,t.target.value,n))},_update_checkbox:function(t){var i=e(t.target),s=i.data("attribute"),o=this[i.data("model")||"model"],n=_.isTrue(i.data("silent"))?{silent:!0}:{};o&&s&&(t.stopPropagation(),o.set.call(o,s,i.is(":checked")?1:0,n))},_update_radios:function(t){var i=e(t.target),s=i.data("attribute"),o=this[i.data("model")||"model"],n=_.isTrue(i.data("silent"))?{silent:!0}:{};o&&s&&(t.stopPropagation(),o.set.call(o,s,t.target.value,n))},_update_select:function(t){var i=e(t.target),s=i.data("attribute"),o=this[i.data("model")||"model"],n=_.isTrue(i.data("silent"))?{silent:!0}:{};o&&s&&(t.stopPropagation(),o.set.call(o,s,i.val(),n))}}}),Hustle.define("Settings.Conditions_View",function(e){"use strict";return Hustle.View.extend({template:Optin.template("wph-wizard-module-conditions"),handle_tpl:Optin.template("wph-wizard-module-conditions-handle"),className:"wph-conditions",events:{"click .wph-conditions--side .wph-conditions--item:not(.disabled)":"toggle_condition","click .wph-conditions--side .wph-conditions--item:not(.disabled) span":"toggle_condition","click .wph-conditions--item header":"toggle_panel"},init:function(e){this.type=e.type,this.active_conditions={},this.listenTo(this.model,"change",this.toggle_empty_message),this.render()},render:function(){var e=this.model.toJSON();this.$el.html(this.template({type_name:this.type})),_.each(Optin.View.Conditions,function(t,i){var s=this.handle_tpl({label:this.get_label(i),id:i,cid:this.get_condition_cid(i),active_class:e[i]?"added":"",icon_class:e[i]?"wph-condition-remove":"wph-condition-add"});this.$(".wph-conditions--side .wph-conditions--items").append(s)},this),_.each(e,function(e,t){this.add_condition_panel(t)},this),this.toggle_empty_message()},get_condition_cid:function(e){return e=e.replace(/ /g,""),this.type+"_"+e},get_label:function(e){var t=optin_vars.messages.settings[this.type]?optin_vars.messages.settings[this.type]:this.type;return optin_vars.messages.conditions[e]?optin_vars.messages.conditions[e].replace("{type_name}",t):e},take_care_of_connected_conditions:function(e){e.disable&&e.disable.length&&_.each(e.disable,function(e,t){var i=this.$("#"+this.get_condition_cid(e));i.toggleClass("disabled")},this)},add_condition:function(e,t){var i=this.add_condition_panel(e);return t.addClass("added"),t.find("span").addClass("wpoi-remove"),t.find("span").removeClass("wpoi-add"),this.model.set(e,i.get_configs()),this.model.toJSON()},remove_condition:function(e,t,i){this.take_care_of_connected_conditions(t),t.off("change:update_label"),t.remove(),delete this.active_conditions[e],i.removeClass("added"),i.find("span").removeClass("wpoi-remove"),i.find("span").addClass("wpoi-add"),this.model.unset(e)},add_condition_panel:function(e){if("undefined"!=typeof Optin.View.Conditions[e]){var t=this.active_conditions[e]=new Optin.View.Conditions[e]({model:this.model,type:this.type});_.isEmpty(this.active_conditions)&&this.$(".wph-conditions--box .wph-conditions--items").html(""),this.take_care_of_connected_conditions(t);var i=this;return t.on("change:update_label",function(){i.trigger("change:update_view_label",i)}),this.$(".wph-conditions--box .wph-conditions--items").append(t.$el),t}},toggle_condition:function(e){e.stopPropagation();var t=this.$(e.target).data("id")||this.$(e.target).closest(".wph-conditions--item").data("id"),i=this.$("#"+this.get_condition_cid(t)),s=this.active_conditions[t];s?(this.remove_condition(t,s,i),this.trigger("condition_removed",this,t,s)):(this.add_condition(t,i),this.trigger("condition_added",this,t,s)),this.trigger("toggle_condition",this,t,s)},toggle_empty_message:function(){this.model.isEmpty()?this.$(".wph-conditions--box .wph-conditions--items").addClass("wph-conditions-is_empty"):this.$(".wph-conditions--box .wph-conditions--items").removeClass("wph-conditions-is_empty"),this.model.isEmpty()?this.$(".wph-conditions--empty").show():this.$(".wph-conditions--empty").hide()},toggle_panel:_.debounce(function(t){var i=e(t.target),s=i.closest(".wph-conditions--item"),o=s.find("section");o.slideToggle(300,function(){s.toggleClass("wph-conditions--closed wph-conditions--open")})},300),get_conditions_labels:function(){var e=_.pluck(this.active_conditions,"label"),t=Hustle.create_template("<span>{{label}}</span>");return e.length?e.map(function(e){return t({label:e})}).join(", "):optin_vars.messages.condition_labels.everywhere},get_all_conditions_labels:function(){var e=this.active_conditions,t={posts:{label:optin_vars.messages.condition_labels.all_posts},pages:{label:optin_vars.messages.condition_labels.all_pages},categories:{label:optin_vars.messages.condition_labels.all_categories},tags:{label:optin_vars.messages.condition_labels.all_tags}},i=[];for(var s in t)"undefined"==typeof e[s]&&i.push(t[s].label);var o=_.pluck(e,"label"),n=Hustle.create_template("<span>{{label}}</span>");return o=o.concat(i),o.length?o.map(function(e){return n({label:e})}).join(", "):optin_vars.messages.condition_labels.everywhere}})}),function(e){"use strict";Optin.View.Conditions=Optin.View.Conditions||{};var t=Hustle.View.extend({condition_id:"",className:"wph-conditions--item wph-conditions--open",_template:Optin.template("wph-wizard-module-conditions-item"),template:!1,_defaults:{type_name:"",condition_name:"",label:""},_events:{"change input":"change_input","change textarea":"change_input","change select":"change_input"},init:function(t){return this.type=t.type,this.id=this.type+"-"+this.condition_id,this.template="undefined"!=typeof this.cpt?Optin.template("wpoi-condition-post_type"):Optin.template("wpoi-condition-"+this.condition_id),this._defaults={type_name:optin_vars.messages.settings[this.type]?optin_vars.messages.settings[this.type]:this.type,condition_name:optin_vars.messages.conditions[this.condition_id]?optin_vars.messages.conditions[this.condition_id]:this.condition_id},this.data=this.get_data(),this.render(),this.events=e.extend(!0,{},this.events,this._events),this.delegateEvents(),this.on_init&&_.isFunction(this.on_init)&&this.on_init.apply(this,arguments),this},get_data:function(){return _.extend({},this._defaults,this.defaults,this.model.get(this.condition_id),{type:this.type})},get_title:function(){return this.title.replace("{type_name}",this.data.type_name)},get_body:function(){return"function"==typeof this.body?this.body.apply(this,arguments):this.body.replace("{type_name}",this.data.type_name)},get_header:function(){return""},render:function(){this.$el.html("");var t=this._template(_.extend({},{title:this.get_title(),body:this.get_body(),header:this.get_header()},this._defaults,{type:this.type}));return this.$el.html(t),e(".wph-conditions--box .wph-conditions--item:not(:last-child)").removeClass("wph-conditions--open").addClass("wph-conditions--closed"),e(".wph-conditions--box .wph-conditions--item:not(:last-child) section").hide(),this.rendered&&"function"==typeof this.rendered&&this.rendered.apply(this,arguments),this},update_attribute:function(e,t){this.data=this.model.get(this.condition_id),this.data[e]=t,this.model.set(this.condition_id,this.data)},get_attribute:function(e){var t=this.model.get(this.condition_id);return!(!t||!t[e])&&t[e]},refresh_label:function(){this.$el.find(".wph-condition--preview").html("");var e=this.get_header();this.$el.find(".wph-condition--preview").html(e)},change_input:function(t){var i=t.target,s=i.getAttribute("data-attribute"),o=e(i),n=o.is(".js-wpoi-select")?o.val():t.target.value;if(o.is(".select2-search__field"))return!1;var a=this.update_attribute(s,n);return this.refresh_label(),a},get_configs:function(){return this.defaults||!0}}),i=function(t){e(".wph-conditions--items").data("select2ScrollPosition",{})},s=function(t){var i=["all"];t.params&&t.params.args&&t.params.args.data&&t.params.args.data.id&&"all"===t.params.args.data.id||(i=e(this).val(),i&&-1!==i.indexOf("all")?i.splice(i.indexOf("all"),1):i=(i||[]).concat([t.params.args.data.id]),
i&&i.length||(i=[t.params.args.data.id])),e(this).val(i).trigger("change")},o={events:{"change input[type='radio']":"set_current_li"},set_current_li:function(t){var i=e(t.target),s=i.closest("li");s.siblings().removeClass("current"),s.toggleClass("current",i.is(":checked"))}};Optin.View.Conditions.posts=t.extend(_.extend({},o,{condition_id:"posts",title:optin_vars.messages.conditions.posts,label:optin_vars.messages.condition_labels.posts,defaults:{filter_type:"only",posts:[]},on_init:function(){this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("posts"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_posts:optin_vars.messages.condition_labels.no_posts:this.get_attribute("posts").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("posts").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_posts:optin_vars.messages.condition_labels.all_posts},update_label:function(){this.get_attribute("posts").length&&!_.contains(this.get_attribute("posts"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("posts").length?this.get_attribute("posts").length:0):_.contains(this.get_attribute("posts"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_posts:optin_vars.messages.condition_labels.no_posts:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_posts:optin_vars.messages.condition_labels.all_posts},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",ajax:{url:ajaxurl,delay:250,dataType:"json",type:"POST",data:function(e){var t={action:"get_new_condition_ids",search:e.term,post_type:"post"};return t},processResults:function(e){return{results:e.data}},cache:!0},createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselecting",i)}})),Optin.View.Conditions.pages=t.extend(_.extend({},o,{condition_id:"pages",title:optin_vars.messages.conditions.pages,label:optin_vars.messages.condition_labels.pages,defaults:{filter_type:"only",pages:[]},on_init:function(){this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("pages"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_pages:optin_vars.messages.condition_labels.no_pages:this.get_attribute("pages").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_pages:optin_vars.messages.condition_labels.except_these_pages).replace("{number}",this.get_attribute("pages").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_pages:optin_vars.messages.condition_labels.all_pages},update_label:function(){this.get_attribute("pages").length&&!_.contains(this.get_attribute("pages"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_pages:optin_vars.messages.condition_labels.except_these_pages).replace("{number}",this.get_attribute("pages").length?this.get_attribute("pages").length:0):_.contains(this.get_attribute("pages"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_pages:optin_vars.messages.condition_labels.no_pages:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_pages:optin_vars.messages.condition_labels.all_pages},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",ajax:{url:ajaxurl,delay:250,dataType:"json",type:"POST",data:function(e){var t={action:"get_new_condition_ids",search:e.term,post_type:"page"};return t},processResults:function(e){return{results:e.data}},cache:!0},createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselecting",i)}})),_.each(optin_vars.post_types,function(e,n){var a=e.label.toLowerCase();Optin.View.Conditions[e.label]=t.extend(_.extend({},o,{condition_id:e.label,title:e.label,label:optin_vars.messages.condition_labels.posts,cpt:!0,defaults:{filter_type:"only",selected_cpts:[],post_type:n,post_type_label:e.label},on_init:function(){this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("selected_cpts"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all+" "+a:optin_vars.messages.condition_labels.no+" "+a:this.get_attribute("selected_cpts").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("selected_cpts").length).replace("posts",a):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no+" "+a:optin_vars.messages.condition_labels.all+" "+a},update_label:function(){this.get_attribute("selected_cpts").length&&!_.contains(this.get_attribute("selected_cpts"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_posts:optin_vars.messages.condition_labels.except_these_posts).replace("{number}",this.get_attribute("selected_cpts").length?this.get_attribute("selected_cpts").length:0).replace("posts",a):_.contains(this.get_attribute("selected_cpts"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all+" "+a:optin_vars.messages.condition_labels.no+" "+a:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no+" "+a:optin_vars.messages.condition_labels.all+" "+a},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",ajax:{url:ajaxurl,delay:250,dataType:"json",type:"POST",data:function(e){var t={action:"get_new_condition_ids",search:e.term,post_type:n};return t},processResults:function(e){return{results:e.data}},cache:!0},createTag:function(){return!1}}).on("select2:selecting",s).on("select2:selecting",i).on("select2:unselecting",i)}}))}),Optin.View.Conditions.categories=t.extend(_.extend({},o,{condition_id:"categories",title:optin_vars.messages.conditions.categories,label:optin_vars.messages.condition_labels.categories,defaults:{filter_type:"only",categories:[]},on_init:function(){this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("categories"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_categories:optin_vars.messages.condition_labels.no_categories:this.get_attribute("categories").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_categories:optin_vars.messages.condition_labels.except_these_categories).replace("{number}",this.get_attribute("categories").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_categories:optin_vars.messages.condition_labels.all_categories},update_label:function(){this.get_attribute("categories").length&&!_.contains(this.get_attribute("categories"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_categories:optin_vars.messages.condition_labels.except_these_categories).replace("{number}",this.get_attribute("categories").length?this.get_attribute("categories").length:0):_.contains(this.get_attribute("categories"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_categories:optin_vars.messages.condition_labels.no_categories:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_categories:optin_vars.messages.condition_labels.all_categories},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",ajax:{url:ajaxurl,delay:250,dataType:"json",type:"POST",data:function(e){var t={action:"get_new_condition_ids",search:e.term,post_type:"category"};return t},processResults:function(e){return{results:e.data}},cache:!0},createTag:function(){return!1}}).on("select2:selecting",i).on("select2:unselecting",i)}})),Optin.View.Conditions.tags=t.extend(_.extend({},o,{condition_id:"tags",title:optin_vars.messages.conditions.tags,label:optin_vars.messages.condition_labels.tags,defaults:{filter_type:"only",tags:[]},on_init:function(){this.update_label()},get_header:function(){return this.update_label(),this.trigger("change:update_label",this),_.contains(this.get_attribute("tags"),"all")?"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_tags:optin_vars.messages.condition_labels.no_tags:this.get_attribute("tags").length?("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.only_on_these_tags:optin_vars.messages.condition_labels.except_these_tags).replace("{number}",this.get_attribute("tags").length):"only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_tags:optin_vars.messages.condition_labels.all_tags},update_label:function(){this.get_attribute("tags").length&&!_.contains(this.get_attribute("tags"),"all")?this.label=("only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.number_tags:optin_vars.messages.condition_labels.except_these_tags).replace("{number}",this.get_attribute("tags").length?this.get_attribute("tags").length:0):_.contains(this.get_attribute("tags"),"all")?this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.all_tags:optin_vars.messages.condition_labels.no_tags:this.label="only"===this.get_attribute("filter_type")?optin_vars.messages.condition_labels.no_tags:optin_vars.messages.condition_labels.all_tags},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").wpmuiSelect({tags:"true",width:"100%",ajax:{url:ajaxurl,delay:250,dataType:"json",type:"POST",data:function(e){var t={action:"get_new_condition_ids",search:e.term,post_type:"tag"};return t},processResults:function(e){return{results:e.data}},cache:!0},createTag:function(){return!1}}).on("select2:selecting",i).on("select2:unselecting",i)}})),Optin.View.Conditions.only_on_not_found=t.extend({condition_id:"only_on_not_found",title:optin_vars.messages.conditions.only_on_not_found,label:optin_vars.messages.condition_labels.only_on_not_found,body:optin_vars.messages.conditions_body.only_on_not_found}),Optin.View.Conditions.visitor_logged_in=t.extend({condition_id:"visitor_logged_in",disable:["visitor_not_logged_in"],title:optin_vars.messages.conditions.visitor_logged_in,label:optin_vars.messages.condition_labels.visitor_logged_in,body:optin_vars.messages.conditions_body.visitor_logged_in}),Optin.View.Conditions.visitor_not_logged_in=t.extend({condition_id:"visitor_not_logged_in",disable:["visitor_logged_in"],title:optin_vars.messages.conditions.visitor_not_logged_in,label:optin_vars.messages.condition_labels.visitor_not_logged_in,body:optin_vars.messages.conditions_body.visitor_not_logged_in}),Optin.View.Conditions.shown_less_than=t.extend({condition_id:"shown_less_than",title:optin_vars.messages.conditions.shown_less_than,label:optin_vars.messages.condition_labels.shown_less_than,defaults:{less_than:1},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.only_on_mobile=t.extend({condition_id:"only_on_mobile",disable:["not_on_mobile"],title:optin_vars.messages.conditions.only_on_mobile,label:optin_vars.messages.condition_labels.only_on_mobile,body:optin_vars.messages.conditions_body.only_on_mobile}),Optin.View.Conditions.not_on_mobile=t.extend({condition_id:"not_on_mobile",disable:["only_on_mobile"],title:optin_vars.messages.conditions.not_on_mobile,label:optin_vars.messages.condition_labels.not_on_mobile,body:optin_vars.messages.conditions_body.not_on_mobile}),Optin.View.Conditions.from_specific_ref=t.extend({condition_id:"from_specific_ref",disable:["not_from_specific_ref"],title:optin_vars.messages.conditions.from_specific_ref,label:optin_vars.messages.condition_labels.from_specific_ref,defaults:{refs:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_from_specific_ref=t.extend({condition_id:"not_from_specific_ref",disable:["from_specific_ref"],title:optin_vars.messages.conditions.not_from_specific_ref,label:optin_vars.messages.condition_labels.not_from_specific_ref,defaults:{refs:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_from_internal_link=t.extend({condition_id:"not_from_internal_link",title:optin_vars.messages.conditions.not_from_internal_link,label:optin_vars.messages.condition_labels.not_from_internal_link,body:optin_vars.messages.conditions_body.not_from_internal_link}),Optin.View.Conditions.from_search_engine=t.extend({condition_id:"from_search_engine",title:optin_vars.messages.conditions.from_search_engine,label:optin_vars.messages.condition_labels.from_search_engine,body:optin_vars.messages.conditions_body.from_search_engine}),Optin.View.Conditions.on_specific_url=t.extend({condition_id:"on_specific_url",disable:["not_on_specific_url"],title:optin_vars.messages.conditions.on_specific_url,label:optin_vars.messages.condition_labels.on_specific_url,defaults:{urls:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.not_on_specific_url=t.extend({condition_id:"not_on_specific_url",disable:["on_specific_url"],title:optin_vars.messages.conditions.not_on_specific_url,label:optin_vars.messages.condition_labels.not_on_specific_url,defaults:{urls:""},body:function(){return this.template(this.get_data())}}),Optin.View.Conditions.visitor_has_commented=t.extend({condition_id:"visitor_has_commented",disable:["visitor_has_never_commented"],title:optin_vars.messages.conditions.visitor_has_commented,label:optin_vars.messages.condition_labels.visitor_has_commented,body:optin_vars.messages.conditions_body.visitor_has_commented}),Optin.View.Conditions.visitor_has_never_commented=t.extend({condition_id:"visitor_has_never_commented",disable:["visitor_has_commented"],title:optin_vars.messages.conditions.visitor_has_never_commented,label:optin_vars.messages.condition_labels.visitor_has_never_commented,body:optin_vars.messages.conditions_body.visitor_has_never_commented}),Optin.View.Conditions.in_a_country=t.extend({condition_id:"in_a_country",disable:["not_in_a_country"],title:optin_vars.messages.conditions.in_a_country,label:optin_vars.messages.condition_labels.in_a_country,defaults:{countries:""},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").val(this.get_attribute("countries")).wpmuiSelect().on("select2:selecting",i).on("select2:unselecting",i)}}),Optin.View.Conditions.not_in_a_country=t.extend({condition_id:"not_in_a_country",disable:["in_a_country"],title:optin_vars.messages.conditions.not_in_a_country,label:optin_vars.messages.condition_labels.not_in_a_country,defaults:{countries:""},body:function(){return this.template(this.get_data())},rendered:function(){this.$(".js-wpoi-select").val(this.get_attribute("countries")).wpmuiSelect().on("select2:selecting",i).on("select2:unselecting",i)}})}(jQuery),Hustle.define("Settings.Display_Triggers_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpoi-settings-display-triggers-tpl"),events:{"click .tabs-header label":"change_tab"},init:function(e){this.type=e.type,this.listenTo(this.model,"change:on_adblock",this.hide_adblock_options_on_toggle),this.render()},render:function(){return this.$el.html(this.template(this.get_data())),this.hide_adblock_options_on_toggle(),this},get_data:function(){var e={};return e.type=this.type,_.extend({},e,this.model.toJSON())},change_tab:function(e){e.preventDefault();var t=this.$(e.target),i=t.parent("li"),s=this.$(t.attr("href")),o=t.find("input[type='radio']");this.$(".tabs-header li").removeClass("current"),this.$(".tabs-content").removeClass("current"),i.addClass("current"),s.addClass("current"),o.prop("checked",!0),this.model.set("trigger",o.val())},hide_adblock_options_on_toggle:function(){_.isTrue(this.model.get("on_adblock"))?this.$(".wpoi-popup-trigger-on-adblock-option").show():this.$(".wpoi-popup-trigger-on-adblock-option").hide()}}))}),Hustle.define("Settings.Gdpr_Settings",function(e){"use strict";return Backbone.View.extend({el:"#wpmudev-settings-gdpr",events:{"click #wph-gdpr-settings-submit":"remove_ip"},initialize:function(){},remove_ip:function(e){e.preventDefault();var t=this.$(e.target),i=this.$el.find("#wph-gdpr-settings"),s=this.$el.find("#wph-gdpr-settings-submit"),o=_.reduce(i.serializeArray(),function(e,t){return e[t.name]=t.value,e},{});o.action="hustle_remove_ips",o._ajax_nonce=t.data("nonce"),s.prop("disabled",!0),s.addClass("wpmudev-button-onload"),this.$el.find(".wpmudev-loading").show(),this.process_batch(0,o,this,0)},process_batch:function(t,i,s,o){i.offset=t,i.updated=o,e.post({url:ajaxurl,type:"post",data:i}).done(function(e){if(e&&e.success)if("done"===e.data.offset){var t=s.$el.find("#wph-gdpr-settings"),o=s.$el.find("#wph-gdpr-settings-submit");o.removeClass("wpmudev-button-onload"),s.$el.find(".wpmudev-loading").hide(),t.find("#hustle-delete-ip").val(""),t.append('<label class="wpmudev-label--success">'+e.data.updated+optin_vars.messages.settings_rows_updated+"</label>"),setTimeout(function(){t.find(".wpmudev-label--success").remove(),o.prop("disabled",!1)},6e3)}else s.process_batch(parseInt(e.data.offset),i,s,parseInt(e.data.updated))})}})}),Hustle.define("Settings.Mail_Settings",function(e){"use strict";return Backbone.View.extend({el:"#wpmudev-settings-mail",events:{"submit #wpmudev-settings-mail-form":"save_email_settings"},initialize:function(){},save_email_settings:function(t){t.preventDefault();var i=this.$(t.target),s=i.data("nonce"),o=i.serialize();i.find("button[type=submit]").prop("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_global_email_settings",data:o,_ajax_nonce:s},success:function(e){e.success&&(i.append('<label class="wpmudev-label--success">'+optin_vars.messages.settings_saved+"</label>"),setTimeout(function(){i.find(".wpmudev-label--success").remove(),i.find("button[type=submit]").prop("disabled",!1)},3e3))}})}})}),Hustle.define("Settings.Modules_Activity",function(e){"use strict";return Backbone.View.extend({el:"#wpmudev-settings-activity",events:{"change .hustle-for-admin-user-toggle":"toggle_for_user","change .hustle-for-logged-in-user-toggle":"toggle_for_user"},initialize:function(){},toggle_for_user:function(t){var i=this.$(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("user");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_toggle_module_for_user",id:s,_ajax_nonce:o,user_type:n},complete:function(e,t){i.attr("disabled",!1)},success:function(e){e.success||i.prop("checked",!i.is(":checked"))},error:function(){i.prop("checked",!i.is(":checked"))}})}})}),Hustle.define("Settings.reCAPTCHA_Settings",function(e){"use strict";return Backbone.View.extend({el:"#wpmudev-settings-recaptcha",events:{"submit #wpmudev-settings-recaptcha-form":"save_recaptcha_settings"},initialize:function(){},save_recaptcha_settings:function(t){t.preventDefault();var i=this.$(t.target),s=i.data("nonce"),o=i.serialize();i.find("button[type=submit]").prop("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_global_recaptcha_settings",data:o,_ajax_nonce:s},success:function(e){e.success&&(i.append('<label class="wpmudev-label--success">'+optin_vars.messages.settings_saved+"</label>"),setTimeout(function(){i.find(".wpmudev-label--success").remove(),i.find("button[type=submit]").prop("disabled",!1)},3e3))}})}})}),Hustle.define("Settings.Unsubscribe_Settings",function(e){"use strict";return Backbone.View.extend({el:"#wpmudev-settings-unsubscribe",events:{"submit #wpmudev-settings-unsubscribe-messages":"save_unsubscription_messages","submit #wpmudev-settings-unsubscribe-email":"save_unsubscription_email"},initialize:function(){},save_unsubscription_messages:function(t){t.preventDefault();var i=this.$(t.target),s=i.data("nonce"),o=i.serialize();i.find("button[type=submit]").addClass("wpmudev-button-onload"),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_unsubscribe_messages_settings",data:o,_ajax_nonce:s},success:function(e){e.success&&(i.append('<label class="wpmudev-label--success">'+optin_vars.messages.settings_saved+"</label>"),i.find("button[type=submit]").removeClass("wpmudev-button-onload"),setTimeout(function(){i.find(".wpmudev-label--success").remove()},1e3))}})},save_unsubscription_email:function(t){t.preventDefault();var i=this.$(t.target),s=i.data("nonce"),o=i.serialize();i.find("button[type=submit]").addClass("wpmudev-button-onload"),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_unsubscribe_email_settings",data:o,_ajax_nonce:s},success:function(e){e.success&&(i.append('<label class="wpmudev-label--success">'+optin_vars.messages.settings_saved+"</label>"),i.find("button[type=submit]").removeClass("wpmudev-button-onload"),setTimeout(function(){i.find(".wpmudev-label--success").remove()},1e3))}})}})}),function(e,t){"use strict";e(document).on("click",".wpoi-listing-wrap header.can-open .toggle, .wpoi-listing-wrap header.can-open .toggle-label",function(e){e.stopPropagation()}),e(".accordion header .optin-delete-optin, .accordion header .edit-optin, .wpoi-optin-details tr .button-edit").hide().css({transition:"none"}),e(document).on({mouseenter:function(){var t=e(this);t.find(".optin-delete-optin, .edit-optin").stop().fadeIn("fast")},mouseleave:function(){var t=e(this);t.find(".toggle-checkbox").removeProp("disabled"),t.find(".edit-optin").removeProp("disabled"),t.removeClass("disabled"),t.find(".optin-delete-optin, .edit-optin, .delete-optin-confirmation").stop().fadeOut("fast")}},".accordion header"),e(document).on({mouseenter:function(){var t=e(this);t.find(".button-edit").stop().fadeIn("fast")},mouseleave:function(){var t=e(this);t.find(".button-edit").stop().fadeOut("fast")}},".wpoi-optin-details tr"),e(document).on("click",".wpoi-tabs-menu a",function(t){t.preventDefault();var i=e(this).attr("tab");Optin.router.navigate(i,!0)}),e(document).on("click",".edit-optin",function(t){t.stopPropagation(),t.preventDefault(),window.location.href=e(this).attr("href")}),e(document).on("click",".wpoi-type-edit-button",function(t){t.preventDefault();var i=e(this).data("id"),s=e(this).data("type");window.location.href="admin.php?page=inc_optin&optin="+i+"#display/"+s}),e(document).on("click","*[for]",function(t){var i=e(this),s=i.attr("for"),o=e("#"+s);!i.is("label")&&o.length&&(o.trigger("change"),o.trigger("click"))}),e("#wpoi-complete-message").fadeIn(),e(document).on("click","#wpoi-complete-message .next-button button",function(t){e("#wpoi-complete-message").fadeOut()}),e(document).on("click",".wpoi-listing-page .wpoi-listing-wrap header.can-open",function(t){e(this).find(".open").trigger("click")}),e(document).on("click",".wpoi-listing-page .wpoi-listing-wrap .can-open .open",function(t){t.stopPropagation();var i=e(this),s=i.closest(".wpoi-listing-wrap"),o=s.find("section"),n=e(".wpoi-listing-wrap").not(s),a=e(".wpoi-listing-wrap section").not(o);a.slideUp(300,function(){a.removeClass("open")}),n.find(".dev-icon").removeClass("dev-icon-caret_up").addClass("dev-icon-caret_down"),o.slideToggle(300,function(){s.toggleClass("open"),s.find(".dev-icon").toggleClass("dev-icon-caret_up dev-icon-caret_down")})}),Optin.decorate_number_inputs=function(t){var i=t&&t.$el?t.$el.find(".wph-input--number input"):e(".wph-input--number input"),s=Hustle.create_template('<div class="wph-nbr--nav"><div class="wph-nbr--button wph-nbr--up {{disabled}}">+</div><div class="wph-nbr--button wph-nbr--down {{disabled}}">-</div></div>');i.each(function(){var t=e(this),i=t.is(":disabled")?"disabled":"";t.siblings(".wph-nbr--nav").length||t.after(s({disabled:i}))})},Hustle.Events.on("view.rendered",Optin.decorate_number_inputs),function(){e(document).on("click",".wph-nbr--up:not(.disabled)",function(t){var i,s=e(this),o=s.closest(".wph-input--number"),n=o.find("input"),a=parseFloat(n.val()),d=(n.attr("min"),n.attr("max"));i=a>=d?a:a+1,i!==a&&n.val(i).trigger("change")}),e(document).on("click",".wph-nbr--down:not(.disabled)",function(t){var i,s=e(this),o=s.closest(".wph-input--number"),n=o.find("input"),a=parseFloat(n.val()),d=n.attr("min");n.attr("max");i=a<=d?a:a-1,i!==a&&n.val(i).trigger("change")})}(),function(){function t(){var t=e(window).scrollTop(),i=e(".wph-sticky--anchor");i.length&&(i=i.offset().top,t>i?(e(".wph-preview--eye").addClass("wph-sticky--element"),e(".wph-sticky--anchor").height(e(".wph-preview--eye").outerHeight())):(e(".wph-preview--eye").removeClass("wph-sticky--element"),e(".wph-sticky--anchor").height(0)))}e(function(){e(window).scroll(t),t()})}()}(jQuery,document),function(e){"use strict";Optin.Provider=function(t){var i=this;return _.extend(this,{id:!1,provider_args:{},errors:{},render_in_previewr:_.noop,init:_.noop,add_args:function(){i.id===Optin.step.services.model.get("optin_provider")&&_.each(i.provider_args,function(t,i){var s=e(t);s.length&&(s=s.val().trim(),Optin.step.services.provider_args.set(i,s))})},clear_provider_args:function(){i.id===Optin.step.services.model.previousAttributes().optin_provider&&i.id!==Optin.step.services.model.get("optin_provider")&&Optin.step.services.provider_args.clear({silent:!0})},validate:function(){var t=[];return _.each(i.provider_args,function(s,o){var n=e(s),a=e("<span></span>");n.length>0&&""===n.val().trim()&&(t.push(i.errors[o]),a.attr("title",i.errors[o].message),n.addClass("wpoi-error"),n.after(a),_.defer(function(){a.addClass("dashicons dashicons-warning "+i.errors[o].iconClass)}))}),_(t)},check_module_field:function(t,i,s){e.getJSON(window.ajaxurl,{action:"add_module_field",provider:this.id,_wpnonce:optin_vars.get_module_field_nonce,optin_id:i,field:t},s).fail(function(){var e={error:!0};s&&s(e)})},validate_custom_field:function(t,i,s){i.$(".dashicons-warning").remove(),i.$("[name]").prop("disabled",!0),this.check_module_field(t,s,function(s){if(i.$("[name]").prop("disabled",!1),s.success)i.options=t,i._updateOptions();else{var o=e('<span class="dashicons dashicons-warning">'),n="custom"!==s.data.code?optin_vars.messages.module_fields[s.data.code]:s.data.message;o.attr("title",n),i.$('[name="label"]').before(o)}})},add_module_field:function(t,i,s){var o=i.$(".wph-add-new-field","#wpoi-module-field-maker");o.addClass("wp-button-save--loading"),o.prop("disabled",!0),this.check_module_field(t,s,function(s){if(o.prop("disabled",!1),s.success)t=s.data.field,i._add_module_field(t);else{var n=e('<span class="dashicons dashicons-warning">'),a="custom"!==s.data.code?optin_vars.messages.module_fields[s.data.code]:s.data.message;n.attr("title",a),o.before(n)}})}},t),this.init(),Optin.Events.on("services:validate:after",e.proxy(this,"add_args")),Optin.Events.on("design:preview:render:start",e.proxy(this,"clear_provider_args")),Optin.Events.on("optin:add_module_field_"+this.id,e.proxy(this,"add_module_field")),Optin.Events.on("optin:update_module_field_"+this.id,e.proxy(this,"validate_custom_field")),this}}(jQuery,document),function(e){"use strict";var t=Object.keys(optin_vars.providers);_.each(t,function(t){Optin.Mixins.add_services_mixin(t,function(i){return new Optin.Provider({id:t,supports_fields:optin_vars.providers[t].supports_fields===!0,provider_args:{enabled:0},default_data:{enabled:!1,api_key:""},show_selected:function(){i.editing_service!==this.id},get_custom_args:function(t){var i=e("#wph-add-new-service-modal").find("form"),s=i.serializeArray(),o={},n=i.find('[name="list_id"]');if(t){var a=["_wp_http_referer","_wpnonce"];e.each(s,function(t,i){e.inArray(i.name,a)===-1&&(o.hasOwnProperty(i.name)?"string"==typeof o[i.name]?o[i.name]=[o[i.name],i.value]:o[i.name].push(i.value):o[i.name]=i.value)})}else e.each(s,function(e,t){o[t.name]=t.value});return i.find("input:checkbox").each(function(){this.checked||o.hasOwnProperty(this.name)||(o[this.name]=0)}),n.length>0&&(o.list_name=n.children(":selected").text()),o},pre_update_args:function(e){if(e.editing_service===this.id){if("undefined"==typeof e.service_modal.pre_saved&&(e.service_modal.pre_saved={}),!e.service_modal.prev_step){var i={enabled:!!e.model.get("email_services")[t]&&e.model.get("email_services")[t].enabled};_.extend(e.service_modal.pre_saved,i)}_.extend(e.service_modal.pre_saved,this.get_custom_args(!0))}},update_args:function(i){if(i.editing_service===this.id){_.extend(i[t].provider_args,i.service_modal.pre_saved);var s=["step","is_step","current_step","slug","module_id","module_type"];e.each(s,function(e,s){"undefined"!=typeof i[t].provider_args[s]&&delete i[t].provider_args[s]}),Hustle.Events.trigger("optin.service.saved",i)}},init:function(){var t=function(e){i.is_service_modal_updated=!0};e(document).on("change","#wph-optin-service-details-form input",t),Hustle.Events.on("optin.service.pre_save",e.proxy(this.pre_update_args,this)),Hustle.Events.on("optin.service.prepare",e.proxy(this.update_args,this)),Hustle.Events.on("optin.service.show.selected",e.proxy(this.show_selected,this))}})})})}(jQuery,document);var Module=window.Module||{};Hustle.define("Model",function(e){"use strict";return Backbone.Model.extend({initialize:function(){this.on("change",this.user_has_change,this),Backbone.Model.prototype.initialize.apply(this,arguments);var e=this.attributes;this.display_preview_button(e)},user_has_change:function(){Module.hasChanges=!0;var e=this.attributes;this.display_preview_button(e)},display_preview_button:function(t){var i=e(".wpmudev-preview");t.has_title||""!==t.main_content||t.use_feature_image||t.show_cta||t.use_email_collection?i.show():i.hide()}})}),Hustle.define("Models.M",function(){"use strict";return Hustle.get("Model").extend({toJSON:function(){var e=_.clone(this.attributes);for(var t in e)(e[t]instanceof Backbone.Model||e[t]instanceof Backbone.Collection)&&(e[t]=e[t].toJSON());return e},set:function(e,t,i){if("string"==typeof e&&e.indexOf(".")!==-1){var s=e.split(".")[0],o=e.split(".")[1],n=this.get(s);n&&n instanceof Backbone.Model&&(n.set(o,t,i),this.trigger("change:"+e,e,t,i),this.trigger("change:"+s,e,t,i))}else Backbone.Model.prototype.set.call(this,e,t,i)},get:function(e){if("string"==typeof e&&e.indexOf(".")!==-1){var t=e.split(".")[0],i=e.split(".")[1];return this.get(t).get(i)}return Backbone.Model.prototype.get.call(this,e)}})}),Hustle.define("Models.Trigger",function(){"use strict";return Hustle.get("Model").extend({defaults:{trigger:"time",on_time:!1,on_time_delay:5,on_time_unit:"seconds",on_scroll:"scrolled",on_scroll_page_percent:"20",on_scroll_css_selector:"",on_click_element:"",on_exit_intent:!0,on_exit_intent_per_session:!0,on_exit_intent_delayed:!1,on_exit_intent_delayed_time:5,on_exit_intent_delayed_unit:"seconds",on_adblock:!1,on_adblock_delayed:!1,on_adblock_delayed_time:5,on_adblock_delayed_unit:"seconds"}})}),Module.Model=Hustle.get("Models.M").extend({defaults:{module_name:"",module_type:"popup",active:0,test_mode:0}}),function(e){"use strict";var t=window.Module||{};t.Alert=Backbone.View.extend({template:Optin.template("optin-alert-modal"),
events:{"click .inc-opt-alert-modal-close":"close","click .inc-opt-alert-modal":"close","click .inc-opt-alert-modal-close-btn":"close","click .inc-opt-alert-modal-inner-container":"prevent_close"},initialize:function(e){return this.options=e,this.render()},render:function(){this.$el.html(this.template(_.extend({close_text:optin_vars.messages.ok},this.options))),this.$el.appendTo("body")},close:function(e){this.$el.hide(),this.remove()},prevent_close:function(e){e.preventDefault(),e.stopPropagation()}}),t.Service_Modal=Backbone.View.extend({template:Optin.template("wpmudev-hustle-modal-add-new-service-tpl"),service_modal_target:"#wph-add-new-service-modal .wpmudev-box-modal",add_service_modal:e("#wph-add-new-service-modal"),initialize:function(e){return this.step=0,this.next_step=!1,this.prev_step=!1,this.options=e,this.view=e.view,this.render()},render:function(){return this},add_service:function(t){this.view.is_service_modal_updated=!1;var i=_.extend({is_new:!0,service:"mailchimp"}),s=e(this.service_modal_target),o=t.closest("a");o.data("nonce");s.html(""),s.append(this.template(i)),this.show_modal(!1)},edit_service:function(t){this.view.is_service_modal_updated=!0;var i=t.closest("a"),s=i.data("id"),o=_.extend({is_new:!1,service:s}),n=e(this.service_modal_target);this.nonce=i.data("nonce"),n.html(""),n.append(this.template(o)),this.view.editing_service=s,this.get_form_settings(),this.show_modal(!0)},on_provider_changed:function(t){var i=e(t.target),s=i.val();this.view.editing_service!==s&&(this.view.is_service_modal_updated=!0),this.add_service_modal.find("#optin-provider-account-options").html(""),this.view.service_modal.pre_saved={},this.view.editing_service=s,this.get_form_settings()},on_click_ajax:function(t){t.preventDefault();var i=(this.view,e(t.target)),s=i.closest("form"),o=this.add_service_modal.find("."+t.target.id+"-empty"),n=this.add_service_modal.find("."+t.target.id+"-hide"),a=this.add_service_modal.find("."+t.target.id+"-show"),d=e(t.target).data("dom_wrapper"),l=_.extend({},i.data()),r=_.reduce(s.serializeArray(),function(e,t){return e[t.name]=t.value,e},{});r.module_id=this.view.module_id,r._ajax_nonce=i.data("nonce"),"undefined"!==l.nonce&&delete l.nonce,this.view.is_service_modal_updated=!0,o.empty(),n.hide(),a.show(),"undefined"!=typeof d&&this.add_service_modal.find(d).html(e("#wpoi-loading-indicator").html()),r=_.extend({},this.view.service_modal.pre_saved,l,r),i.addClass("wpmudev-button-onload"),this.custom_request(r)},on_change_ajax:function(t){var i=e(t.target),s=i.closest("form"),o=this.add_service_modal.find("."+t.target.id+"-empty"),n=this.add_service_modal.find("."+t.target.id+"-hide"),a=this.add_service_modal.find("."+t.target.id+"-show"),d=e(t.target).data("dom_wrapper"),l=_.extend({},i.data()),r=_.reduce(s.serializeArray(),function(e,t){return e[t.name]=t.value,e},{});if(r._ajax_nonce=i.data("nonce"),"undefined"!=typeof d){var c=this.add_service_modal.find(d);if(c.html(e("#wpoi-loading-indicator").html()),["-1","0"].indexOf(t.target.value)!==-1)return void c.empty()}"undefined"!==l.select2&&delete l.select2,"undefined"!==l.nonce&&delete l.nonce,_.extend(r,this.view.service_modal.pre_saved,l),o.empty(),n.hide(),a.show(),this.custom_request(r)},continue_next_step:function(e){e.preventDefault(),Hustle.Events.trigger("optin.service.pre_save",this.view);var t={};this.view.editing_service;t.data={},t.data=this.view.service_modal.pre_saved,t.data.is_step=!0,t.data.step=this.get_step(),t.data.current_step=this.step,t.data.slug=this.view.editing_service,t.data.module_id=this.view.module_id,t.data.module_type=this.view.module_type,t.action=this.action,t._ajax_nonce=this.nonce,this.request(t,!0)},go_prev_step:function(e){e.preventDefault();var t={},i=this.view.editing_service;t.data={},t.data=this.view[i].provider_args,t.data.is_step=!0,t.data.step=this.get_prev_step(),t.data.current_step=this.step,t.data.slug=this.view.editing_service,t.data.module_id=this.view.module_id,t.data.module_type=this.view.module_type,t.action=this.action,t._ajax_nonce=this.nonce,this.request(t,!0)},get_form_settings:function(){var e={};e.action=this.action="provider_form_settings",e.data={},e.data=this.view[this.view.editing_service].provider_args,e.data.is_step=!1,e.data.slug=this.view.editing_service,e.data.step=this.step=0,e.data.current_step=this.step,e.data.module_id=this.view.module_id,e.data.module_type=this.view.module_type,e._ajax_nonce=this.nonce,this.request(e,!1)},custom_request:function(t){var i=this;e.post({url:ajaxurl,type:"post",data:t}).done(function(t){t&&t.success&&("undefined"!=typeof t.data.html&&"undefined"!=typeof t.data.wrapper&&i.render_custom_body(t.data.html,t.data.wrapper),"undefined"!=typeof t.data.redirect_url&&_.delay(function(){window.location=t.data.redirect_url},300),"undefined"!=typeof t.data.is_close&&t.data.is_close&&i.close_modal()),e(".wpmudev-button-onload").removeClass("wpmudev-button-onload")})},render_custom_body:function(t,i){i&&e(i).html(t),Hustle.Events.trigger("modules.view.rendered",this.view)},request:function(t,i){i&&(this.add_service_modal.find("#optin-provider-account-options").html(""),this.add_service_modal.find("#wph-provider-account-details").html(e("#wpoi-loading-indicator").html()),this.add_service_modal.find(".hustle-provider-next").addClass("wpmudev-button-onload"),this.add_service_modal.find(".hustle-provider-prev").addClass("wpmudev-button-onload"));var s=this;e.post({url:ajaxurl,type:"post",data:t}).done(function(t){t&&t.success&&(s.render_body(t),s.render_footer(t),"undefined"!=typeof t.data.data.data_to_save&&i&&(_.extend(s.view.service_modal.pre_saved,t.data.data.data_to_save),Hustle.Events.trigger("optin.service.prepare",s.view)),i||s.display_saved_values(),s.update_view(t),!_.isUndefined(t.data.data.is_close)&&t.data.data.is_close&&s.close_modal()),e(".wpmudev-button-onload").removeClass("wpmudev-button-onload")})},render_body:function(e){this.add_service_modal.find("#wph-provider-account-details").html(e.data.data.html),Hustle.Events.trigger("modules.view.rendered",this.view)},render_footer:function(e){var t=this,i=e.data.data.buttons;this.add_service_modal.find(".wpmudev-box-footer").html(""),_.each(i,function(e){t.add_service_modal.find(".wpmudev-box-footer").append(e.markup)}),Hustle.Events.trigger("modules.view.rendered",this.view)},display_saved_values:function(){var t=this.view.model.get("email_services"),i=this.view.editing_service;if("undefined"==typeof t||_.isEmpty(t)||"undefined"==typeof t[i])return void this.add_service_modal.find("#optin-provider-saved-args").hide();var s=this,i=this.view.editing_service,o="api_key"in t[i]?t[i].api_key:"";""!==o&&e('input[name="api_key"]').attr("value",o),e.each(t[i],function(o,n){var a=s.add_service_modal.find(".current_"+o);if(a.length>0){var d="";d="string"==typeof n||"number"==typeof n?n:"array"==typeof n?n.join(", "):e.map(t[i],function(e){return e}).join(", "),a.text(d)}})},update_view:function(e){_.isUndefined(e.data.data.opt_in_provider_has_next_step)||(this.next_step=e.data.data.opt_in_provider_has_next_step===!0),_.isUndefined(e.data.data.opt_in_provider_has_prev_step)||(this.prev_step=e.data.data.opt_in_provider_has_prev_step===!0),_.isUndefined(e.data.data.opt_in_provider_current_step)||(this.step=+e.data.data.opt_in_provider_current_step)},get_step:function(){return this.next_step?this.step+1:this.step},get_prev_step:function(){return this.prev_step?this.step-1:this.step},clear_options:function(t){t.preventDefault();var i=e(t.target),s=i.data("name");e('input[name="'+s+'"').prop("checked",!1)},show_modal:function(t){var i=e("#wph-add-new-service-modal"),s=i.find(".wpmudev-box-modal"),o=this.view,n=this,a=this.view.model.get("email_services");this.add_service_modal.addClass("wpmudev-modal-active"),e("body").addClass("wpmudev-modal-is_active"),setTimeout(function(){s.addClass("wpmudev-show"),Hustle.Events.trigger("modules.view.rendered",o),e(document).off("click",".hustle-provider-next",e.proxy(n.continue_next_step,n)),e(document).on("click",".hustle-provider-next",e.proxy(n.continue_next_step,n)),e(document).off("click",".hustle-provider-prev",e.proxy(n.go_prev_step,n)),e(document).on("click",".hustle-provider-prev",e.proxy(n.go_prev_step,n)),e(document).off("click",".hustle_provider_on_click_ajax",e.proxy(n.on_click_ajax,n)),e(document).on("click",".hustle_provider_on_click_ajax",e.proxy(n.on_click_ajax,n)),e(document).off("change",".hustle_provider_on_change_ajax",e.proxy(n.on_change_ajax,n)),e(document).on("change",".hustle_provider_on_change_ajax",e.proxy(n.on_change_ajax,n)),e(document).off("click",".clear_options",e.proxy(n.clear_options,n)),e(document).on("click",".clear_options",e.proxy(n.clear_options,n)),e(document).off("change",'select[name="optin_provider_name"]',e.proxy(n.on_provider_changed,n)),e(document).on("change",'select[name="optin_provider_name"]',e.proxy(n.on_provider_changed,n)),Hustle.Events.off("optin.service.saved",e.proxy(n.save_email_service)),Hustle.Events.on("optin.service.saved",e.proxy(n.save_email_service)),n.hide_or_show_other_services(t),t&&!_.isEmpty(a)?Hustle.Events.trigger("optin.service.show.selected",o):s.find('select[name="optin_provider_name"]').trigger("change")},100)},hide_or_show_other_services:function(t){var i=e("#wph-provider-select .wpmudev-select"),s=this.view.model.get("email_services");if(_.isEmpty(s)&&(s={mailchimp:this.view.mailchimp.default_data}),!t){var o=i.find("option");o.each(function(){var t=e(this).attr("value");(t in s||"mailchimp"===t)&&e(this).remove()})}},save_email_service:function(e){var t=e.editing_service,i=e[t].provider_args,s={};s[t]=i,e.model.set("email_services",s),"1"===i.enabled?e.model.set("active_email_service",t):e.model.set("active_email_service",""),_.isUndefined(e.service_modal.pre_saved)||_.isEmpty(e.service_modal.pre_saved)||!_.isUndefined(e.service_modal.next_step)&&e.service_modal.next_step||delete e.service_modal.pre_saved,e.service_modal.append_added_service(t,i)},close_modal:function(){this.add_service_modal.find(".wpmudev-i_close").click()},append_added_service:function(t,i){var s=e("tr.wph-wizard-content-email-providers").last(),o=s.clone();s.html(o.html());var n=e("tr.wph-wizard-content-email-providers").last();n.addClass("updated-email-provider"),n.siblings().removeClass("updated-email-provider");var n=e("tr.updated-email-provider"),a=n.find("input.wph-email-service-toggle"),d=a.siblings("label"),l=Optin.template("wpmudev-"+t+"-optin-provider-icon-svg"),r=n.find(".wph-email-providers-icon"),c=n.find("a.wph-email-service-edit-link"),_="desc"in i?i.desc:"";a.attr("id","wph-popup-list_"+t),a.attr("data-attribute",t+"_service_provider"),a.prop("checked","true"===i.enabled||"1"===i.enabled),d.attr("for","wph-popup-list_"+t),c.attr("data-id",t),r.html(l()),t in optin_vars.providers&&(c.find("span.wpmudev-table_name").text(optin_vars.providers[t].title),c.find("span.wpmudev-table_desc:first").text(_))}}),t.Form_Fields=Backbone.View.extend({edit_fields_modal:e("#wph-edit-form-modal"),field_list_template:Optin.template("wpmudev-hustle-modal-view-form-fields-tpl"),fields_template:Optin.template("wpmudev-hustle-modal-manage-form-fields-tpl"),new_fields_template:Optin.template("wpmudev-hustle-modal-add-form-fields-tpl"),fields_modal_target:"#wph-edit-form-modal .wpmudev-box-modal",initialize:function(e){return this.options=e,this.view=e.view,this.render()},render:function(){return this},manage_form:function(){var t=this,i=(this.view,e(t.fields_modal_target)),s=this.view.model.get("form_elements");"object"!=typeof s&&(s=JSON.parse(s)),i.html(""),i.append(t.fields_template(_.extend({form_fields:s})));var o=i.find("form#wph-optin-form-fields-form .wpmudev-table-body");o.length&&_.each(s,function(e,i){o.append(t.new_fields_template(_.extend({field:e,new_field:!1})))});var n=t.edit_fields_modal.find(".wpmudev-box-modal"),a=t.edit_fields_modal.find(".wpmudev-table-body"),d=t.edit_fields_modal.find(".wpmudev-table-body-row"),l=t.edit_fields_modal.find("#wph-new-form-field"),r=t.edit_fields_modal.find(".wpmudev-i_close"),c=t.edit_fields_modal.find("#wph-cancel-edit-form"),u=t.edit_fields_modal.find("#wph-save-edit-form"),p=t.edit_fields_modal.find(".wph-field-row");t.edit_fields_modal.addClass("wpmudev-modal-active"),e("body").addClass("wpmudev-modal-is_active"),setTimeout(function(){n.addClass("wpmudev-show"),l.on("click",e.proxy(t.new_form_field,t)),u.on("click",e.proxy(t.save_form_fields,t)),a.sortable(),a.disableSelection(),d.each(function(){var i=e(this),s=i.find(".wpmudev-preview-item-manage"),o=i.find('select[name="type"]'),n=i.find(".wpmudev-icon-delete");s.on("click",function(e){e.stopPropagation(),i.toggleClass("wpmudev-open")}),n.on("click",function(i){i.preventDefault(),i.stopPropagation(),t.delete_form_field(e(this))}),o.on("change",function(t){"recaptcha"===e(this).val()?(i.find(".wpmudev-switch-labeled, .wpmudev-row:first, .wpmudev-row:eq(1) div:eq(1)").addClass("wpmudev-hidden"),i.find(".wpmudev-preview-item-label, .wpmudev-preview-item-name, .wpmudev-preview-item-placeholder").text(""),i.find(".wpmudev-preview-item-required").html('<span class="wpdui-fi wpdui-fi-check"></span>')):(i.find(".wpmudev-switch-labeled, .wpmudev-row:first, .wpmudev-row:eq(1) div:eq(1)").removeClass("wpmudev-hidden"),i.find('input[name="label"],input[name="name"],input[name="placeholder"],input[name="required"]').trigger("change"))})}),r.on("click",function(i){i.stopPropagation(),n.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.edit_fields_modal.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),n.removeClass("wpmudev-hide")},500)}),c.on("click",function(i){i.preventDefault(),i.stopPropagation(),n.removeClass("wpmudev-show").addClass("wpmudev-hide"),setTimeout(function(){t.edit_fields_modal.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),n.removeClass("wpmudev-hide")},500)}),p.each(function(){t.form_fields_header(e(this))}),Hustle.Events.trigger("modules.view.select.render",t),Hustle.Events.off("optin.service.saved",e.proxy(t.persist_form_fields,t)),Hustle.Events.on("optin.service.saved",e.proxy(t.persist_form_fields,t))},100)},new_form_field:function(i){i.preventDefault(),i.stopPropagation();var s=this,o=(s.view,s.edit_fields_modal.find(".wpmudev-table-body")),n=s.edit_fields_modal.find("#wph-new-form-field"),a=this.view.model.get("save_local_list"),d=this.view.model.get("active_email_service");if(t.Utils.service_supports_fields(a,d)){var l=o.find(".wpmudev-table-body-row");l.each(function(){e(this).removeClass("wpmudev-open")}),o.prepend(s.new_fields_template(_.extend({field:{"delete":!0},new_field:!0})));var r=o.find(".wpmudev-preview-item-manage:first"),c=o.find('select[name="type"]:first'),u=o.find(".wph-field-row:first"),p=o.find(".wpmudev-icon-delete");r.on("click",function(t){t.stopPropagation(),e(this).closest(".wpmudev-table-body-row").toggleClass("wpmudev-open")}),p.on("click",function(t){t.preventDefault(),t.stopPropagation(),s.delete_form_field(e(this))}),c.on("change",function(t){"recaptcha"===e(this).val()?(u.find(".wpmudev-switch-labeled, .wpmudev-row:first, .wpmudev-row:eq(1) div:eq(1)").addClass("wpmudev-hidden"),u.find('input[name="label"],input[name="name"]').val("recaptcha"),u.find('input[name="placeholder"]').val(""),u.find(".wpmudev-preview-item-required").html('<span class="wpdui-fi wpdui-fi-check"></span>')):u.find(".wpmudev-switch-labeled, .wpmudev-row:first, .wpmudev-row:eq(1) div:eq(1)").removeClass("wpmudev-hidden"),u.find('input[name="label"],input[name="name"],input[name="placeholder"],input[name="required"]').trigger("change")}),s.form_fields_header(o.find(".wpmudev-table-body-row:first")),Hustle.Events.trigger("modules.view.select.render",s),s.update_model_fields(s)}else n.html(optin_vars.messages.form_fields.errors.custom_field_not_supported)},delete_form_field:function(e){var t=(e.data("id"),e.closest(".wph-field-row.wpmudev-table-body-row"));t.fadeOut("fast",function(){t.remove()})},form_fields_header:function(t){var i=t.find(".wpmudev-table-body-content input, .wpmudev-table-body-content select"),s=t.find(".wpmudev-table-body-preview"),o=s.closest(".wpmudev-table-body-row");i.each(function(){e(this).is(":checkbox")?e(this).on("change",function(t){e(this).is(":checked")?s.find(".wpmudev-preview-item-required").html('<span class="wpdui-fi wpdui-fi-check"></span>'):s.find(".wpmudev-preview-item-required").html("")}):e(this).on("change keyup keypress",function(t){var i=e(this).attr("name");s.find(".wpmudev-preview-item-"+i).html(e(this).val()),"name"===i&&o.attr("data-id",e(this).val())})})},save_form_fields:function(t){t.preventDefault(),t.stopPropagation();var i=this;i.view;i.update_model_fields(i,function(t){var s=i.field_list_template({form_fields:t});e(".wph-form-element-list").empty(),e(".wph-form-element-list").html(s),i.edit_fields_modal.find(".wpmudev-i_close").click()})},update_model_fields:function(t,i){var s=t.view,o=t.edit_fields_modal.find(".wph-field-row"),n={},a={};o.each(function(){var t=e(this).attr("data-id"),i=e(this).find(".wpmudev-table-body-content input, .wpmudev-table-body-content select");a[t]={},i.each(function(){var i=e(this).attr("name"),s=e(this).val();"required"===i&&(s=e(this).is(":checkbox")?e(this).is(":checked"):"true"===s),"delete"===i&&(s="true"===s),a[t][i]=s}),n[t]=a[t]}),s.current_form_elements=n,s.model.set("form_elements",n,{silent:!0}),"undefined"!=typeof i&&"function"==typeof i&&i(n)},persist_form_fields:function(e){var t=this;"object"==typeof e.current_form_elements&&(Object.keys(e.current_form_elements).length<=0&&"undefined"!=typeof wph_default_form_elements&&(e.current_form_elements=wph_default_form_elements),Object.keys(e.current_form_elements).length>0&&e.model.set("form_elements",e.current_form_elements)),t.edit_fields_modal.find(".wpmudev-i_close").click()}}),t.hasChanges=!1,t.user_change=function(){t.hasChanges=!0},window.onbeforeunload=function(){if(t.hasChanges)return optin_vars.messages.dont_navigate_away},e(".highlight_input_text").focus(function(){e(this).select()})}(jQuery),function(e){"use strict";var t=window.Module||{};t.Validate={validate_module_name:function(){var t=!0;if(e("input[name=module_name]").length){var i=e("input[name=module_name]"),s=i.next(".wpmudev-label--notice");t=0!==i.val().length,t?s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"):(i.focus(),s.hasClass("wpmudev-hidden")&&s.removeClass("wpmudev-hidden"))}return t},on_change_validate_module_name:function(t){var i=e(t.target).val(),s=e(t.target).next(".wpmudev-label--notice");0!==i.length?s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")&&s.removeClass("wpmudev-hidden")}},t.Utils={get_url_param:function(e){for(var t=window.location.search.substring(1),i=t.split("&"),s=0;s<i.length;s++){var o=i[s].split("=");if(o[0]===e)return o[1]}return!1},service_supports_fields:function(e,t){return"1"===String(e)||!_.isEmpty(t)&&"undefined"!=typeof optin_vars.providers[t]&&optin_vars.providers[t].supports_fields}}}(jQuery),Hustle.define("Pop_Up.Content_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-popup-section-content-tpl"),module_id:0,target_container:e("#wpmudev-hustle-box-section-content"),editing_service:"",is_service_modal_updated:!1,current_form_elements:[],content_form_container:e(".wph-form-element-list"),events:{"click .wph-email-service-edit-link":"edit_email_service","click #wph-add-another-service":"add_email_service","click #wph-edit-form":"manage_form_fields"},init:function(e){this.module_id=e.module_id,this.module_type="popup",_.each(Optin.Mixins.get_services_mixins(),function(e,t){e&&"function"==typeof e&&(this[t]=e(this))},this),this.service_modal=new Module.Service_Modal({view:this}),this.form_fields_modal=new Module.Form_Fields({view:this})},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return"undefined"==typeof t.email_services.mailchimp&&(t.email_services={mailchimp:this.mailchimp.default_data}),""===t.form_elements&&"undefined"!=typeof wph_default_form_elements&&(this.model.set("form_elements",wph_default_form_elements),this.current_form_elements=wph_default_form_elements),this.setElement(this.template(_.extend({module_type:"popup"},t))),this}},after_render:function(){this.target_container.length&&this.render_featured_image()},render_featured_image:function(){var e=Hustle.get("Featured_Image_Holder"),t=this.$("#wph-popup-choose_image");t.length&&(this.media_holder=new e({model:this.model,attribute:"feature_image",module_type:"popup",target_div:t}),t.html(""),t.html(this.media_holder.$el))},add_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.add_service(i)},edit_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.edit_service(i)},manage_form_fields:function(e){e.preventDefault(),e.stopPropagation(),this.form_fields_modal.manage_form()}}))}),Hustle.define("Pop_Up.Design_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-popup-section-design-tpl"),target_container:e("#wpmudev-hustle-box-section-design"),use_email_collection:!1,css_editor:!1,stylables:{".hustle-modal .hustle-modal-close .hustle-icon ":"Close Icon",".hustle-modal .hustle-modal-body ":"Modal Container",".hustle-modal .hustle-modal-image ":"Image Container",".hustle-modal .hustle-modal-image .hustle-modal-feat_image, .hustle-modal .hustle-modal-image img ":"Modal Image",".hustle-modal .hustle-modal-optin_form ":"Form Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field ":"Form Input Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button ":"Form Button Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field input ":"Form Input",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button button ":"Form Button"},events:{"click .wpmudev-css-stylable":"insert_stylable_element"},init:function(e){if(this.target_container.length)return this.use_email_collection=e.use_email_collection,this.render()},render:function(e){return this.setElement(this.template(_.extend({use_email_collection:this.use_email_collection,stylables:this.stylables},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.create_css_editor(),this.hide_unwanted_options())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(t,i){var s=e(this);s.val(i.color.toCSS()).trigger("change")}})},create_css_editor:function(){this.css_editor=ace.edit("hustle_custom_css"),this.css_editor.getSession().setMode("ace/mode/css"),this.css_editor.$blockScrolling=1/0,this.css_editor.setTheme("ace/theme/hustle"),this.css_editor.getSession().setUseWrapMode(!0),this.css_editor.getSession().setUseWorker(!1),this.css_editor.setShowPrintMargin(!1),this.css_editor.renderer.setShowGutter(!0),this.css_editor.setHighlightActiveLine(!0)},hide_unwanted_options:function(){"one"===this.model.get("form_layout")&&_.isTrue(this.use_email_collection)?(this.$("#wpmudev-tabs-menu_item_above").show(),this.$("#wpmudev-tabs-menu_item_below").show(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").removeAttr("style")):(this.$("#wpmudev-tabs-menu_item_above").hide(),this.$("#wpmudev-tabs-menu_item_below").hide(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").css({"border-right":"1px solid #E1E1E1","border-radius":"0 10px 10px 0","-moz-border-radius":"0 10px 10px 0","-webkit-border-radius":"0 10px 10px 0"}),"right"!==this.model.get("feature_image_position")&&this.$('ul.wpmudev-feature-image-position-options input[value="left"]').parent().click())},update_custom_css:function(){this.css_editor&&this.model.set("custom_css",this.css_editor.getValue())},insert_stylable_element:function(t){t.preventDefault();var i=e(t.target),s=i.data("stylable")+"{}";this.css_editor.navigateFileEnd(),this.css_editor.insert(s),this.css_editor.navigateLeft(1),this.css_editor.focus()}}))}),Hustle.define("Popup.Listing",function(e){"use strict";var t=Hustle.get("Delete_Confirmation"),i=Hustle.get("Upgrade_Modal");return Backbone.View.extend({el:"#wpmudev-hustle",logShown:!1,events:{"click .import-module-settings":"import_settings","click .hustle-delete-module":"delete_module","click #hustle-free-version-create":"show_upgrade_modal","click .button-view-email-list":"view_email_list","click .module-toggle-tracking-activity":"toggle_tracking_activity","click .module-duplicate":"duplicate","click .button-view-log-list":"view_error_log_list","click #wpmudev-bulk-action-button":"apply_bulk_action","change [name='wph-module-status']":"module_status_updated","change #wph-all-popups":"select_all","change #wph-optin-service-import-form input[type=file]":"toggle_notice"},initialize:function(){var s=this,o=e(".wpmudev-list .wpmudev-list--element"),n=o.length,a=n;o.each(function(){e(this).css("z-index",a),a--;var t=e(this).find(".wpmudev-dots-dropdown"),i=t.find(".wpmudev-dots-button"),o=t.find(".wpmudev-dots-nav");i.on("click",function(){e(this).toggleClass("wpmudev-active"),o.toggleClass("wpmudev-hide"),s.$(".wpmudev-dots-nav").not(o).each(function(){e(this).hasClass("wpmudev-hide")||e(this).toggleClass("wpmudev-hide")})})}),this.delete_confirmation=new t({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}}),this.upgrade_modal=new i,Module.Utils.get_url_param("requires_pro")&&this.show_upgrade_modal()},delete_module:function(t){var i=e(t.target),s=i.data("id"),o=i.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=s,this.delete_confirmation.opts.nonce=o,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},toggle_notice:function(t){e(t.target).val()?e("#select_file_error").addClass("wpmudev-hidden"):e("#select_file_error").removeClass("wpmudev-hidden")},import_settings:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("type"),o=t.data("name"),n=t.data("nonce"),a=Hustle.get("Modal_Import");this.importShown&&this.importShown.remove(),this.importShown=new a({model:{id:i,name:o,nonce:n,type:s}})},show_upgrade_modal:function(e){"undefined"!=typeof e&&e.preventDefault(),this.upgrade_modal&&this.upgrade_modal.$el.addClass("wpmudev-modal-active")},module_status_updated:function(t){var i=this.$(t.target),s=i.val(),o=i.data(),n=i.closest("li.wpmudev-tabs-menu_item");n.addClass("current"),n.siblings().removeClass("current"),o._ajax_nonce=o.nonce,"test"===s?o.action="hustle_popup_toggle_test_activity":(o.action="hustle_popup_module_toggle_state","off"===s?o.enabled="false":o.enabled="true"),e.post(ajaxurl,o,function(e){})},view_email_list:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("name"),o=t.data("total"),n=Hustle.get("Modal_Email");this.emailsShown&&this.emailsShown.remove(),this.emailsShown=new n({model:{id:i,total:o,name:s,type:"popup",module_fields:[]}})},set_testmode_visibiliy:function(e,t){"undefined"==typeof t&&(t=400);var i=e,s=i.data()||{},o=this.$('.wpoi-testmode-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').closest(".test-mode");i.is(":checked")?o.fadeOut(t):o.fadeIn(t)},toggle_tracking_activity:function(t){var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("type");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_popup_module_toggle_tracking_activity",id:s,type:n,_ajax_nonce:o},complete:function(){location.reload()}})},duplicate:function(t){var i=this,s=e(t.target),o=s.data("id"),n=s.data("nonce"),a=s.data("type");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_popup_duplicate",id:o,type:a,_ajax_nonce:n},success:function(e){e.success?location.reload():e.data.requires_pro&&i.show_upgrade_modal()},error:function(){location.reload()}})},view_error_log_list:function(t){var i=e(t.currentTarget),s=i.data(),o=s.id,n=s.name,a="popup",d=Hustle.get("Modal_Error");this.logShown&&this.logShown.remove(),this.logShown=new d({button:i,model:{name:n,id:o,type:a,total:s.total}})},select_all:function(t){var i=e(t.target);i.is(":checked")?this.$(".wph-module-checkbox").prop("checked",!0):this.$(".wph-module-checkbox").prop("checked",!1)},apply_bulk_action:function(t){var i=(e(t.target),this.$("select#wpmudev-bulk-action").val()),s=this.$('select#wpmudev-bulk-action option[value="'+i+'"]').data("nonce"),o=[];"delete"===i&&(this.$(".wph-module-checkbox:checked").each(function(){o.push(e(this).data("id"))}),_.isEmpty(o)||this.delete_confirmation&&(this.delete_confirmation.opts.ids=JSON.stringify(o),this.delete_confirmation.opts.multiple=1,this.delete_confirmation.opts.nonce=s,this.delete_confirmation.$el.addClass("wpmudev-modal-active")))}})}),Hustle.define("Pop_Up.Models",function(){"use strict";var e=Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"popup"})}),t=Hustle.get("Models.M").extend({defaults:{module_name:"",has_title:!1,title:"",sub_title:"",main_content:"",use_feature_image:!1,feature_image:"",feature_image_location:"left",feature_image_hide_on_mobile:!1,show_cta:!1,show_gdpr:!1,cta_label:"",cta_url:"",cta_target:"blank",use_email_collection:!1,save_local_list:!1,local_list_name:"",active_email_service:"",email_services:"",form_elements:"",after_successful_submission:"show_success",success_message:"",after_subscription:"keep_show",gdpr_message:'Yes, I agree with the <a href="#" target="_blank" rel="noopener">privacy policy</a>.',auto_close_success_message:!1,auto_close_time:5,auto_close_unit:"seconds",redirect_url:""}}),i=Hustle.get("Models.M").extend({defaults:{form_layout:"one",feature_image_position:"left",feature_image_fit:"contain",feature_image_horizontal:"center",feature_image_horizontal_px:"-100",feature_image_vertical:"center",feature_image_vertical_px:"-100",style:"cabriolet",customize_colors:!1,main_bg_color:"rgba(56,69,78,1)",image_container_bg:"rgba(53,65,74,1)",form_area_bg:"rgba(93,115,128,1)",title_color:"rgba(253,253,253,1)",subtitle_color:"rgba(253,253,253,1)",content_color:"rgba(173,181,183,1)",link_static_color:"rgba(56,197,181,1)",link_hover_color:"rgba(73,226,209,1)",link_active_color:"rgba(73,226,209,1)",cta_button_static_bg:"rgba(56,197,181,1)",cta_button_hover_bg:"rgba(73,226,209,1)",cta_button_active_bg:"rgba(73,226,209,1)",cta_button_static_color:"rgba(255,255,255,1)",cta_button_hover_color:"rgba(255,255,255,1)",cta_button_active_color:"rgba(255,255,255,1)",gdpr_content:"#ADB5B7",gdpr_chechbox_background_static:"#FDFDFD",gdpr_checkbox_background_active:"#FDFDFD",gdpr_checkbox_icon:"#38C5B5",optin_input_static_bg:"rgba(253,253,253,1)",optin_input_hover_bg:"rgba(253,253,253,1)",optin_input_active_bg:"rgba(253,253,253,1)",optin_input_icon:"rgba(173,181,183,1)",optin_placeholder_color:"rgba(173,181,183,1)",optin_form_field_text_static_color:"rgba(54,59,63,1)",optin_form_field_text_hover_color:"rgba(54,59,63,1)",optin_form_field_text_active_color:"rgba(54,59,63,1)",optin_submit_button_static_bg:"rgba(56,197,181,1)",optin_submit_button_hover_bg:"rgba(73,226,209,1)",optin_submit_button_active_bg:"rgba(73,226,209,1)",optin_submit_button_static_color:"rgba(253,253,253,1)",optin_submit_button_hover_color:"rgba(253,253,253,1)",optin_submit_button_active_color:"rgba(253,253,253,1)",optin_error_text_color:"#F1F1F1",optin_error_text_bg:"#EA6464",optin_mailchimp_title_color:"rgba(253,253,253,1)",optin_mailchimp_labels_color:"rgba(173,181,183,1)",optin_check_radio_bg:"rgba(253,253,253,1)",optin_check_radio_tick_color:"rgba(56,197,181,1)",optin_success_tick_color:"rgba(55,198,181,1)",optin_success_content_color:"rgba(253,253,253,1)",overlay_bg:"rgba(51,51,51,0.9)",close_button_static_color:"rgba(56,197,181,1)",close_button_hover_color:"rgba(73,226,209,1)",close_button_active_color:"rgba(73,226,209,1)",
border:!1,border_radius:5,border_weight:3,border_type:"solid",border_color:"rgba(218,218,218,1)",form_fields_border:!1,form_fields_border_radius:5,form_fields_border_weight:3,form_fields_border_type:"solid",form_fields_border_color:"rgba(218,218,218,1)",button_border:!1,button_border_radius:5,button_border_weight:3,button_border_type:"solid",button_border_color:"rgba(218,218,218,1)",gdpr_border:!1,gdpr_border_radius:5,gdpr_border_weight:3,gdpr_border_type:"solid",gdpr_border_color:"rgba(218,218,218,1)",form_fields_icon:"static",form_fields_proximity:"joined",drop_shadow:!1,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0.2)",customize_size:!1,custom_height:300,custom_width:600,customize_css:!1,custom_css:""}}),s=Hustle.get("Models.Trigger"),o=Hustle.get("Models.M").extend({defaults:{conditions:"",triggers:"",animation_in:"",animation_out:"",after_close:"keep_show",expiration:365,expiration_unit:"days",allow_scroll_page:!1,not_close_on_background_click:!1,on_submit:"default"},initialize:function(e){if(_.extend(this,e),this.get("triggers")instanceof Backbone.Model||this.set("triggers",new s(this.triggers)),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}});return{Base:e,Content:t,Design:i,Display_Settings:o}}),Hustle.define("Pop_Up.Settings_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-popup-section-settings-tpl"),target_container:e("#wpmudev-hustle-box-section-settings"),init:function(e){if(this.conditions_view=e.conditions_view,this.target_container.length)return this.render()},render:function(e){return this.setElement(this.template(_.extend({shortcode_id:optin_vars.current.shortcode_id},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&this.$(".wph-conditions").replaceWith(this.conditions_view.$el)}}))}),Hustle.define("Pop_Up.View",function(e,t,i){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-popup-wizard-view",preview:!1,preview_model:!1,events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(t){return this.content_view=t.content_view,this.design_view=t.design_view,this.settings_view=t.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.content_view.model,"change",this.content_view_changed),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.stopListening(this.settings_view.model,"change",this.settings_view_changed),e(document).off("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),e(document).off("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).off("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).off("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).off("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).off("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).off("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).off("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).off("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).off("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).off("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).off("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).off("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).off("keydown",e.proxy(this.escape_key,this)),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.content_view.model,"change",this.content_view_changed),this.listenTo(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.settings_view.model,"change",this.settings_view_changed),e(document).on("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),e(document).on("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).on("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).on("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).on("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).on("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).on("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).on("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).on("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).on("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).on("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).on("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).on("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).on("change keyup keypress","input[name=module_name]",e.proxy(this.validate_modal_name,this)),e(document).on("keydown",e.proxy(this.escape_key,this)),Hustle.Events.on("modules.view.preview.success",e.proxy(this.preview_success_message_delay,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render();var e=parseInt(this.content_view.model.get("use_email_collection"),10);this.use_email_collection_changed(e,!1),e&&this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.target_container.html(""),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render(),this.settings_view.target_container.html(""),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},set_content_from_tinymce:function(e){if(e=e||!1,"undefined"!=typeof tinyMCE){var t=tinyMCE.get("main_content"),i=this.$("textarea#main_content"),s="true"===i.attr("aria-hidden")?t.getContent():i.val();this.content_view.model.set("main_content",s,{silent:e});var o=tinyMCE.get("success_message"),n=this.$("textarea#success_message"),a="true"===n.attr("aria-hidden")?o.getContent():n.val();this.content_view.model.set("success_message",a,{silent:e});var d=tinyMCE.get("gdpr_message"),l=this.$("textarea#gdpr_message"),r="true"===l.attr("aria-hidden")?d.getContent():l.val();this.content_view.model.set("gdpr_message",r,{silent:e})}},open_preview:function(e){e.preventDefault(),e.stopPropagation(),this.handle_preview()},handle_preview:function(){this.set_content_from_tinymce(!0),this.sanitize_data();var t=this.$("#wph-preview-modal .wpmudev-modal-mask").siblings(".hustle-modal");t.length&&t.remove();var i=this,s=i.content_view.model.get("main_content"),o=e(".wpmudev-preview").data("nonce");s.search(/\[/g)===-1?i.render_preview(i.content_view.model.toJSON()):e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_shortcode_render",content:s,_ajax_nonce:o},success:function(e){if(e&&e.data&&e.data.content){var t=_.extend(i.content_view.model.toJSON(),{main_content:e.data.content});i.render_preview(t)}},error:function(){}})},render_preview:function(t){var i=this,s=e(".wpmudev-preview").data("sitekey"),o=this.$("#wph-preview-modal"),n=this.content_view.model.get("use_email_collection"),a=_.isTrue(n)?Optin.template("wpmudev-hustle-modal-with-optin-tpl"):Optin.template("wpmudev-hustle-modal-without-optin-tpl"),d=_.extend(i.model.toJSON(),{content:t,design:i.design_view.model.toJSON(),settings:i.settings_view.model.toJSON()});d.unique_id="",o.append(a(d)),o.addClass("hui-module-type--popup"),"1"===t.use_email_collection&&"undefined"!=typeof t.form_elements.recaptcha&&s&&(o.find(".hustle-modal-body button").attr("disabled",!0),grecaptcha.ready(function(){grecaptcha.render("hustle-modal-recaptcha"+d.module_id,{sitekey:s,callback:function(){o.find(".hustle-modal-body button").removeAttr("disabled")}})})),i.apply_custom_css(),i.apply_preview_styles(),i.after_preview_render(),Hustle.Events.trigger("modules.view.rendered",i)},after_preview_render:function(){var t=this,i=this.$("#wph-preview-modal").addClass("wpmudev-modal-active"),s=i.find(".hustle-modal"),o=i.find(".hustle-modal-success"),n=this.settings_view.model.get("animation_in");e("body").addClass("wpmudev-modal-is_active"),o.css({height:i.find(".hustle-modal-body").height()+"px"}),s.hasClass("hustle-animated")?setTimeout(function(){s.addClass("hustle-animate-"+n),t.apply_custom_size()},100):this.apply_custom_size()},apply_preview_styles:function(){var t=this.content_view.model.toJSON(),i=this.design_view.model.toJSON(),s=i.style;if(_.isTrue(t.use_email_collection))return void this.apply_preview_optin_styles();var o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=o.find(".wpmudev-modal-mask"),d=n.find(".hustle-modal-body"),l=n.find(".hustle-modal-body section"),r=n.find(".hustle-modal-title"),c=n.find(".hustle-modal-subtitle"),u=n.find(".hustle-modal-image"),p=n.find(".hustle-modal-message"),m=n.find("article blockquote, .hustle-modal-message blockquote"),h=n.find("article a, .hustle-modal-message a"),v=n.find(".hustle-modal-cta"),g=n.find(".hustle-modal-close"),f=n.find(".hustle-modal-close svg path"),w=n.find(".hustle-gdpr-box .hustle-gdpr-content"),b=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox input"),y=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox span");if("cabriolet"===s?l.css("background-color",i.main_bg_color):d.css("background-color",i.main_bg_color),u.css("background-color",i.image_container_bg),r.css("color",i.title_color),c.css("color",i.subtitle_color),p.css("color",i.content_color),m.css("border-left-color",i.link_static_color),h.css("color",i.link_static_color),h.mouseover(function(){e(this).css("color",i.link_hover_color)}).mouseout(function(){e(this).css("color",i.link_static_color)}),v.css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color}),v.mouseover(function(){e(this).css({"background-color":i.cta_button_hover_bg,color:i.cta_button_hover_color})}).mouseout(function(){e(this).css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color})}),_.isTrue(t.show_gdpr)){if(w.css("color",i.gdpr_content),_.isTrue(i.gdpr_border)){var x=i.gdpr_border_weight+"px "+i.gdpr_border_type+" "+i.gdpr_border_color;y.css({border:x,"border-radius":i.gdpr_border_radius+"px"})}y.css({"background-color":i.gdpr_chechbox_background_static,color:i.gdpr_checkbox_icon}),b.click(function(){y.toggleClass("gdpr-is-active",function(){y.hasClass("gdpr-is-active")?y.css({"background-color":i.gdpr_checkbox_background_active}):y.css({"background-color":i.gdpr_chechbox_background_static})})})}f.css("fill",i.close_button_static_color),g.mouseover(function(){f.css("fill",i.close_button_hover_color)}).mouseout(function(){f.css("fill",i.close_button_static_color)}),a.css("background-color",i.overlay_bg);var C=o.find(".hustle-modal-image img"),k="",$="";if("contain"!==i.feature_image_fit&&"cover"!==i.feature_image_fit||(k="custom"===i.feature_image_horizontal?i.feature_image_horizontal_px+"px":i.feature_image_horizontal,$="custom"===i.feature_image_vertical?i.feature_image_vertical_px+"px":i.feature_image_vertical,C.css({"background-position":k+" "+$,"object-position":k+" "+$})),_.isTrue(i.border)){var S=i.border_weight+"px "+i.border_type+" "+i.border_color;"cabriolet"===s?n.find("section").css({border:S,"border-radius":i.border_radius+"px"}):d.css({border:S,"border-radius":i.border_radius+"px"})}if(_.isTrue(i.drop_shadow)){var O=i.drop_shadow_x+"px "+i.drop_shadow_y+"px "+i.drop_shadow_blur+"px "+i.drop_shadow_spread+"px "+i.drop_shadow_color;"cabriolet"===s?n.find("section").css({"box-shadow":O}):d.css({"box-shadow":O})}},apply_preview_optin_styles:function(){var t=this.content_view.model.toJSON(),i=this.design_view.model.toJSON(),s=i.form_layout,o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=n.find(".hustle-modal-body"),d=n.find(".hustle-modal-success"),l=n.find(".hustle-modal-title"),r=n.find(".hustle-modal-subtitle"),c=n.find("article"),u=n.find("article blockquote"),p=n.find("article a:not(.hustle-modal-cta)"),m=n.find(".hustle-modal-optin_field"),h=m.find("input"),v=m.find("label .hustle-modal-optin_icon .hustle-icon path"),g=m.find("label .hustle-modal-optin_placeholder"),f=n.find(".hustle-modal-optin_button button"),w=n.find(".hustle-modal-mc_checkbox input+label, .hustle-modal-mc_checkbox input:checked+label"),b=n.find(".hustle-modal-mc_radio input+label, .hustle-modal-mc_radio input:checked+label"),y=n.find(".hustle-modal-close"),x=n.find(".hustle-modal-close svg path"),C=n.find(".hustle-gdpr-box .hustle-gdpr-content"),k=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox input"),$=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox span");if(a.find("section").css("background-color",i.main_bg_color),d.css("background-color",i.main_bg_color),a.find(".hustle-modal-image").css("background-color",i.image_container_bg),"one"===s||"two"===s?n.find("footer").css("background-color",i.form_area_bg):n.find(".hustle-modal-optin_wrap").css("background-color",i.form_area_bg),l.css("color",i.title_color),r.css("color",i.subtitle_color),c.css("color",i.content_color),u.css("border-left-color",i.link_static_color),p.css("color",i.link_static_color),p.mouseover(function(){e(this).css("color",i.link_hover_color)}).mouseout(function(){e(this).css("color",i.link_static_color)}),c.find(".hustle-modal-cta").css({background:i.cta_button_static_bg,color:i.cta_button_static_color}),c.find(".hustle-modal-cta").mouseover(function(){e(this).css({background:i.cta_button_hover_bg,color:i.cta_button_hover_color})}).mouseout(function(){e(this).css({background:i.cta_button_static_bg,color:i.cta_button_static_color})}),_.isTrue(t.show_gdpr)){if(C.css("color",i.gdpr_content),_.isTrue(i.gdpr_border)){var S=i.gdpr_border_weight+"px "+i.gdpr_border_type+" "+i.gdpr_border_color;$.css({border:S,"border-radius":i.gdpr_border_radius+"px"})}$.css({"background-color":i.gdpr_chechbox_background_static,color:i.gdpr_checkbox_icon}),k.click(function(){$.toggleClass("gdpr-is-active",function(){$.hasClass("gdpr-is-active")?$.css({"background-color":i.gdpr_checkbox_background_active}):$.css({"background-color":i.gdpr_chechbox_background_static})})})}h.css("color",i.optin_form_field_text_static_color),h.css("background-color",i.optin_input_static_bg),m.mouseover(function(){e(this).find("input").css("color",i.optin_form_field_text_hover_color),e(this).find("input").css("background-color",i.optin_input_hover_bg)}).mouseout(function(){e(this).find("input").css("color",i.optin_form_field_text_static_color),e(this).find("input").css("background-color",i.optin_input_static_bg)}),v.css("fill",i.optin_input_icon),f.css("color",i.optin_submit_button_static_color),f.css("background-color",i.optin_submit_button_static_bg),f.mouseover(function(){e(this).css("color",i.optin_submit_button_hover_color),e(this).css("background-color",i.optin_submit_button_hover_bg)}).mouseout(function(){e(this).css("color",i.optin_submit_button_static_color),e(this).css("background-color",i.optin_submit_button_static_bg)}),g.css("color",i.optin_placeholder_color),w.css("background-color",i.optin_check_radio_static_bg),b.css("background-color",i.optin_check_radio_static_bg);var O=e("#hustle-module-checkbox-radio-custom-styles"),z=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input+label:before",H=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input:checked+label:before",M=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input+label:before",T=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input:checked+label:before",j=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_title label",E=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_label label",D=".wpmudev-ui .wpmudev-modal .wpmudev-modal-mask",P=z+" { color: "+i.optin_check_radio_static_bg+"; }"+H+" { color: "+i.optin_check_radio_tick_color+"; }"+M+" { color: "+i.optin_check_radio_static_bg+"; }"+T+" { color: "+i.optin_check_radio_tick_color+"; }"+j+" { color: "+i.optin_mailchimp_title_color+"; }"+E+" { color: "+i.optin_mailchimp_labels_color+"; }"+D+" { background-color: "+i.overlay_bg+"; }";O.length&&O.remove(),e('<style id="hustle-module-mailchimp-custom-styles">'+P+"</style>").appendTo("body"),x.css("fill",i.close_button_static_color),y.mouseover(function(){x.css("fill",i.close_button_hover_color)}).mouseout(function(){x.css("fill",i.close_button_static_color)});var N=o.find(".hustle-modal-image img"),V="",J="";if("contain"!==i.feature_image_fit&&"cover"!==i.feature_image_fit||(V="custom"===i.feature_image_horizontal?i.feature_image_horizontal_px+"px":i.feature_image_horizontal,J="custom"===i.feature_image_vertical?i.feature_image_vertical_px+"px":i.feature_image_vertical,N.css({"background-position":V+" "+J,"object-position":V+" "+J})),_.isTrue(i.border)){var B=i.border_weight+"px "+i.border_type+" "+i.border_color;a.css({border:B,"border-radius":i.border_radius+"px"})}if(_.isTrue(i.drop_shadow)){var I=i.drop_shadow_x+"px "+i.drop_shadow_y+"px "+i.drop_shadow_blur+"px "+i.drop_shadow_spread+"px "+i.drop_shadow_color;a.css({"box-shadow":I})}if(_.isTrue(i.form_fields_border)){var F=i.form_fields_border_weight+"px "+i.form_fields_border_type+" "+i.form_fields_border_color;h.css({border:F,"border-radius":i.form_fields_border_radius+"px"})}if(_.isTrue(i.button_border)){var U=i.button_border_weight+"px "+i.button_border_type+" "+i.button_border_color;f.css({border:U,"border-radius":i.button_border_radius+"px"})}},apply_custom_size:function(){var e=(this.content_view.model.toJSON(),this.design_view.model.toJSON()),t=(e.style,e.form_layout,this.$("#wph-preview-modal")),i=t.find(".hustle-modal");i.find(".hustle-modal-body");_.isTrue(e.customize_size)&&i.css({width:e.custom_width+"px","max-width":"unset",height:e.custom_height+"px","max-height":"unset"})},apply_custom_css:function(){var t=e("#hustle-module-custom-styles");t.remove();var i=this.design_view.model.toJSON().customize_css;if(1===i||"1"===i){var s=this.design_view.model.get("custom_css"),o=e(".wpmudev-preview").data("customCssNonce");if(_.isEmpty(s)||"undefined"==typeof o)return;e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_popup_prepare_custom_css",css:s,_ajax_nonce:o},success:function(t){if(t&&t.success){var i=e("#hustle-module-custom-styles");i.length&&i.remove(),e('<style id="hustle-module-custom-styles">'+t.data+"</style>").appendTo("body")}},error:function(){}})}},close_preview:function(t){t.stopPropagation();var i=this.$("#wph-preview-modal"),s=i.find(".hustle-modal"),o=this.settings_view.model.get("animation_in"),n="hustle-animate-"+o,a=this.settings_view.model.get("animation_out"),d="hustle-animate-"+a,l=1e3;s.removeClass(n).addClass(d),s.hasClass("hustle-animated")&&("fadeOut"===a&&(l=305),"newspaperOut"===a&&(l=505),"bounceOut"===a&&(l=755),setTimeout(function(){i.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),s.removeClass(d)},l)),s.hasClass("hustle-modal-static")&&(s.removeClass("hustle-modal-static"),i.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"))},sanitize_data:function(){var e=this.content_view.model.get("cta_url");/^(f|ht)tps?:\/\//i.test(e)||(e="http://"+e,this.content_view.model.set("cta_url",e,{silent:!0})),this.design_view.update_custom_css()},provider_add_custom_fields:function(t,i,s,o){var n=o.content_view.model.get("active_email_service");if(Module.Utils.service_supports_fields(0,n)===!0&&("form_elements"in s||"email_services"in s||"active_email_service"in s)&&"object"==typeof o.content_view.model.get("form_elements")){var a=JSON.stringify(o.content_view.model.get("form_elements")),n=o.content_view.model.get("active_email_service"),d=t,l={action:"add_module_fields",_ajax_nonce:i,data:a,provider:n,module_id:d};e.post(ajaxurl,l,function(e){}).fail(function(e){console.log("There was an error saving the custom fields.")})}},save:function(t){if(!Module.Validate.validate_module_name())return!1;var i=this.content_view.model.changed;this.set_content_from_tinymce(!0),this.sanitize_data();var s=this,o=t.data("id")?t.data("id"):"-1",n=t.data("nonce"),a=this.model.toJSON(),d=this.content_view.model.toJSON(),l=this.design_view.model.toJSON(),r=this.settings_view.model.toJSON();return e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_popup_module",_ajax_nonce:n,id:o,module:a,content:d,design:l,settings:r,shortcode_id:s._get_shortcode_id()},complete:function(e){s.provider_add_custom_fields(o,n,i,s);e.responseJSON}})},save_changes:function(t){t.preventDefault();var i=this,s=e(t.currentTarget);i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").addClass("wpmudev-button-onload").prop("disabled",!0);var o=this.save(s);o?o.done(function(t){if("string"==typeof t&&(t=JSON.parse(t)),t.success){var o=window.location.pathname+window.location.search;o.indexOf("&id=")===-1&&(o=o+"&id="+t.data,window.history.replaceState({},"",o),i.$(".wpmudev-menu-content-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){e(this).attr("href",e(this).data("link")+"&id="+t.data)})),s.data("id",t.data),s.siblings().data("id",t.data),Module.hasChanges=!1;var n=optin_vars.current.section||!1;if("settings"===n){var a=t.data;if(s.hasClass("wpmudev-button-finish"))return window.location.replace("?page="+optin_vars.current.listing_page+"&module="+a)}}}).always(function(){i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").removeClass("wpmudev-button-onload").prop("disabled",!1)}):i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_continue:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.currentTarget));s?s.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,s=optin_vars.current.section||!1,o="";return window.onbeforeunload=null,s&&"content"!==s?"design"===s&&(o=i.$(".wpmudev-menu-settings-link a").data("link")):o=i.$(".wpmudev-menu-design-link a").data("link"),o.indexOf("&id")===-1&&(o+="&id="+t),window.location.replace(o)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_finish:function(t){t.preventDefault();var i=this;i.$('select[data-attribute="after_close"]').trigger("change"),i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").addClass("wpmudev-button-onload").prop("disabled",!0),this.model.set("active",1,{silent:!0});var s=this.save(e(t.currentTarget));s?s.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").removeClass("wpmudev-button-onload").prop("disabed",!1)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();var t=this;t.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var i=optin_vars.current.section;window.onbeforeunload=null,"design"===i?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"settings"===i&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"content"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},content_view_changed:function(e){var t=e.changed,i=Object.keys(t);if("has_title"in t){var s=this.$("#wph-wizard-content-title-textboxes");s.length&&(t.has_title?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_feature_image"in t){var s=this.$("#wph-wizard-content-image-options");s.length&&(t.use_feature_image?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_cta"in t){var s=this.$("#wph-wizard-content-cta-options");s.length&&(t.show_cta?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_gdpr"in t){var s=this.$("#wph-wizard-content-gdpr-message");s.length&&(t.show_gdpr?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_email_collection"in t&&this.use_email_collection_changed(t.use_email_collection,!0),"after_successful_submission"in t&&this.after_successful_submission_changed(t.after_successful_submission),"auto_close_success_message"in t){var s=this.$("#wph-wizard-content-form_success_options");s.length&&(t.auto_close_success_message?(s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.addClass("wpmudev-hidden"),s.removeClass("wpmudev-show")))}if("save_local_list"in t){var s=this.$("#wph-wizard-content-local_list_name");s.length&&(t.save_local_list?(s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.addClass("wpmudev-hidden"),s.removeClass("wpmudev-show")))}if(i[0].indexOf("_service_provider")!==-1){var o=i[0].replace("_service_provider","");this.handle_email_service(o,t[o+"_service_provider"])}},design_view_changed:function(e){var t=e.changed;if("form_layout"in t){var i=this.$(".wpmudev-box-layouts"),s=i.find(".wpmudev-box-layout_"+t.form_layout);i.length&&s.length&&(s.siblings().removeClass("active"),s.hasClass("active")||s.addClass("active"),this.design_view.hide_unwanted_options())}if("style"in t&&this.update_color_palette(t.style),"customize_colors"in t){var o=this.$("#wph-modal-styles-palette"),n=this.$("#wph-modal-palette");o.length&&(t.customize_colors?(o.removeClass("wpmudev-hidden"),o.addClass("wpmudev-show")):(o.addClass("wpmudev-hidden"),o.removeClass("wpmudev-show"))),n.length&&(t.customize_colors?(n.removeClass("wpmudev-hidden"),n.addClass("wpmudev-show")):(n.addClass("wpmudev-hidden"),n.removeClass("wpmudev-show")))}if("feature_image_fit"in t){var s=this.$("#wph-wizard-content-image_fit_horizontal_vertical_options");s.length&&("contain"===t.feature_image_fit||"cover"===t.feature_image_fit?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_horizontal"in t){var s=this.$("#wph-wizard-design-horizontal-position");s.length&&("custom"===t.feature_image_horizontal?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_vertical"in t){var s=this.$("#wph-wizard-design-vertical-position");s.length&&("custom"===t.feature_image_vertical?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("border"in t){var s=this.$("#wph-wizard-design-border-options");s.length&&(t.border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("form_fields_border"in t){var s=this.$("#wph-wizard-design-form-fields-border-options");s.length&&(t.form_fields_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("button_border"in t){var s=this.$("#wph-wizard-design-button-border-options");s.length&&(t.button_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("gdpr_border"in t){var s=this.$("#wph-wizard-design-gdpr-border-options");s.length&&(t.gdpr_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("drop_shadow"in t){var s=this.$("#wph-wizard-design-shadow-options");s.length&&(t.drop_shadow?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_size"in t){var s=this.$("#wph-wizard-design-size-options");s.length&&(t.customize_size?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_css"in t){var s=this.$("#wph-wizard-design-css_holder");s.length&&(t.customize_css?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}},settings_view_changed:function(e){var t=e.changed;if("on_time"in t){var i=this.$("#wpmudev-display-trigger-time-options");i.length&&(t.on_time?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_time",t.on_time,{silent:!0})}if("on_scroll"in t){var s=this.$("#wpmudev-display-trigger-scroll-options"),o=s.find(".wpmudev-show"),n=s.find(".wpmudev-hidden");s.length&&(o.removeClass("wpmudev-show").addClass("wpmudev-hidden"),n.removeClass("wpmudev-hidden").addClass("wpmudev-show")),this.settings_view.model.set("triggers.on_scroll",t.on_scroll,{silent:!0})}if("on_adblock"in t&&this.settings_view.model.set("triggers.on_adblock",t.on_adblock,{silent:!0}),"on_exit_intent_delayed"in t){var i=this.$("#wpmudev-display-exit-intent-delayed-options");i.length&&(t.on_exit_intent_delayed?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_exit_intent_delayed",t.on_exit_intent_delayed,{silent:!0
})}},display_triggers_changed:function(e){var t=e.changed;if("trigger"in t){var i=this.$("#wpmudev-display-trigger-"+t.trigger);i.length&&(i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"))}},update_color_palette:function(e){var t=this,i=parseInt(this.content_view.model.get("use_email_collection"),10);if(i){var s=this.$('option[value="'+e+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];this.design_view.model.set("customize_colors",0),this.$('input[data-attribute="customize_colors"]').removeAttr("checked"),_.each(n,function(e,i){t.$('input[data-attribute="'+i+'"]').val(e).trigger("change")})}}},reset_color_palette:function(){var e=this,t=this.$("#wph-wizard-design-palette .select2-selection__rendered").attr("title").toLowerCase().replace(/\s/g,"_"),i=parseInt(this.content_view.model.get("use_email_collection"),10);if(i){var s=this.$('option[value="'+t+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];_.each(n,function(t,i){e.$('input[data-attribute="'+i+'"]').val(t).trigger("change")})}}},use_email_collection_changed:function(e,t){var i=this.$("#wph-wizard-content-email"),s=this.$("#wph-wizard-content-email-options"),o=this.$("#wph-wizard-content-form_elements"),n=this.$("#wph-wizard-content-gdpr"),a=this.$("#wph-wizard-content-gdpr-message"),d=this.$("#wph-wizard-content-form_submission"),l=this.$("#wph-wizard-content-form_message"),r=this.$("#wph-wizard-content-form_success"),c=this.$("#wph-wizard-content-recaptcha");parseInt(e,10)?(i.removeClass("last"),s.removeClass("wpmudev-hidden_table"),s.addClass("wpmudev-show_table"),o.show(),n.show(),a.show(),d.show(),c.show(),this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),t&&this.design_view.model.set("style","gray_slate")):(i.hasClass("last")||i.addClass("last"),s.removeClass("wpmudev-show_table"),s.addClass("wpmudev-hidden_table"),o.hide(),n.hide(),a.hide(),d.hide(),l.hide(),r.hide(),c.hide(),t&&this.design_view.model.set("style","cabriolet"))},after_successful_submission_changed:function(e){var t=this.$("#wph-wizard-content-form_submission_redirect_url"),i=this.$("#wph-wizard-content-form_message"),s=this.$("#wph-wizard-content-form_success");"redirect"===e?(t.length&&t.removeClass("wpmudev-hidden"),i.length&&s.length&&(i.hide(),s.hide())):(t.length&&!t.hasClass("wpmudev-hidden")&&t.addClass("wpmudev-hidden"),i.length&&s.length&&(i.show(),s.show()))},toggle_cta_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("cta_target",s.val(),{silent:!0})},toggle_submit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("after_successful_submission",s.val())},toggle_feature_image_position_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_position",s.val(),{silent:!0})},toggle_feature_image_fit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_fit",s.val(),{silent:!1})},toggle_feature_image_horizontal_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_horizontal",s.val(),{silent:!1})},toggle_feature_image_vertical_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_vertical",s.val(),{silent:!1})},toggle_form_fields_icon_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_icon",s.val(),{silent:!1})},toggle_form_fields_proximity_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_proximity",s.val(),{silent:!1})},toggle_display_triggers:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.settings_view.model.set("triggers.trigger",s.val(),{silent:!0}),this.display_triggers_changed(this.settings_view.model.get("triggers"))},handle_email_service:function(t,i){var s=this.content_view.model.get("email_services");_.isEmpty(s)&&(s={}),i?(this.content_view.model.set("active_email_service",t),_.isEmpty(s)?s[t]={enabled:i}:_.each(s,function(i,o){o===t?s[o]=_.extend(s[o],{enabled:1}):(s[o]=_.extend(s[o],{enabled:0}),e('input[data-attribute="'+o+'_service_provider"]').removeAttr("checked"))})):(this.content_view.model.set("active_email_service",""),s[t]=_.extend(s[t],{enabled:i})),this.content_view.model.set("email_services",s)},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")},escape_key:function(e){27===e.keyCode&&this.close_preview(e)},preview_success_message_delay:function(e){var t=this.content_view.model,i=t.get("auto_close_success_message"),s=this.content_view.model.get("auto_close_time"),o=this.content_view.model.get("auto_close_unit"),n=e.$("#wph-preview-modal").addClass("wpmudev-modal-active");if(_.isTrue(i)){var a=parseInt(s),d=o;"minutes"===d&&(a*=60),a*=1e3,_.delay(function(){var e=n.find(".hustle-modal"),t=e.find(".hustle-modal-close .hustle-icon");t.length>0?t.trigger("click"):$success_msg.removeAttr("style")},a)}}})}),Hustle.define("Slidein.Content_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-slidein-section-content-tpl"),module_id:0,target_container:e("#wpmudev-hustle-box-section-content"),editing_service:"",is_service_modal_updated:!1,current_form_elements:[],content_form_container:e(".wph-form-element-list"),events:{"click .wph-email-service-edit-link":"edit_email_service","click #wph-add-another-service":"add_email_service","click #wph-edit-form":"manage_form_fields"},init:function(e){this.module_id=e.module_id,this.module_type="slidein",_.each(Optin.Mixins.get_services_mixins(),function(e,t){e&&"function"==typeof e&&(this[t]=e(this))},this),this.service_modal=new Module.Service_Modal({view:this}),this.form_fields_modal=new Module.Form_Fields({view:this})},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return"undefined"==typeof t.email_services.mailchimp&&(t.email_services={mailchimp:this.mailchimp.default_data}),""===t.form_elements&&"undefined"!=typeof wph_default_form_elements&&(this.model.set("form_elements",wph_default_form_elements),this.current_form_elements=wph_default_form_elements),this.setElement(this.template(_.extend({module_type:"slidein"},t))),this}},after_render:function(){this.target_container.length&&this.render_featured_image()},render_featured_image:function(){var e=Hustle.get("Featured_Image_Holder"),t=this.$("#wph-slidein-choose_image");t.length&&(this.media_holder=new e({model:this.model,attribute:"feature_image",module_type:"slidein",target_div:t}),t.html(""),t.html(this.media_holder.$el))},show_email_service_modal:function(t){var i=e("#wph-add-new-service-modal"),s=i.find(".wpmudev-box-modal"),o=this.model.get("email_services"),n=e("#optin-provider-account-selected-list"),a=this;this.add_service_modal.addClass("wpmudev-modal-active"),e("body").addClass("wpmudev-modal-is_active"),setTimeout(function(){s.addClass("wpmudev-show"),Hustle.Events.trigger("modules.view.rendered",a),e(document).off("click",".optin_refresh_provider_details",e.proxy(a.refresh_provider_details,a)),e(document).on("click",".optin_refresh_provider_details",e.proxy(a.refresh_provider_details,a)),e(document).off("click",".wph-save-optin-service",e.proxy(a.updated_email_service_args,a)),e(document).on("click",".wph-save-optin-service",e.proxy(a.updated_email_service_args,a)),Hustle.Events.off("slidein.optin.service.saved",e.proxy(a.save_email_service,a)),Hustle.Events.on("slidein.optin.service.saved",e.proxy(a.save_email_service,a)),a.hide_or_show_other_services(t),t&&!_.isEmpty(o)?Hustle.Events.trigger("optin.service.show.selected",a):n.hide()},100)},add_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.add_service(i)},edit_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.edit_service(i)},manage_form_fields:function(e){e.preventDefault(),e.stopPropagation(),this.form_fields_modal.manage_form()}}))}),Hustle.define("Slidein.Design_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-slidein-section-design-tpl"),target_container:e("#wpmudev-hustle-box-section-design"),use_email_collection:!1,css_editor:!1,stylables:{".hustle-modal .hustle-modal-close .hustle-icon ":"Close Icon",".hustle-modal .hustle-modal-body ":"Modal Container",".hustle-modal .hustle-modal-image ":"Image Container",".hustle-modal .hustle-modal-image .hustle-modal-feat_image, .hustle-modal .hustle-modal-image img ":"Modal Image",".hustle-modal .hustle-modal-optin_form ":"Form Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field ":"Form Input Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button ":"Form Button Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field input ":"Form Input",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button button ":"Form Button"},events:{"click .wpmudev-css-stylable":"insert_stylable_element"},init:function(e){if(this.target_container.length)return this.use_email_collection=e.use_email_collection,this.render()},render:function(e){return this.setElement(this.template(_.extend({use_email_collection:this.use_email_collection,stylables:this.stylables},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.create_css_editor(),this.hide_unwanted_options())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(t,i){var s=e(this);s.val(i.color.toCSS()).trigger("change")}})},create_css_editor:function(){this.css_editor=ace.edit("hustle_custom_css"),this.css_editor.getSession().setMode("ace/mode/css"),this.css_editor.$blockScrolling=1/0,this.css_editor.setTheme("ace/theme/hustle"),this.css_editor.getSession().setUseWrapMode(!0),this.css_editor.getSession().setUseWorker(!1),this.css_editor.setShowPrintMargin(!1),this.css_editor.renderer.setShowGutter(!0),this.css_editor.setHighlightActiveLine(!0)},hide_unwanted_options:function(){"one"===this.model.get("form_layout")&&_.isTrue(this.use_email_collection)?(this.$("#wpmudev-tabs-menu_item_above").show(),this.$("#wpmudev-tabs-menu_item_below").show(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").removeAttr("style")):(this.$("#wpmudev-tabs-menu_item_above").hide(),this.$("#wpmudev-tabs-menu_item_below").hide(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").css({"border-right":"1px solid #E1E1E1","border-radius":"0 10px 10px 0","-moz-border-radius":"0 10px 10px 0","-webkit-border-radius":"0 10px 10px 0"}),"right"!==this.model.get("feature_image_position")&&this.$('ul.wpmudev-feature-image-position-options input[value="left"]').parent().click()),this.$el.find("#popup_overlay_color").parents(".wpmudev-col").hide()},update_custom_css:function(){this.css_editor&&this.model.set("custom_css",this.css_editor.getValue())},insert_stylable_element:function(t){t.preventDefault();var i=e(t.target),s=i.data("stylable")+"{}";this.css_editor.navigateFileEnd(),this.css_editor.insert(s),this.css_editor.navigateLeft(1),this.css_editor.focus()}}))}),Hustle.define("Slidein.Listing",function(e){"use strict";var t=Hustle.get("Delete_Confirmation"),i=Hustle.get("Upgrade_Modal");return Backbone.View.extend({el:"#wpmudev-hustle",logShown:!1,events:{"click .import-module-settings":"import_settings","click .hustle-delete-module":"delete_module","click #hustle-free-version-create":"show_upgrade_modal","click .button-view-email-list":"view_email_list","click .module-toggle-tracking-activity":"toggle_tracking_activity","click .button-view-log-list":"view_error_log_list","click #wpmudev-bulk-action-button":"apply_bulk_action","click .module-duplicate":"duplicate","change [name='wph-module-status']":"module_status_updated","change #wph-all-slideins":"select_all","change #wph-optin-service-import-form input[type=file]":"toggle_notice"},initialize:function(){var s=this,o=e(".wpmudev-list .wpmudev-list--element"),n=o.length,a=n;o.each(function(){e(this).css("z-index",a),a--;var t=e(this).find(".wpmudev-dots-dropdown"),i=t.find(".wpmudev-dots-button"),o=t.find(".wpmudev-dots-nav");i.on("click",function(){e(this).toggleClass("wpmudev-active"),o.toggleClass("wpmudev-hide"),s.$(".wpmudev-dots-nav").not(o).each(function(){e(this).hasClass("wpmudev-hide")||e(this).toggleClass("wpmudev-hide")})})}),this.delete_confirmation=new t({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}}),this.upgrade_modal=new i,Module.Utils.get_url_param("requires_pro")&&this.show_upgrade_modal()},delete_module:function(t){var i=e(t.target),s=i.data("id"),o=i.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=s,this.delete_confirmation.opts.nonce=o,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},toggle_notice:function(t){e(t.target).val()?e("#select_file_error").addClass("wpmudev-hidden"):e("#select_file_error").removeClass("wpmudev-hidden")},import_settings:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("type"),o=t.data("name"),n=t.data("nonce"),a=Hustle.get("Modal_Import");this.importShown&&this.importShown.remove(),this.importShown=new a({model:{id:i,name:o,nonce:n,type:s}})},show_upgrade_modal:function(e){"undefined"!=typeof e&&e.preventDefault(),this.upgrade_modal&&this.upgrade_modal.$el.addClass("wpmudev-modal-active")},view_email_list:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("name"),o=t.data("total"),n=Hustle.get("Modal_Email");this.emailsShown&&this.emailsShown.remove(),this.emailsShown=new n({model:{id:i,total:o,name:s,type:"slidein",module_fields:[]}})},set_testmode_visibiliy:function(e,t){"undefined"==typeof t&&(t=400);var i=e,s=i.data()||{},o=this.$('.wpoi-testmode-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').closest(".test-mode");i.is(":checked")?o.fadeOut(t):o.fadeIn(t)},toggle_tracking_activity:function(t){var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("type");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_slidein_module_toggle_tracking_activity",id:s,type:n,_ajax_nonce:o},complete:function(){location.reload()}})},view_error_log_list:function(t){var i=e(t.currentTarget),s=i.data(),o=s.id,n=s.name,a="slidein",d=Hustle.get("Modal_Error");this.logShown&&this.logShown.remove(),this.logShown=new d({button:i,model:{name:n,id:o,type:a,total:s.total}})},module_status_updated:function(t){var i=this.$(t.target),s=i.val(),o=i.data(),n=i.closest("li.wpmudev-tabs-menu_item");n.addClass("current"),n.siblings().removeClass("current"),o._ajax_nonce=o.nonce,"test"===s?o.action="hustle_slidein_toggle_test_activity":(o.action="hustle_slidein_module_toggle_state","off"===s?o.enabled="false":o.enabled="true"),e.post(ajaxurl,o,function(e){})},select_all:function(t){var i=e(t.target);i.is(":checked")?this.$(".wph-module-checkbox").prop("checked",!0):this.$(".wph-module-checkbox").prop("checked",!1)},apply_bulk_action:function(t){var i=(e(t.target),this.$("select#wpmudev-bulk-action").val()),s=this.$('select#wpmudev-bulk-action option[value="'+i+'"]').data("nonce"),o=[];"delete"===i&&(this.$(".wph-module-checkbox:checked").each(function(){o.push(e(this).data("id"))}),_.isEmpty(o)||this.delete_confirmation&&(this.delete_confirmation.opts.ids=JSON.stringify(o),this.delete_confirmation.opts.multiple=1,this.delete_confirmation.opts.nonce=s,this.delete_confirmation.$el.addClass("wpmudev-modal-active")))},duplicate:function(t){var i=this,s=e(t.target),o=s.data("id"),n=s.data("nonce"),a=s.data("type");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_slidein_duplicate",id:o,type:a,_ajax_nonce:n},success:function(e){e.success?location.reload():e.data.requires_pro&&i.show_upgrade_modal()},error:function(){location.reload()}})}})}),Hustle.define("Slidein.Models",function(){"use strict";var e=Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"slidein"})}),t=Hustle.get("Models.M").extend({defaults:{module_name:"",has_title:!1,title:"",sub_title:"",main_content:"",use_feature_image:!1,feature_image:"",feature_image_location:"left",feature_image_hide_on_mobile:!1,show_cta:!1,show_gdpr:!1,cta_label:"",cta_url:"",cta_target:"blank",use_email_collection:!1,save_local_list:!1,local_list_name:"",active_email_service:"",email_services:"",form_elements:"",after_successful_submission:"show_success",success_message:"",after_subscription:"keep_show",gdpr_message:'Yes, I agree with the <a href="#" target="_blank" rel="noopener">privacy policy</a>.',auto_close_success_message:!1,auto_close_time:5,auto_close_unit:"seconds",redirect_url:""}}),i=Hustle.get("Models.M").extend({defaults:{form_layout:"one",feature_image_position:"left",feature_image_fit:"contain",feature_image_horizontal:"center",feature_image_horizontal_px:"-100",feature_image_vertical:"center",feature_image_vertical_px:"-100",style:"cabriolet",customize_colors:!1,main_bg_color:"rgba(56,69,78,1)",image_container_bg:"rgba(53,65,74,1)",form_area_bg:"rgba(93,115,128,1)",title_color:"rgba(253,253,253,1)",subtitle_color:"rgba(253,253,253,1)",content_color:"rgba(173,181,183,1)",link_static_color:"rgba(56,197,181,1)",link_hover_color:"rgba(73,226,209,1)",link_active_color:"rgba(73,226,209,1)",cta_button_static_bg:"rgba(56,197,181,1)",cta_button_hover_bg:"rgba(73,226,209,1)",cta_button_active_bg:"rgba(73,226,209,1)",cta_button_static_color:"rgba(255,255,255,1)",cta_button_hover_color:"rgba(255,255,255,1)",cta_button_active_color:"rgba(255,255,255,1)",optin_input_static_bg:"rgba(253,253,253,1)",optin_input_hover_bg:"rgba(253,253,253,1)",optin_input_active_bg:"rgba(253,253,253,1)",gdpr_content:"#ADB5B7",gdpr_chechbox_background_static:"#FDFDFD",gdpr_checkbox_background_active:"#FDFDFD",gdpr_checkbox_icon:"#38C5B5",optin_input_icon:"rgba(173,181,183,1)",optin_placeholder_color:"rgba(173,181,183,1)",optin_form_field_text_static_color:"rgba(54,59,63,1)",optin_form_field_text_hover_color:"rgba(54,59,63,1)",optin_form_field_text_active_color:"rgba(54,59,63,1)",optin_submit_button_static_bg:"rgba(56,197,181,1)",optin_submit_button_hover_bg:"rgba(73,226,209,1)",optin_submit_button_active_bg:"rgba(73,226,209,1)",optin_submit_button_static_color:"rgba(253,253,253,1)",optin_submit_button_hover_color:"rgba(253,253,253,1)",optin_submit_button_active_color:"rgba(253,253,253,1)",optin_error_text_color:"#F1F1F1",optin_error_text_bg:"#EA6464",optin_mailchimp_title_color:"rgba(253,253,253,1)",optin_mailchimp_labels_color:"rgba(173,181,183,1)",optin_check_radio_bg:"rgba(253,253,253,1)",optin_check_radio_tick_color:"rgba(56,197,181,1)",optin_success_tick_color:"rgba(55,198,181,1)",optin_success_content_color:"rgba(253,253,253,1)",overlay_bg:"rgba(51,51,51,0.9)",close_button_static_color:"rgba(56,197,181,1)",close_button_hover_color:"rgba(73,226,209,1)",close_button_active_color:"rgba(73,226,209,1)",border:!1,border_radius:5,border_weight:3,border_type:"solid",border_color:"rgba(218,218,218,1)",form_fields_border:!1,form_fields_border_radius:5,form_fields_border_weight:3,form_fields_border_type:"solid",form_fields_border_color:"rgba(218,218,218,1)",button_border:!1,button_border_radius:5,button_border_weight:3,button_border_type:"solid",button_border_color:"rgba(218,218,218,1)",gdpr_border:!1,gdpr_border_radius:5,gdpr_border_weight:3,gdpr_border_type:"solid",gdpr_border_color:"rgba(218,218,218,1)",form_fields_icon:"static",form_fields_proximity:"joined",drop_shadow:!1,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0.2)",customize_size:!1,custom_height:300,custom_width:600,customize_css:!1,custom_css:""}}),s=Hustle.get("Models.Trigger"),o=Hustle.get("Models.M").extend({defaults:{conditions:"",triggers:"",animation_in:"slideInUp",animation_out:"slideOutUp",after_close:"keep_show",display_position:"s",auto_hide:!1,auto_hide_time:5,auto_hide_unit:"hours",expiration:365,expiration_unit:"days",allow_scroll_page:!1,not_close_on_background_click:!1,on_submit:"default"},initialize:function(e){if(_.extend(this,e),this.get("triggers")instanceof Backbone.Model||this.set("triggers",new s(this.triggers)),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}});return{Base:e,Content:t,Design:i,Display_Settings:o}}),Hustle.define("Slidein.Settings_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-slidein-section-settings-tpl"),target_container:e("#wpmudev-hustle-box-section-settings"),init:function(e){if(this.conditions_view=e.conditions_view,this.target_container.length)return this.render()},render:function(e){return this.setElement(this.template(_.extend({shortcode_id:optin_vars.current.shortcode_id},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&this.$(".wph-conditions").replaceWith(this.conditions_view.$el)}}))}),Hustle.define("Slidein.View",function(e,t,i){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-slidein-wizard-view",preview:!1,preview_model:!1,events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(t){return this.content_view=t.content_view,this.design_view=t.design_view,this.settings_view=t.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.content_view.model,"change",this.content_view_changed),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.stopListening(this.settings_view.model,"change",this.settings_view_changed),e(document).off("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),e(document).off("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).off("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).off("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).off("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).off("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).off("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).off("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).off("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).off("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).off("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).off("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).off("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).off("keydown",e.proxy(this.escape_key,this)),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.content_view.model,"change",this.content_view_changed),this.listenTo(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.settings_view.model,"change",this.settings_view_changed),e(document).on("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),e(document).on("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).on("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).on("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).on("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).on("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).on("click","ul.wpmudev-feature-image-location li",e.proxy(this.toggle_feature_image_options,this)),e(document).on("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).on("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).on("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).on("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).on("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).on("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).on("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).on("change keyup keypress","input[name=module_name]",e.proxy(this.validate_modal_name,this)),e(document).on("keydown",e.proxy(this.escape_key,this)),Hustle.Events.on("modules.view.preview.success",e.proxy(this.preview_success_message_delay,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render();var e=parseInt(this.content_view.model.get("use_email_collection"));this.use_email_collection_changed(e,!1),e&&this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.target_container.html(""),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render(),this.settings_view.target_container.html(""),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},set_content_from_tinymce:function(e){if(e=e||!1,"undefined"!=typeof tinyMCE){var t=tinyMCE.get("main_content"),i=this.$("textarea#main_content"),s="true"===i.attr("aria-hidden")?t.getContent():i.val();this.content_view.model.set("main_content",s,{silent:e});var o=tinyMCE.get("success_message"),n=this.$("textarea#success_message"),a="true"===n.attr("aria-hidden")?o.getContent():n.val();this.content_view.model.set("success_message",a,{silent:e});var d=tinyMCE.get("gdpr_message"),l=this.$("textarea#gdpr_message"),r="true"===l.attr("aria-hidden")?d.getContent():l.val();this.content_view.model.set("gdpr_message",r,{silent:e})}},sanitize_data:function(){var e=this.content_view.model.get("cta_url");/^(f|ht)tps?:\/\//i.test(e)||(e="http://"+e,this.content_view.model.set("cta_url",e,{silent:!0})),this.design_view.update_custom_css()},apply_custom_size:function(){var e=(this.content_view.model.toJSON(),this.design_view.model.toJSON()),t=(e.style,e.form_layout,this.$("#wph-preview-modal")),i=t.find(".hustle-modal");i.find(".hustle-modal-body");_.isTrue(e.customize_size)&&i.css({width:e.custom_width+"px","max-width":"unset",height:e.custom_height+"px","max-height":"unset"})},apply_custom_css:function(){var t=e("#hustle-module-custom-styles");t.remove();var i=this.design_view.model.toJSON().customize_css;if(1===i||"1"===i){var s=this.design_view.model.get("custom_css"),o=e("#hustle_custom_css").data("nonce"),n=e(".wpmudev-preview").data("customCssNonce");if(_.isEmpty(s)||"undefined"==typeof o){if("undefined"===n)return;o=n}e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_slidein_prepare_custom_css",css:s,_ajax_nonce:o},success:function(t){if(t&&t.success){var i=e("#hustle-module-custom-styles");i.length&&i.remove(),e('<style id="hustle-module-custom-styles">'+t.data+"</style>").appendTo("body")}},error:function(){}})}},close_preview:function(t){t.stopPropagation();var i=this.$("#wph-preview-modal"),s=i.find(".hustle-modal"),o=this.get_slide_in_direction(this.settings_view.model.get("display_position"),"out"),n="hustle-animate-slideIn"+o,a="hustle-animate-slideOut"+o,d=1e3;s.removeClass(n).addClass(a),setTimeout(function(){i.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),s.removeClass(a)},d)},get_slide_in_direction:function(e,t){return"nw"===e||"w"===e||"sw"===e?"Left":"ne"===e||"e"===e||"se"===e?"Right":"s"===e&&"in"===t||"n"===e&&"out"===t?"Up":"Down"},provider_add_custom_fields:function(t,i,s,o){var n=o.content_view.model.get("active_email_service");if(Module.Utils.service_supports_fields(0,n)===!0&&("form_elements"in s||"email_services"in s||"active_email_service"in s)&&"object"==typeof o.content_view.model.get("form_elements")){var a=JSON.stringify(o.content_view.model.get("form_elements")),n=o.content_view.model.get("active_email_service"),d=t,l={action:"add_module_fields",_ajax_nonce:i,data:a,provider:n,module_id:d};e.post(ajaxurl,l,function(e){}).fail(function(e){console.log("There was an error saving the custom fields.")})}},save:function(t){if(!Module.Validate.validate_module_name())return!1;var i=this.content_view.model.changed;if(this.set_content_from_tinymce(!0),this.sanitize_data(),"undefined"!=typeof tinyMCE){var s=tinyMCE.get("main_content"),o=this.$("textarea#main_content"),n="true"===o.attr("aria-hidden")?s.getContent():o.val();this.content_view.model.set("main_content",n,{silent:!0});var a=tinyMCE.get("success_message"),d=this.$("textarea#success_message"),l="true"===d.attr("aria-hidden")?a.getContent():d.val();this.content_view.model.set("success_message",l,{silent:!0})}var r=this,c=t.data("id")?t.data("id"):"-1",_=t.data("nonce"),u=this.model.toJSON(),p=this.content_view.model.toJSON(),m=this.design_view.model.toJSON(),h=this.settings_view.model.toJSON();return e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_slidein_module",_ajax_nonce:_,id:c,module:u,content:p,design:m,settings:h,shortcode_id:r._get_shortcode_id()},complete:function(e){r.provider_add_custom_fields(c,_,i,r);e.responseJSON}})},save_changes:function(t){t.preventDefault();var i=this,s=e(t.currentTarget);i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").addClass("wpmudev-button-onload").prop("disabled",!0);var o=this.save(s);o?o.done(function(t){if("string"==typeof t&&(t=JSON.parse(t)),t.success){var o=window.location.pathname+window.location.search;o.indexOf("&id=")===-1&&(o=o+"&id="+t.data,window.history.replaceState({},"",o),
i.$(".wpmudev-menu-content-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){e(this).attr("href",e(this).data("link")+"&id="+t.data)})),s.data("id",t.data),s.siblings().data("id",t.data),Module.hasChanges=!1;var n=optin_vars.current.section||!1;if("settings"===n){var a=t.data;if(s.hasClass("wpmudev-button-finish"))return window.location.replace("?page="+optin_vars.current.listing_page+"&module="+a)}}}).always(function(){i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").removeClass("wpmudev-button-onload").prop("disabled",!1)}):i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_continue:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.currentTarget));s?s.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,s=optin_vars.current.section,o="";return window.onbeforeunload=null,s&&"content"!==s?"design"===s&&(o=i.$(".wpmudev-menu-settings-link a").data("link")):o=i.$(".wpmudev-menu-design-link a").data("link"),o.indexOf("&id")===-1&&(o+="&id="+t),window.location.replace(o)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_finish:function(t){t.preventDefault();var i=this;i.$('select[data-attribute="after_close"]').trigger("change"),i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").addClass("wpmudev-button-onload").prop("disabled",!0),this.model.set("active",1,{silent:!0});var s=this.save(e(t.currentTarget));s?s.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,void window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").removeClass("wpmudev-button-onload").prop("disabed",!1)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();var t=this;t.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var i=optin_vars.current.section;window.onbeforeunload=null,"design"===i?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"settings"===i&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"content"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},content_view_changed:function(e){var t=e.changed,i=Object.keys(t);if("has_title"in t){var s=this.$("#wph-wizard-content-title-textboxes");s.length&&(t.has_title?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_feature_image"in t){var s=this.$("#wph-wizard-content-image-options");s.length&&(t.use_feature_image?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_cta"in t){var s=this.$("#wph-wizard-content-cta-options");s.length&&(t.show_cta?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_gdpr"in t){var s=this.$("#wph-wizard-content-gdpr-message");s.length&&(t.show_gdpr?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_email_collection"in t&&this.use_email_collection_changed(t.use_email_collection),"after_successful_submission"in t&&this.after_successful_submission_changed(t.after_successful_submission),"auto_close_success_message"in t){var s=this.$("#wph-wizard-content-form_success_options");s.length&&(t.auto_close_success_message?(s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.addClass("wpmudev-hidden"),s.removeClass("wpmudev-show")))}if("save_local_list"in t){var s=this.$("#wph-wizard-content-local_list_name");s.length&&(t.save_local_list?(s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.addClass("wpmudev-hidden"),s.removeClass("wpmudev-show")))}if(i[0].indexOf("_service_provider")!==-1){var o=i[0].replace("_service_provider","");this.handle_email_service(o,t[o+"_service_provider"])}},design_view_changed:function(e){var t=e.changed;if("form_layout"in t){var i=this.$(".wpmudev-box-layouts"),s=i.find(".wpmudev-box-layout_"+t.form_layout);i.length&&s.length&&(s.siblings().removeClass("active"),s.hasClass("active")||s.addClass("active"),this.design_view.hide_unwanted_options())}if("style"in t&&this.update_color_palette(t.style),"customize_colors"in t){var o=this.$("#wph-modal-styles-palette"),n=this.$("#wph-modal-palette");o.length&&(t.customize_colors?(o.removeClass("wpmudev-hidden"),o.addClass("wpmudev-show")):(o.addClass("wpmudev-hidden"),o.removeClass("wpmudev-show"))),n.length&&(t.customize_colors?(n.removeClass("wpmudev-hidden"),n.addClass("wpmudev-show")):(n.addClass("wpmudev-hidden"),n.removeClass("wpmudev-show")))}if("feature_image_fit"in t){var s=this.$("#wph-wizard-content-image_fit_horizontal_vertical_options");s.length&&("contain"===t.feature_image_fit||"cover"===t.feature_image_fit?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_horizontal"in t){var s=this.$("#wph-wizard-design-horizontal-position");s.length&&("custom"===t.feature_image_horizontal?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_vertical"in t){var s=this.$("#wph-wizard-design-vertical-position");s.length&&("custom"===t.feature_image_vertical?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("border"in t){var s=this.$("#wph-wizard-design-border-options");s.length&&(t.border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("form_fields_border"in t){var s=this.$("#wph-wizard-design-form-fields-border-options");s.length&&(t.form_fields_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("button_border"in t){var s=this.$("#wph-wizard-design-button-border-options");s.length&&(t.button_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("gdpr_border"in t){var s=this.$("#wph-wizard-design-gdpr-border-options");s.length&&(t.gdpr_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("drop_shadow"in t){var s=this.$("#wph-wizard-design-shadow-options");s.length&&(t.drop_shadow?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_size"in t){var s=this.$("#wph-wizard-design-size-options");s.length&&(t.customize_size?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_css"in t){var s=this.$("#wph-wizard-design-css_holder");s.length&&(t.customize_css?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}},update_color_palette:function(e){var t=this,i=parseInt(this.content_view.model.get("use_email_collection"));if(i){var s=this.$('option[value="'+e+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];this.design_view.model.set("customize_colors",0),this.$('input[data-attribute="customize_colors"]').removeAttr("checked"),_.each(n,function(e,i){t.$('input[data-attribute="'+i+'"]').val(e).trigger("change")})}}},reset_color_palette:function(){var e=this,t=this.$("#wph-wizard-design-palette .select2-selection__rendered").attr("title").toLowerCase().replace(/\s/g,"_"),i=parseInt(this.content_view.model.get("use_email_collection"),10);if(i){var s=this.$('option[value="'+t+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];_.each(n,function(t,i){e.$('input[data-attribute="'+i+'"]').val(t).trigger("change")})}}},use_email_collection_changed:function(e,t){var i=this.$("#wph-wizard-content-email"),s=this.$("#wph-wizard-content-email-options"),o=this.$("#wph-wizard-content-form_elements"),n=this.$("#wph-wizard-content-gdpr"),a=this.$("#wph-wizard-content-gdpr-message"),d=this.$("#wph-wizard-content-form_submission"),l=this.$("#wph-wizard-content-form_message"),r=this.$("#wph-wizard-content-form_success"),c=this.$("#wph-wizard-content-recaptcha");parseInt(e)?(i.removeClass("last"),s.removeClass("wpmudev-hidden_table"),s.addClass("wpmudev-show_table"),o.show(),n.show(),a.show(),d.show(),c.show(),this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),t&&this.design_view.model.set("style","gray_slate")):(i.hasClass("last")||i.addClass("last"),s.removeClass("wpmudev-show_table"),s.addClass("wpmudev-hidden_table"),o.hide(),n.hide(),a.hide(),d.hide(),l.hide(),r.hide(),c.hide(),t&&this.design_view.model.set("style","cabriolet"))},after_successful_submission_changed:function(e){var t=this.$("#wph-wizard-content-form_submission_redirect_url"),i=this.$("#wph-wizard-content-form_message"),s=this.$("#wph-wizard-content-form_success");"redirect"===e?(t.length&&t.removeClass("wpmudev-hidden"),i.length&&s.length&&(i.hide(),s.hide())):(t.length&&!t.hasClass("wpmudev-hidden")&&t.addClass("wpmudev-hidden"),i.length&&s.length&&(i.show(),s.show()))},toggle_feature_image_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("feature_image_location",s.val(),{silent:!0})},toggle_cta_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("cta_target",s.val(),{silent:!0})},toggle_submit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("after_successful_submission",s.val())},toggle_feature_image_position_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_position",s.val(),{silent:!0})},toggle_feature_image_fit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_fit",s.val(),{silent:!1})},toggle_feature_image_horizontal_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_horizontal",s.val(),{silent:!1})},toggle_feature_image_vertical_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_vertical",s.val(),{silent:!1})},toggle_form_fields_icon_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_icon",s.val(),{silent:!1})},toggle_form_fields_proximity_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_proximity",s.val(),{silent:!1})},toggle_display_triggers:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.settings_view.model.set("triggers.trigger",s.val(),{silent:!0}),this.display_triggers_changed(this.settings_view.model.get("triggers"))},display_triggers_changed:function(e){var t=e.changed;if("trigger"in t){var i=this.$("#wpmudev-display-trigger-"+t.trigger);i.length&&(i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"))}},settings_view_changed:function(e){var t=e.changed;if("on_time"in t){var i=this.$("#wpmudev-display-trigger-time-options");i.length&&(t.on_time?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_time",t.on_time,{silent:!0})}if("on_scroll"in t){var s=this.$("#wpmudev-display-trigger-scroll-options"),o=s.find(".wpmudev-show"),n=s.find(".wpmudev-hidden");s.length&&(o.removeClass("wpmudev-show").addClass("wpmudev-hidden"),n.removeClass("wpmudev-hidden").addClass("wpmudev-show")),this.settings_view.model.set("triggers.on_scroll",t.on_scroll,{silent:!0})}if("on_exit_intent_delayed"in t){var i=this.$("#wpmudev-display-exit-intent-delayed-options");i.length&&(t.on_exit_intent_delayed?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_exit_intent_delayed",t.on_exit_intent_delayed,{silent:!0})}if("on_adblock"in t&&this.settings_view.model.set("triggers.on_adblock",t.on_adblock,{silent:!0}),"auto_hide"in t){var i=this.$("#wpmudev-display-auto_hide-options");i.length&&(t.auto_hide?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.auto_hide",t.auto_hide,{silent:!0})}"display_position"in t&&this.settings_view.model.set("display_position",t.display_position,{silent:!0})},open_preview:function(e){e.preventDefault(),e.stopPropagation(),this.handle_preview()},handle_preview:function(){this.set_content_from_tinymce(!0),this.sanitize_data();var t=this.$("#wph-preview-modal .wpmudev-modal-mask").siblings(".hustle-modal");t.length&&t.remove();var i=this,s=i.content_view.model.get("main_content"),o=e(".wpmudev-preview").data("nonce");s.search(/\[/g)===-1?i.render_preview(i.content_view.model.toJSON()):e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_shortcode_render",content:s,_ajax_nonce:o},success:function(e){if(e&&e.data&&e.data.content){var t=_.extend(i.content_view.model.toJSON(),{main_content:e.data.content});i.render_preview(t)}}})},render_preview:function(t){var i=this,s=e(".wpmudev-preview").data("sitekey"),o=this.$("#wph-preview-modal"),n=this.content_view.model.get("use_email_collection"),a=_.isTrue(n)?Optin.template("wpmudev-hustle-modal-with-optin-tpl"):Optin.template("wpmudev-hustle-modal-without-optin-tpl"),d=_.extend(i.model.toJSON(),{content:t,design:i.design_view.model.toJSON(),settings:i.settings_view.model.toJSON()});d.unique_id="",o.append(a(d)),o.addClass("hui-module-type--slidein"),"1"===t.use_email_collection&&"undefined"!=typeof t.form_elements.recaptcha&&s&&(o.find(".hustle-modal-body button").attr("disabled",!0),grecaptcha.ready(function(){grecaptcha.render("hustle-modal-recaptcha"+d.module_id,{sitekey:s,callback:function(){o.find(".hustle-modal-body button").removeAttr("disabled")}})})),i.apply_custom_css(),i.apply_preview_styles(),i.after_preview_render(),Hustle.Events.trigger("modules.view.rendered",i)},after_preview_render:function(){var t=this,i=this.$("#wph-preview-modal").removeClass("inc_opt_slidein_nw inc_opt_slidein_n inc_opt_slidein_ne inc_opt_slidein_w inc_opt_slidein_e inc_opt_slidein_sw inc_opt_slidein_s inc_opt_slidein_se").addClass("wpmudev-modal-active inc_opt_slidein_"+this.settings_view.model.get("display_position")),s=i.find(".hustle-modal"),o=i.find(".hustle-modal-success"),n=this.get_slide_in_direction(this.settings_view.model.get("display_position"),"in"),a="hustle-animate-slideIn"+n;e("body").addClass("wpmudev-modal-is_active"),o.css({height:i.find(".hustle-modal-body").height()+"px"}),setTimeout(function(){s.addClass(a),t.apply_custom_size()},100)},apply_preview_styles:function(){var t=this.content_view.model.toJSON(),i=this.design_view.model.toJSON(),s=i.style;if(_.isTrue(t.use_email_collection))return void this.apply_preview_optin_styles();var o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=n.find(".hustle-modal-body"),d=n.find(".hustle-modal-body section"),l=n.find(".hustle-modal-title"),r=n.find(".hustle-modal-subtitle"),c=n.find(".hustle-modal-image"),u=n.find(".hustle-modal-message, .hustle-gdpr-content"),p=n.find("article blockquote, .hustle-modal-message blockquote"),m=n.find("article a, .hustle-modal-message a"),h=n.find(".hustle-modal-cta"),v=n.find(".hustle-modal-close"),g=n.find(".hustle-modal-close svg path"),f=n.find(".wpmudev-modal-mask"),w=n.find(".hustle-gdpr-box .hustle-gdpr-content"),b=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox input"),y=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox span");if("cabriolet"===s?d.css("background-color",i.main_bg_color):a.css("background-color",i.main_bg_color),l.css("color",i.title_color),r.css("color",i.subtitle_color),c.css("background-color",i.image_container_bg),u.css("color",i.content_color),p.css("border-left-color",i.link_static_color),p.mouseover(function(){e(this).css("border-left-color",i.link_hover_color)}).mouseout(function(){e(this).css("border-left-color",i.link_static_color)}),m.css("color",i.link_static_color),m.mouseover(function(){e(this).css("color",i.link_hover_color)}).mouseout(function(){e(this).css("color",i.link_static_color)}),h.css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color}),h.mouseover(function(){e(this).css({"background-color":i.cta_button_hover_bg,color:i.cta_button_hover_color})}).mouseout(function(){e(this).css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color})}),_.isTrue(t.show_gdpr)){if(w.css("color",i.gdpr_content),_.isTrue(i.gdpr_border)){var x=i.gdpr_border_weight+"px "+i.gdpr_border_type+" "+i.gdpr_border_color;y.css({border:x,"border-radius":i.gdpr_border_radius+"px"})}y.css({"background-color":i.gdpr_chechbox_background_static,color:i.gdpr_checkbox_icon}),b.click(function(){y.toggleClass("gdpr-is-active",function(){y.hasClass("gdpr-is-active")?y.css({"background-color":i.gdpr_checkbox_background_active}):y.css({"background-color":i.gdpr_chechbox_background_static})})})}g.css("fill",i.close_button_static_color),v.mouseover(function(){g.css("fill",i.close_button_hover_color)}).mouseout(function(){g.css("fill",i.close_button_static_color)}),f.css("background-color",i.overlay_bg);var C=o.find(".hustle-modal-image img"),k="",$="";if("contain"!==i.feature_image_fit&&"cover"!==i.feature_image_fit||(k="custom"===i.feature_image_horizontal?i.feature_image_horizontal_px+"px":i.feature_image_horizontal,$="custom"===i.feature_image_vertical?i.feature_image_vertical_px+"px":i.feature_image_vertical,C.css("object-position",k+" "+$)),"right"===t.feature_image_location&&c.addClass("hustle-modal-image-right"),_.isTrue(i.border)){var S=i.border_weight+"px "+i.border_type+" "+i.border_color;"cabriolet"===s?n.find("section").css({border:S,"border-radius":i.border_radius+"px"}):a.css({border:S,"border-radius":i.border_radius+"px"})}if(_.isTrue(i.drop_shadow)){var O=i.drop_shadow_x+"px "+i.drop_shadow_y+"px "+i.drop_shadow_blur+"px "+i.drop_shadow_spread+"px "+i.drop_shadow_color;"cabriolet"===s?n.find("section").css({"box-shadow":O}):a.css({"box-shadow":O})}},apply_preview_optin_styles:function(){var t=this.content_view.model.toJSON(),i=this.design_view.model.toJSON(),s=i.form_layout,o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=n.find(".hustle-modal-body"),d=n.find(".hustle-modal-success"),l=n.find(".hustle-modal-title"),r=n.find(".hustle-modal-subtitle"),c=n.find("article"),u=n.find("article blockquote"),p=n.find("article a:not(.hustle-modal-cta)"),m=n.find(".hustle-modal-image"),h=n.find(".hustle-modal-optin_field"),v=h.find("input"),g=h.find("label .hustle-modal-optin_icon .hustle-icon path"),f=h.find("label .hustle-modal-optin_placeholder"),w=n.find(".hustle-modal-optin_button button"),b=n.find(".hustle-modal-mc_checkbox input+label, .hustle-modal-mc_checkbox input:checked+label"),y=n.find(".hustle-modal-mc_radio input+label, .hustle-modal-mc_radio input:checked+label"),x=n.find(".hustle-modal-close"),C=n.find(".hustle-modal-close svg path"),k=n.find(".hustle-gdpr-box .hustle-gdpr-content"),$=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox input"),S=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox span");if(a.find("section").css("background-color",i.main_bg_color),d.css("background-color",i.main_bg_color),a.find(".hustle-modal-image").css("background-color",i.image_container_bg),"one"===s||"two"===s?n.find("footer").css("background-color",i.form_area_bg):n.find(".hustle-modal-optin_wrap").css("background-color",i.form_area_bg),l.css("color",i.title_color),r.css("color",i.subtitle_color),c.css("color",i.content_color),u.css("border-left-color",i.link_static_color),p.css("color",i.link_static_color),p.mouseover(function(){e(this).css("color",i.link_hover_color)}).mouseout(function(){e(this).css("color",i.link_static_color)}),c.find(".hustle-modal-cta").css({background:i.cta_button_static_bg,color:i.cta_button_static_color}),c.find(".hustle-modal-cta").mouseover(function(){e(this).css({background:i.cta_button_hover_bg,color:i.cta_button_hover_color})}).mouseout(function(){e(this).css({background:i.cta_button_static_bg,color:i.cta_button_static_color})}),_.isTrue(t.show_gdpr)){if(k.css("color",i.gdpr_content),_.isTrue(i.gdpr_border)){var O=i.gdpr_border_weight+"px "+i.gdpr_border_type+" "+i.gdpr_border_color;S.css({border:O,"border-radius":i.gdpr_border_radius+"px"})}S.css({"background-color":i.gdpr_chechbox_background_static,color:i.gdpr_checkbox_icon}),$.click(function(){S.toggleClass("gdpr-is-active",function(){S.hasClass("gdpr-is-active")?S.css({"background-color":i.gdpr_checkbox_background_active}):S.css({"background-color":i.gdpr_chechbox_background_static})})})}v.css("color",i.optin_form_field_text_static_color),v.css("background-color",i.optin_input_static_bg),h.mouseover(function(){e(this).find("input").css("color",i.optin_form_field_text_hover_color),e(this).find("input").css("background-color",i.optin_input_hover_bg)}).mouseout(function(){e(this).find("input").css("color",i.optin_form_field_text_static_color),e(this).find("input").css("background-color",i.optin_input_static_bg)}),g.css("fill",i.optin_input_icon),w.css("color",i.optin_submit_button_static_color),w.css("background-color",i.optin_submit_button_static_bg),w.mouseover(function(){e(this).css("color",i.optin_submit_button_hover_color),e(this).css("background-color",i.optin_submit_button_hover_bg)}).mouseout(function(){e(this).css("color",i.optin_submit_button_static_color),e(this).css("background-color",i.optin_submit_button_static_bg)}),f.css("color",i.optin_placeholder_color),b.css("background-color",i.optin_check_radio_static_bg),y.css("background-color",i.optin_check_radio_static_bg);var z=e("#hustle-module-checkbox-radio-custom-styles"),H=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input+label:before",M=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input:checked+label:before",T=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input+label:before",j=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input:checked+label:before",E=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_title label",D=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_label label",P=".wpmudev-ui .wpmudev-modal .wpmudev-modal-mask",N=H+" { color: "+i.optin_check_radio_static_bg+"; }"+M+" { color: "+i.optin_check_radio_tick_color+"; }"+T+" { color: "+i.optin_check_radio_static_bg+"; }"+j+" { color: "+i.optin_check_radio_tick_color+"; }"+E+" { color: "+i.optin_mailchimp_title_color+"; }"+D+" { color: "+i.optin_mailchimp_labels_color+"; }"+P+" { background-color: "+i.overlay_bg+"; }";z.length&&z.remove(),e('<style id="hustle-module-mailchimp-custom-styles">'+N+"</style>").appendTo("body"),C.css("fill",i.close_button_static_color),x.mouseover(function(){C.css("fill",i.close_button_hover_color)}).mouseout(function(){C.css("fill",i.close_button_static_color)});var V=o.find(".hustle-modal-image img"),J="",B="";if("contain"!==i.feature_image_fit&&"cover"!==i.feature_image_fit||(J="custom"===i.feature_image_horizontal?i.feature_image_horizontal_px+"px":i.feature_image_horizontal,B="custom"===i.feature_image_vertical?i.feature_image_vertical_px+"px":i.feature_image_vertical,V.css({"background-position":J+" "+B,"object-position":J+" "+B})),_.isTrue(i.border)){var I=i.border_weight+"px "+i.border_type+" "+i.border_color;a.css({border:I,"border-radius":i.border_radius+"px"})}if("right"===t.feature_image_location&&m.addClass("hustle-modal-image-right"),_.isTrue(i.drop_shadow)){var F=i.drop_shadow_x+"px "+i.drop_shadow_y+"px "+i.drop_shadow_blur+"px "+i.drop_shadow_spread+"px "+i.drop_shadow_color;a.css({"box-shadow":F})}if(_.isTrue(i.form_fields_border)){var U=i.form_fields_border_weight+"px "+i.form_fields_border_type+" "+i.form_fields_border_color;v.css({border:U,"border-radius":i.form_fields_border_radius+"px"})}if(_.isTrue(i.button_border)){var L=i.button_border_weight+"px "+i.button_border_type+" "+i.button_border_color;w.css({border:L,"border-radius":i.button_border_radius+"px"})}},handle_email_service:function(t,i){var s=this.content_view.model.get("email_services");_.isEmpty(s)&&(s={}),i?(this.content_view.model.set("active_email_service",t),_.isEmpty(s)?s[t]={enabled:i}:_.each(s,function(i,o){o===t?s[o]=_.extend(s[o],{enabled:1}):(s[o]=_.extend(s[o],{enabled:0}),e('input[data-attribute="'+o+'_service_provider"]').removeAttr("checked"))})):(this.content_view.model.set("active_email_service",""),s[t]=_.extend(s[t],{enabled:i})),this.content_view.model.set("email_services",s)},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")},escape_key:function(e){27===e.keyCode&&this.close_preview(e)},preview_success_message_delay:function(e){var t=this.content_view.model,i=t.get("auto_close_success_message"),s=this.content_view.model.get("auto_close_time"),o=this.content_view.model.get("auto_close_unit"),n=e.$("#wph-preview-modal").addClass("wpmudev-modal-active");if(_.isTrue(i)){var a=parseInt(s),d=o;"minutes"===d&&(a*=60),a*=1e3,_.delay(function(){var e=n.find(".hustle-modal"),t=e.find(".hustle-modal-close .hustle-icon");t.length>0?t.trigger("click"):$success_msg.removeAttr("style")},a)}}})}),Hustle.define("Embedded.Content_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-embedded-section-content-tpl"),module_id:0,target_container:e("#wpmudev-hustle-box-section-content"),editing_service:"",is_service_modal_updated:!1,current_form_elements:[],content_form_container:e(".wph-form-element-list"),events:{"click .wph-email-service-edit-link":"edit_email_service","click #wph-add-another-service":"add_email_service","click #wph-edit-form":"manage_form_fields"},init:function(e){this.module_id=e.module_id,this.module_type="embedded",_.each(Optin.Mixins.get_services_mixins(),function(e,t){e&&"function"==typeof e&&(this[t]=e(this))},this),this.service_modal=new Module.Service_Modal({view:this}),this.form_fields_modal=new Module.Form_Fields({view:this})},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return"undefined"==typeof t.email_services.mailchimp&&(t.email_services={mailchimp:this.mailchimp.default_data}),""===t.form_elements&&"undefined"!=typeof wph_default_form_elements&&(this.model.set("form_elements",wph_default_form_elements),this.current_form_elements=wph_default_form_elements),this.setElement(this.template(_.extend({module_type:"embedded"},t))),this}},after_render:function(){this.target_container.length&&this.render_featured_image()},render_featured_image:function(){var e=Hustle.get("Featured_Image_Holder"),t=this.$("#wph-embedded-choose_image");t.length&&(this.media_holder=new e({model:this.model,attribute:"feature_image",module_type:"embedded",target_div:t}),t.html(""),t.html(this.media_holder.$el))},add_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.add_service(i)},edit_email_service:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.target);this.service_modal.edit_service(i)},manage_form_fields:function(e){e.preventDefault(),e.stopPropagation(),this.form_fields_modal.manage_form()}}))}),Hustle.define("Embedded.Design_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-embedded-section-design-tpl"),target_container:e("#wpmudev-hustle-box-section-design"),use_email_collection:!1,css_editor:!1,stylables:{".hustle-modal .hustle-modal-close .hustle-icon ":"Close Icon",".hustle-modal .hustle-modal-body ":"Modal Container",".hustle-modal .hustle-modal-image ":"Image Container",".hustle-modal .hustle-modal-image .hustle-modal-feat_image, .hustle-modal .hustle-modal-image img ":"Modal Image",".hustle-modal .hustle-modal-optin_form ":"Form Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field ":"Form Input Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button ":"Form Button Container",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_field input ":"Form Input",".hustle-modal .hustle-modal-optin_form .hustle-modal-optin_button button ":"Form Button"},events:{"click .wpmudev-css-stylable":"insert_stylable_element"},init:function(e){if(this.target_container.length)return this.use_email_collection=e.use_email_collection,this.render()},render:function(e){return this.setElement(this.template(_.extend({use_email_collection:this.use_email_collection,stylables:this.stylables},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.create_css_editor(),this.hide_unwanted_options())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(t,i){var s=e(this);s.val(i.color.toCSS()).trigger("change")}})},create_css_editor:function(){this.css_editor=ace.edit("hustle_custom_css"),this.css_editor.getSession().setMode("ace/mode/css"),this.css_editor.$blockScrolling=1/0,this.css_editor.setTheme("ace/theme/hustle"),this.css_editor.getSession().setUseWrapMode(!0),this.css_editor.getSession().setUseWorker(!1),this.css_editor.setShowPrintMargin(!1),this.css_editor.renderer.setShowGutter(!0),this.css_editor.setHighlightActiveLine(!0)},hide_unwanted_options:function(){"one"===this.model.get("form_layout")&&_.isTrue(this.use_email_collection)?(this.$("#wpmudev-tabs-menu_item_above").show(),
this.$("#wpmudev-tabs-menu_item_below").show(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").removeAttr("style")):(this.$("#wpmudev-tabs-menu_item_above").hide(),this.$("#wpmudev-tabs-menu_item_below").hide(),this.$("#wpmudev-tabs-menu_item_above").prev().find("label").css({"border-right":"1px solid #E1E1E1","border-radius":"0 10px 10px 0","-moz-border-radius":"0 10px 10px 0","-webkit-border-radius":"0 10px 10px 0"}),"right"!==this.model.get("feature_image_position")&&this.$('ul.wpmudev-feature-image-position-options input[value="left"]').parent().click()),this.$el.find("#popup_overlay_color").parents(".wpmudev-col").hide()},update_custom_css:function(){this.css_editor&&this.model.set("custom_css",this.css_editor.getValue())},insert_stylable_element:function(t){t.preventDefault();var i=e(t.target),s=i.data("stylable")+"{}";this.css_editor.navigateFileEnd(),this.css_editor.insert(s),this.css_editor.navigateLeft(1),this.css_editor.focus()}}))}),Hustle.define("Embedded.Listing",function(e){"use strict";var t=Hustle.get("Delete_Confirmation"),i=Hustle.get("Upgrade_Modal");return Backbone.View.extend({el:"#wpmudev-hustle",logShown:!1,events:{"click .module-duplicate":"duplicate","click .import-module-settings":"import_settings","click .wpmudev-row .wpmudev-box-head":"toggle_module_accordion","click #hustle-free-version-create":"show_upgrade_modal","click .wpmudev-row .wpmudev-box-head .wpmudev-box-action":"module_toggle_clicked","click .hustle-delete-module":"delete_module","click .module-active-state":"toggle_module_activity","click .button-view-email-list":"view_email_list","click .button-view-log-list":"view_error_log_list","change .module-toggle-tracking-activity":"toggle_tracking_activity","change [name='wph-module-status']":"module_status_updated","change #wph-optin-service-import-form input[type=file]":"toggle_notice"},initialize:function(){var s=this;this.$(".optin-type-active-state").each(function(){s.set_testmode_visibiliy(e(this),0)}),this.delete_confirmation=new t({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}});var s=this,o=e("#wpmudev-hustle-content .wpmudev-row"),n=o.length,a=n;o.each(function(){e(this).css("z-index",a),a--;var t=e(this).find(".wpmudev-dots-dropdown"),i=t.find(".wpmudev-dots-button"),o=t.find(".wpmudev-dots-nav");i.on("click",function(){e(this).toggleClass("wpmudev-active"),o.toggleClass("wpmudev-hide"),s.$(".wpmudev-dots-nav").not(o).each(function(){e(this).hasClass("wpmudev-hide")||e(this).toggleClass("wpmudev-hide")})})}),this.upgrade_modal=new i,Module.Utils.get_url_param("requires_pro")&&this.show_upgrade_modal()},module_toggle_clicked:function(t){t.stopPropagation(),e(t.target).closest(".wpmudev-box-head").click()},toggle_module_accordion:function(t){if(_.indexOf(["wpmudev-box-head","wpmudev-box-action","wpmudev-box-group","wpmudev-box-group--inner","wpmudev-group-title","wpmudev-helper"],t.target.className)!==-1){var i=e(t.target),s=i.parents(".wpmudev-row").find(".wpmudev-box-action"),o=i.parents(".wpmudev-row").find(".wpmudev-box-body");o.slideToggle("fast",function(){s.toggleClass("wpmudev-action-show"),o.toggleClass("wpmudev-hidden")})}},delete_module:function(t){var i=e(t.target).closest("a.hustle-delete-module"),s=i.data("id"),o=i.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=s,this.delete_confirmation.opts.nonce=o,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},toggle_notice:function(t){e(t.target).val()?e("#select_file_error").addClass("wpmudev-hidden"):e("#select_file_error").removeClass("wpmudev-hidden")},import_settings:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("type"),o=t.data("name"),n=t.data("nonce"),a=Hustle.get("Modal_Import");this.importShown&&this.importShown.remove(),this.importShown=new a({model:{id:i,name:o,nonce:n,type:s}})},show_upgrade_modal:function(e){"undefined"!=typeof e&&e.preventDefault(),this.upgrade_modal&&this.upgrade_modal.$el.addClass("wpmudev-modal-active")},toggle_module_activity:function(t){var i=this.$(t.target),s=i.data()||{},o=i.parents(".wpmudev-row");s.action="hustle_embedded_module_toggle_state",s._ajax_nonce=s.nonce,i.prop("disabled",!0),i.is(":checked")?(o.find(".wpmudev-box-body .wpmudev-box-disabled").removeClass("wpmudev-box-disabled").addClass("wpmudev-box-enabled"),o.find("input").prop("disabled",!1)):(o.find(".wpmudev-box-body .wpmudev-box-enabled").removeClass("wpmudev-box-enabled").addClass("wpmudev-box-disabled"),o.find("input").prop("disabled",!0)),e.post(ajaxurl,s,function(e){i.prop("disabled",!1)})},view_email_list:function(t){t.preventDefault(),t.stopPropagation();var i=e(t.currentTarget).hasClass("wpmudev-button")?e(t.currentTarget):e(t.currentTarget).parents(".wpmudev-button"),s=i.data("id"),o=i.data("name"),n=i.data("total"),a=Hustle.get("Modal_Email");this.emailsShown&&this.emailsShown.remove(),this.emailsShown=new a({model:{id:s,total:n,name:o,type:"embedded",module_fields:[]}})},set_testmode_visibiliy:function(e,t){"undefined"==typeof t&&(t=400);var i=e,s=i.data()||{},o=this.$('.wpoi-testmode-active-state[data-id="'+s.id+'"][data-type="'+s.type+'"]').closest(".test-mode");i.is(":checked")?o.fadeOut(t):o.fadeIn(t)},toggle_tracking_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_embedded_module_toggle_tracking_activity",id:s,type:n,_ajax_nonce:o},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},view_error_log_list:function(t){var i=e(t.currentTarget),s=i.data(),o=s.id,n=s.name,a="embedded",d=Hustle.get("Modal_Error");this.logShown&&this.logShown.remove(),this.logShown=new d({button:i,model:{name:n,id:o,type:a,total:s.total}})},module_status_updated:function(t){var i=this.$(t.target),s=i.val(),o=i.data(),n=i.closest("li.wpmudev-tabs-menu_item");n.addClass("current"),n.siblings().removeClass("current"),o._ajax_nonce=o.nonce,"test"===s?o.action="hustle_embedded_toggle_test_activity":(o.action="hustle_embedded_module_toggle_type_state","off"===s?o.enabled="false":o.enabled="true"),e.post(ajaxurl,o,function(e){})},duplicate:function(t){var i=this,s=e(t.target),o=s.data("id"),n=s.data("nonce"),a=s.data("type");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_embed_duplicate",id:o,type:a,_ajax_nonce:n},success:function(e){e.success?location.reload():e.data.requires_pro&&i.show_upgrade_modal()},error:function(){location.reload()}})}})}),Hustle.define("Embedded.Models",function(){"use strict";var e=Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"embedded"})}),t=Hustle.get("Models.M").extend({defaults:{module_name:"",has_title:!1,title:"",sub_title:"",main_content:"",use_feature_image:!1,feature_image:"",feature_image_location:"left",feature_image_hide_on_mobile:!1,show_cta:!1,show_gdpr:!1,cta_label:"",cta_url:"",cta_target:"blank",use_email_collection:!1,save_local_list:!1,local_list_name:"",active_email_service:"",email_services:"",form_elements:"",after_successful_submission:"show_success",success_message:"",after_subscription:"keep_show",gdpr_message:'Yes, I agree with the <a href="#" target="_blank" rel="noopener">privacy policy</a>.',auto_close_success_message:!1,auto_close_time:5,auto_close_unit:"seconds",redirect_url:""}}),i=Hustle.get("Models.M").extend({defaults:{form_layout:"one",feature_image_position:"left",feature_image_fit:"contain",feature_image_horizontal:"center",feature_image_horizontal_px:"-100",feature_image_vertical:"center",feature_image_vertical_px:"-100",style:"cabriolet",customize_colors:!1,main_bg_color:"rgba(56,69,78,1)",image_container_bg:"rgba(53,65,74,1)",form_area_bg:"rgba(93,115,128,1)",title_color:"rgba(253,253,253,1)",subtitle_color:"rgba(253,253,253,1)",content_color:"rgba(173,181,183,1)",link_static_color:"rgba(56,197,181,1)",link_hover_color:"rgba(73,226,209,1)",link_active_color:"rgba(73,226,209,1)",cta_button_static_bg:"rgba(56,197,181,1)",cta_button_hover_bg:"rgba(73,226,209,1)",cta_button_active_bg:"rgba(73,226,209,1)",cta_button_static_color:"rgba(255,255,255,1)",cta_button_hover_color:"rgba(255,255,255,1)",cta_button_active_color:"rgba(255,255,255,1)",gdpr_content:"#ADB5B7",gdpr_chechbox_background_static:"#FDFDFD",gdpr_checkbox_background_active:"#FDFDFD",gdpr_checkbox_icon:"#38C5B5",optin_input_static_bg:"rgba(253,253,253,1)",optin_input_hover_bg:"rgba(253,253,253,1)",optin_input_active_bg:"rgba(253,253,253,1)",optin_input_icon:"rgba(173,181,183,1)",optin_placeholder_color:"rgba(173,181,183,1)",optin_form_field_text_static_color:"rgba(54,59,63,1)",optin_form_field_text_hover_color:"rgba(54,59,63,1)",optin_form_field_text_active_color:"rgba(54,59,63,1)",optin_submit_button_static_bg:"rgba(56,197,181,1)",optin_submit_button_hover_bg:"rgba(73,226,209,1)",optin_submit_button_active_bg:"rgba(73,226,209,1)",optin_submit_button_static_color:"rgba(253,253,253,1)",optin_submit_button_hover_color:"rgba(253,253,253,1)",optin_submit_button_active_color:"rgba(253,253,253,1)",optin_error_text_color:"#F1F1F1",optin_error_text_bg:"#EA6464",optin_mailchimp_title_color:"rgba(253,253,253,1)",optin_mailchimp_labels_color:"rgba(173,181,183,1)",optin_check_radio_bg:"rgba(253,253,253,1)",optin_check_radio_tick_color:"rgba(56,197,181,1)",optin_success_tick_color:"rgba(55,198,181,1)",optin_success_content_color:"rgba(253,253,253,1)",overlay_bg:"rgba(51,51,51,0.9)",close_button_static_color:"rgba(56,197,181,1)",close_button_hover_color:"rgba(73,226,209,1)",close_button_active_color:"rgba(73,226,209,1)",border:!1,border_radius:5,border_weight:3,border_type:"solid",border_color:"rgba(218,218,218,1)",form_fields_border:!1,form_fields_border_radius:5,form_fields_border_weight:3,form_fields_border_type:"solid",form_fields_border_color:"rgba(218,218,218,1)",button_border:!1,button_border_radius:5,button_border_weight:3,button_border_type:"solid",button_border_color:"rgba(218,218,218,1)",gdpr_border:!1,gdpr_border_radius:5,gdpr_border_weight:3,gdpr_border_type:"solid",gdpr_border_color:"rgba(218,218,218,1)",form_fields_icon:"static",form_fields_proximity:"joined",drop_shadow:!1,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0.2)",customize_size:!1,custom_height:300,custom_width:600,customize_css:!1,custom_css:""}}),s=(Hustle.get("Models.Trigger"),Hustle.get("Models.M").extend({defaults:{after_content_enabled:!1,widget_enabled:!0,shortcode_enabled:!0,conditions:"",animation_in:"",animation_out:"",on_submit:"default"},initialize:function(e){if(_.extend(this,e),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}}));return{Base:e,Content:t,Design:i,Display_Settings:s}}),Hustle.define("Embedded.Settings_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-embedded-section-settings-tpl"),target_container:e("#wpmudev-hustle-box-section-settings"),init:function(e){if(this.conditions_view=e.conditions_view,this.target_container.length)return this.render()},render:function(e){return this.setElement(this.template(_.extend({},this.model.toJSON()))),this},after_render:function(){this.target_container.length&&this.$(".wph-conditions").replaceWith(this.conditions_view.$el)}}))}),Hustle.define("Embedded.View",function(e,t,i){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-embedded-wizard-view",preview:!1,preview_model:!1,events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(t){return this.content_view=t.content_view,this.design_view=t.design_view,this.settings_view=t.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.content_view.model,"change",this.content_view_changed),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.stopListening(this.settings_view.model,"change",this.settings_view_changed),e(document).off("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),e(document).off("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).off("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).off("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).off("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).off("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).off("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).off("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).off("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).off("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).off("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).off("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).off("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).off("keydown",e.proxy(this.escape_key,this)),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.content_view.model,"change",this.content_view_changed),this.listenTo(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.settings_view.model,"change",this.settings_view_changed),e(document).on("click","ul.wpmudev-cta-target-options li",e.proxy(this.toggle_cta_options,this)),e(document).on("click","ul.wpmudev-after-submit-options li",e.proxy(this.toggle_submit_options,this)),e(document).on("click","ul.wpmudev-feature-image-position-options li",e.proxy(this.toggle_feature_image_position_options,this)),e(document).on("click","ul.wpmudev-feature-image-fit-options li",e.proxy(this.toggle_feature_image_fit_options,this)),e(document).on("click","ul.wpmudev-feature-image-horizontal-options li",e.proxy(this.toggle_feature_image_horizontal_options,this)),e(document).on("click","ul.wpmudev-feature-image-vertical-options li",e.proxy(this.toggle_feature_image_vertical_options,this)),e(document).on("click","ul.wpmudev-form-fields-icon-options li",e.proxy(this.toggle_form_fields_icon_options,this)),e(document).on("click","ul.wpmudev-form-fields-proximity-options li",e.proxy(this.toggle_form_fields_proximity_options,this)),e(document).on("click","ul.wpmudev-display-triggers li",e.proxy(this.toggle_display_triggers,this)),e(document).on("click",".wpmudev-preview",e.proxy(this.open_preview,this)),e(document).on("click",".hustle-modal-close .hustle-icon",e.proxy(this.close_preview,this)),e(document).on("click",".wpmudev-modal-mask",e.proxy(this.close_preview,this)),e(document).on("click",".wph-reset-color-palette",e.proxy(this.reset_color_palette,this)),e(document).on("change keyup keypress","input[name=module_name]",e.proxy(this.validate_modal_name,this)),e(document).on("keydown",e.proxy(this.escape_key,this)),Hustle.Events.on("modules.view.preview.success",e.proxy(this.preview_success_message_delay,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render();var e=parseInt(this.content_view.model.get("use_email_collection"));this.use_email_collection_changed(e),e&&this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.target_container.html(""),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render(),this.settings_view.target_container.html(""),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},set_content_from_tinymce:function(e){if(e=e||!1,"undefined"!=typeof tinyMCE){var t=tinyMCE.get("main_content"),i=this.$("textarea#main_content"),s="true"===i.attr("aria-hidden")?t.getContent():i.val();this.content_view.model.set("main_content",s,{silent:e});var o=tinyMCE.get("success_message"),n=this.$("textarea#success_message"),a="true"===n.attr("aria-hidden")?o.getContent():n.val();this.content_view.model.set("success_message",a,{silent:e});var d=tinyMCE.get("gdpr_message"),l=this.$("textarea#gdpr_message"),r="true"===l.attr("aria-hidden")?d.getContent():l.val();this.content_view.model.set("gdpr_message",r,{silent:e})}},open_preview:function(e){e.preventDefault(),e.stopPropagation(),this.handle_preview()},handle_preview:function(){this.set_content_from_tinymce(!0),this.sanitize_data();var t=this.$("#wph-preview-modal .wpmudev-modal-mask").siblings(".hustle-modal");t.length&&t.remove();var i=this,s=i.content_view.model.get("main_content"),o=e(".wpmudev-preview").data("nonce");s.search(/\[/g)===-1?i.render_preview(i.content_view.model.toJSON()):e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_shortcode_render",content:s,_ajax_nonce:o},success:function(e){if(e&&e.data&&e.data.content){var t=_.extend(i.content_view.model.toJSON(),{main_content:e.data.content});i.render_preview(t)}},error:function(){}})},render_preview:function(t){var i=this,s=e(".wpmudev-preview").data("sitekey"),o=i.$("#wph-preview-modal"),n=this.content_view.model.get("use_email_collection"),a=_.isTrue(n)?Optin.template("wpmudev-hustle-modal-with-optin-tpl"):Optin.template("wpmudev-hustle-modal-without-optin-tpl"),d=_.extend(i.model.toJSON(),{content:t,design:i.design_view.model.toJSON(),settings:i.settings_view.model.toJSON()});d.unique_id="",o.append(a(d)),o.addClass("hui-module-type--popup"),"1"===t.use_email_collection&&"undefined"!=typeof t.form_elements.recaptcha&&s&&(o.find(".hustle-modal-body button").attr("disabled",!0),grecaptcha.ready(function(){grecaptcha.render("hustle-modal-recaptcha"+d.module_id,{sitekey:s,callback:function(){o.find(".hustle-modal-body button").removeAttr("disabled")}})})),i.apply_custom_css(),i.apply_preview_styles(),i.after_preview_render(),Hustle.Events.trigger("modules.view.rendered",i)},after_preview_render:function(){var t=this,i=this.$("#wph-preview-modal").addClass("wpmudev-modal-active"),s=i.find(".hustle-modal"),o=i.find(".hustle-modal-success"),n=this.settings_view.model.get("animation_in");e("body").addClass("wpmudev-modal-is_active"),o.css({height:i.find(".hustle-modal-body").height()+"px"}),s.hasClass("hustle-animated")?setTimeout(function(){s.addClass("hustle-animate-"+n),t.apply_custom_size()},100):this.apply_custom_size()},apply_preview_styles:function(){var t=this.content_view.model.toJSON(),i=this.design_view.model.toJSON(),s=i.style;if(_.isTrue(t.use_email_collection))return void this.apply_preview_optin_styles();var o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=o.find(".wpmudev-modal-mask"),d=n.find(".hustle-modal-body"),l=n.find(".hustle-modal-body section"),r=n.find(".hustle-modal-title"),c=n.find(".hustle-modal-subtitle"),u=n.find(".hustle-modal-image"),p=n.find("article, .hustle-modal-message"),m=n.find("article blockquote, .hustle-modal-message blockquote"),h=n.find("article a, .hustle-modal-message a"),v=n.find(".hustle-modal-cta"),g=n.find(".hustle-modal-close"),f=n.find(".hustle-modal-close svg path"),w=n.find(".hustle-gdpr-box .hustle-gdpr-content"),b=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox input"),y=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox span");if("cabriolet"===s?l.css("background-color",i.main_bg_color):d.css("background-color",i.main_bg_color),u.css("background-color",i.image_container_bg),r.css("color",i.title_color),c.css("color",i.subtitle_color),p.css("color",i.content_color),m.css("border-left-color",i.link_static_color),h.css("color",i.link_static_color),h.mouseover(function(){e(this).css("color",i.link_hover_color)}).mouseout(function(){e(this).css("color",i.link_static_color)}),v.css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color}),v.mouseover(function(){e(this).css({"background-color":i.cta_button_hover_bg,color:i.cta_button_hover_color})}).mouseout(function(){e(this).css({"background-color":i.cta_button_static_bg,color:i.cta_button_static_color})}),_.isTrue(t.show_gdpr)){if(w.css("color",i.gdpr_content),_.isTrue(i.gdpr_border)){var x=i.gdpr_border_weight+"px "+i.gdpr_border_type+" "+i.gdpr_border_color;y.css({border:x,"border-radius":i.gdpr_border_radius+"px"})}y.css({"background-color":i.gdpr_chechbox_background_static,color:i.gdpr_checkbox_icon}),b.click(function(){y.toggleClass("gdpr-is-active",function(){y.hasClass("gdpr-is-active")?y.css({"background-color":i.gdpr_checkbox_background_active}):y.css({"background-color":i.gdpr_chechbox_background_static})})})}f.css("fill",i.close_button_static_color),g.mouseover(function(){f.css("fill",i.close_button_hover_color)}).mouseout(function(){f.css("fill",i.close_button_static_color)}),a.css("background-color",i.overlay_bg);var C=o.find(".hustle-modal-image img"),k="",$="";if("contain"!==i.feature_image_fit&&"cover"!==i.feature_image_fit||(k="custom"===i.feature_image_horizontal?i.feature_image_horizontal_px+"px":i.feature_image_horizontal,$="custom"===i.feature_image_vertical?i.feature_image_vertical_px+"px":i.feature_image_vertical,C.css({"background-position":k+" "+$,"object-position":k+" "+$})),_.isTrue(i.border)){var S=i.border_weight+"px "+i.border_type+" "+i.border_color;"cabriolet"===s?n.find("section").css({border:S,"border-radius":i.border_radius+"px"}):d.css({border:S,"border-radius":i.border_radius+"px"})}if(_.isTrue(i.drop_shadow)){var O=i.drop_shadow_x+"px "+i.drop_shadow_y+"px "+i.drop_shadow_blur+"px "+i.drop_shadow_spread+"px "+i.drop_shadow_color;"cabriolet"===s?n.find("section").css({"box-shadow":O}):d.css({"box-shadow":O})}},apply_preview_optin_styles:function(){var t=this.content_view.model.toJSON(),i=this.design_view.model.toJSON(),s=i.form_layout,o=this.$("#wph-preview-modal"),n=o.find(".hustle-modal"),a=n.find(".hustle-modal-body"),d=n.find(".hustle-modal-success"),l=n.find(".hustle-modal-title"),r=n.find(".hustle-modal-subtitle"),c=n.find("article"),u=n.find("article blockquote"),p=n.find("article a:not(.hustle-modal-cta)"),m=n.find(".hustle-modal-optin_field"),h=m.find("input"),v=m.find("label .hustle-modal-optin_icon .hustle-icon path"),g=m.find("label .hustle-modal-optin_placeholder"),f=n.find(".hustle-modal-optin_button button"),w=n.find(".hustle-modal-mc_checkbox input+label, .hustle-modal-mc_checkbox input:checked+label"),b=n.find(".hustle-modal-mc_radio input+label, .hustle-modal-mc_radio input:checked+label"),y=n.find(".hustle-modal-close"),x=n.find(".hustle-modal-close svg path"),C=n.find(".hustle-gdpr-box .hustle-gdpr-content"),k=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox input"),$=n.find(".hustle-gdpr-box .hustle-gdpr-checkbox span");if(a.css("background-color",i.main_bg_color),d.css("background-color",i.main_bg_color),a.find(".hustle-modal-image").css("background-color",i.image_container_bg),"one"===s||"two"===s?n.find("footer").css("background-color",i.form_area_bg):n.find(".hustle-modal-optin_wrap").css("background-color",i.form_area_bg),l.css("color",i.title_color),r.css("color",i.subtitle_color),c.css("color",i.content_color),u.css("border-left-color",i.link_static_color),p.css("color",i.link_static_color),p.mouseover(function(){e(this).css("color",i.link_hover_color)}).mouseout(function(){e(this).css("color",i.link_static_color)}),c.find(".hustle-modal-cta").css({background:i.cta_button_static_bg,color:i.cta_button_static_color}),c.find(".hustle-modal-cta").mouseover(function(){e(this).css({background:i.cta_button_hover_bg,color:i.cta_button_hover_color})}).mouseout(function(){e(this).css({background:i.cta_button_static_bg,color:i.cta_button_static_color})}),_.isTrue(t.show_gdpr)){if(C.css("color",i.gdpr_content),_.isTrue(i.gdpr_border)){var S=i.gdpr_border_weight+"px "+i.gdpr_border_type+" "+i.gdpr_border_color;$.css({border:S,"border-radius":i.gdpr_border_radius+"px"})}$.css({"background-color":i.gdpr_chechbox_background_static,color:i.gdpr_checkbox_icon}),k.click(function(){$.toggleClass("gdpr-is-active",function(){$.hasClass("gdpr-is-active")?$.css({"background-color":i.gdpr_checkbox_background_active}):$.css({"background-color":i.gdpr_chechbox_background_static})})})}h.css("color",i.optin_form_field_text_static_color),h.css("background-color",i.optin_input_static_bg),m.mouseover(function(){e(this).find("input").css("color",i.optin_form_field_text_hover_color),e(this).find("input").css("background-color",i.optin_input_hover_bg)}).mouseout(function(){e(this).find("input").css("color",i.optin_form_field_text_static_color),e(this).find("input").css("background-color",i.optin_input_static_bg)}),v.css("fill",i.optin_input_icon),f.css("color",i.optin_submit_button_static_color),f.css("background-color",i.optin_submit_button_static_bg),f.mouseover(function(){e(this).css("color",i.optin_submit_button_hover_color),e(this).css("background-color",i.optin_submit_button_hover_bg)}).mouseout(function(){e(this).css("color",i.optin_submit_button_static_color),e(this).css("background-color",i.optin_submit_button_static_bg)}),g.css("color",i.optin_placeholder_color),w.css("background-color",i.optin_check_radio_static_bg),b.css("background-color",i.optin_check_radio_static_bg);var O=e("#hustle-module-checkbox-radio-custom-styles"),z=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input+label:before",H=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_checkbox input:checked+label:before",M=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input+label:before",T=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_radio input:checked+label:before",j=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_title label",E=".hustle-modal .hustle-modal-optin_form .hustle-modal-mc_groups .hustle-modal-mc_option .hustle-modal-mc_label label",D=".wpmudev-ui .wpmudev-modal .wpmudev-modal-mask",P=z+" { color: "+i.optin_check_radio_static_bg+"; }"+H+" { color: "+i.optin_check_radio_tick_color+"; }"+M+" { color: "+i.optin_check_radio_static_bg+"; }"+T+" { color: "+i.optin_check_radio_tick_color+"; }"+j+" { color: "+i.optin_mailchimp_title_color+"; }"+E+" { color: "+i.optin_mailchimp_labels_color+"; }"+D+" { background-color: "+i.overlay_bg+"; }";O.length&&O.remove(),e('<style id="hustle-module-mailchimp-custom-styles">'+P+"</style>").appendTo("body"),x.css("fill",i.close_button_static_color),y.mouseover(function(){x.css("fill",i.close_button_hover_color)}).mouseout(function(){x.css("fill",i.close_button_static_color)});var N=o.find(".hustle-modal-image img"),V="",J="";if("contain"!==i.feature_image_fit&&"cover"!==i.feature_image_fit||(V="custom"===i.feature_image_horizontal?i.feature_image_horizontal_px+"px":i.feature_image_horizontal,J="custom"===i.feature_image_vertical?i.feature_image_vertical_px+"px":i.feature_image_vertical,N.css({"background-position":V+" "+J,"object-position":V+" "+J})),_.isTrue(i.border)){var B=i.border_weight+"px "+i.border_type+" "+i.border_color;a.css({border:B,"border-radius":i.border_radius+"px"})}if(_.isTrue(i.drop_shadow)){var I=i.drop_shadow_x+"px "+i.drop_shadow_y+"px "+i.drop_shadow_blur+"px "+i.drop_shadow_spread+"px "+i.drop_shadow_color;a.css({"box-shadow":I})}if(_.isTrue(i.form_fields_border)){var F=i.form_fields_border_weight+"px "+i.form_fields_border_type+" "+i.form_fields_border_color;h.css({border:F,"border-radius":i.form_fields_border_radius+"px"})}if(_.isTrue(i.button_border)){var U=i.button_border_weight+"px "+i.button_border_type+" "+i.button_border_color;f.css({border:U,"border-radius":i.button_border_radius+"px"})}},apply_custom_size:function(){var e=(this.content_view.model.toJSON(),this.design_view.model.toJSON()),t=(e.style,e.form_layout,this.$("#wph-preview-modal")),i=t.find(".hustle-modal");i.find(".hustle-modal-body");_.isTrue(e.customize_size)&&i.css({width:e.custom_width+"px","max-width":"unset",height:e.custom_height+"px","max-height":"unset"})},apply_custom_css:function(){var t=e("#hustle-module-custom-styles");t.remove();var i=this.design_view.model.toJSON().customize_css;if(1===i||"1"===i){var s=this.design_view.model.get("custom_css"),o=e("#hustle_custom_css").data("nonce"),n=e(".wpmudev-preview").data("customCssNonce");if(_.isEmpty(s)||"undefined"==typeof o){if("undefined"===n)return;o=n}e.ajax({type:"POST",url:ajaxurl,dataType:"json",data:{action:"hustle_embedded_prepare_custom_css",css:s,_ajax_nonce:o},success:function(t){if(t&&t.success){var i=e("#hustle-module-custom-styles");i.length&&i.remove(),e('<style id="hustle-module-custom-styles">'+t.data+"</style>").appendTo("body")}},error:function(){}})}},close_preview:function(t){t.stopPropagation();var i=this.$("#wph-preview-modal"),s=i.find(".hustle-modal"),o=this.settings_view.model.get("animation_in"),n="hustle-animate-"+o,a=this.settings_view.model.get("animation_out"),d="hustle-animate-"+a,l=1e3;s.removeClass(n).addClass(d),s.hasClass("hustle-animated")&&("fadeOut"===a&&(l=305),"newspaperOut"===a&&(l=505),"bounceOut"===a&&(l=755),setTimeout(function(){i.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"),s.removeClass(d)},l)),s.hasClass("hustle-modal-static")&&(s.removeClass("hustle-modal-static"),i.removeClass("wpmudev-modal-active"),e("body").removeClass("wpmudev-modal-is_active"))},sanitize_data:function(){var e=this.content_view.model.get("cta_url");/^(f|ht)tps?:\/\//i.test(e)||(e="http://"+e,this.content_view.model.set("cta_url",e,{silent:!0})),this.design_view.update_custom_css()},provider_add_custom_fields:function(t,i,s,o){var n=o.content_view.model.get("active_email_service");if(Module.Utils.service_supports_fields(0,n)===!0&&("form_elements"in s||"email_services"in s||"active_email_service"in s)&&"object"==typeof o.content_view.model.get("form_elements")){var a=JSON.stringify(o.content_view.model.get("form_elements")),d=t,l={action:"add_module_fields",_ajax_nonce:i,data:a,provider:n,module_id:d};e.post(ajaxurl,l,function(e){}).fail(function(e){console.log("There was an error saving the custom fields.")})}},save:function(t){if(!Module.Validate.validate_module_name())return!1;var i=this.content_view.model.changed;this.set_content_from_tinymce(!0),this.sanitize_data();var s=this,o=t.data("id")?t.data("id"):"-1",n=t.data("nonce"),a=this.model.toJSON(),d=this.content_view.model.toJSON(),l=this.design_view.model.toJSON(),r=this.settings_view.model.toJSON();return e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_embedded_module",_ajax_nonce:n,id:o,module:a,content:d,design:l,settings:r,shortcode_id:s._get_shortcode_id()},complete:function(e){s.provider_add_custom_fields(o,n,i,s);e.responseJSON}})},show_error:function(t){return e("<label><span>"+t.data+"</span></label>").prop({"class":"wpmudev-label--notice",id:"wpmudev-hustle-error-message"}).insertAfter(e(".wpmudev-box-footer")),
e("#wpmudev-hustle-error-message").delay(5e3).fadeOut("slow",function(){e(this).remove()}),this},remove_loading_icon:function(e){return e.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").removeClass("wpmudev-button-onload").prop("disabled",!1),this},save_changes:function(t){t.preventDefault();var i=this,s=e(t.currentTarget);i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").addClass("wpmudev-button-onload").prop("disabled",!0);var o=this.save(s),n=this;o?o.done(function(t){if("string"==typeof t&&(t=JSON.parse(t)),t.success){var o=window.location.pathname+window.location.search;o.indexOf("&id=")===-1&&(o=o+"&id="+t.data,window.history.replaceState({},"",o),i.$(".wpmudev-menu-content-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){e(this).attr("href",e(this).data("link")+"&id="+t.data)})),s.data("id",t.data),s.siblings().data("id",t.data),Module.hasChanges=!1;var a=optin_vars.current.section||!1;if("settings"===a){var d=t.data;if(s.hasClass("wpmudev-button-finish"))return window.location.replace("?page="+optin_vars.current.listing_page+"&module="+d)}}else n.show_error(t)}).always(function(){n.remove_loading_icon(i)}):this.remove_loading_icon(i)},save_continue:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.currentTarget)),o=this;s?s.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,s=optin_vars.current.section||!1,n="";return window.onbeforeunload=null,s&&"content"!==s?"design"===s&&(n=i.$(".wpmudev-menu-settings-link a").data("link")):n=i.$(".wpmudev-menu-design-link a").data("link"),n.indexOf("&id")===-1&&(n+="&id="+t),window.location.replace(n)}o.show_error(e).remove_loading_icon(i)}):this.remove_loading_icon(i)},save_finish:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue, .wpmudev-button-finish").addClass("wpmudev-button-onload").prop("disabled",!0),this.model.set("active",1,{silent:!0});var s=this.save(e(t.currentTarget)),o=this;s?s.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}o.show_error(e).remove_loading_icon(i)}):this.remove_loading_icon(i)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();var t=this;t.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var i=optin_vars.current.section;window.onbeforeunload=null,"design"===i?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"settings"===i&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"content"===t?window.location.replace(this.$(".wpmudev-menu-content-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},content_view_changed:function(e){var t=e.changed,i=Object.keys(t);if("has_title"in t){var s=this.$("#wph-wizard-content-title-textboxes");s.length&&(t.has_title?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_feature_image"in t){var s=this.$("#wph-wizard-content-image-options");s.length&&(t.use_feature_image?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_cta"in t){var s=this.$("#wph-wizard-content-cta-options");s.length&&(t.show_cta?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("show_gdpr"in t){var s=this.$("#wph-wizard-content-gdpr-message");s.length&&(t.show_gdpr?s.removeClass("wpmudev-hidden"):s.hasClass("wpmudev-hidden")||s.addClass("wpmudev-hidden"))}if("use_email_collection"in t&&this.use_email_collection_changed(t.use_email_collection),"after_successful_submission"in t&&this.after_successful_submission_changed(t.after_successful_submission),"auto_close_success_message"in t){var s=this.$("#wph-wizard-content-form_success_options");s.length&&(t.auto_close_success_message?(s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.addClass("wpmudev-hidden"),s.removeClass("wpmudev-show")))}if("save_local_list"in t){var s=this.$("#wph-wizard-content-local_list_name");s.length&&(t.save_local_list?(s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.addClass("wpmudev-hidden"),s.removeClass("wpmudev-show")))}if(i[0].indexOf("_service_provider")!==-1){var o=i[0].replace("_service_provider","");this.handle_email_service(o,t[o+"_service_provider"])}},design_view_changed:function(e){var t=e.changed;if("form_layout"in t){var i=this.$(".wpmudev-box-layouts"),s=i.find(".wpmudev-box-layout_"+t.form_layout);i.length&&s.length&&(s.siblings().removeClass("active"),s.hasClass("active")||s.addClass("active"),this.design_view.hide_unwanted_options())}if("style"in t&&this.update_color_palette(t.style),"customize_colors"in t){var o=this.$("#wph-modal-styles-palette"),n=this.$("#wph-modal-palette");o.length&&(t.customize_colors?(o.removeClass("wpmudev-hidden"),o.addClass("wpmudev-show")):(o.addClass("wpmudev-hidden"),o.removeClass("wpmudev-show"))),n.length&&(t.customize_colors?(n.removeClass("wpmudev-hidden"),n.addClass("wpmudev-show")):(n.addClass("wpmudev-hidden"),n.removeClass("wpmudev-show")))}if("feature_image_fit"in t){var s=this.$("#wph-wizard-content-image_fit_horizontal_vertical_options");s.length&&("contain"===t.feature_image_fit||"cover"===t.feature_image_fit?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_horizontal"in t){var s=this.$("#wph-wizard-design-horizontal-position");s.length&&("custom"===t.feature_image_horizontal?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("feature_image_vertical"in t){var s=this.$("#wph-wizard-design-vertical-position");s.length&&("custom"===t.feature_image_vertical?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("border"in t){var s=this.$("#wph-wizard-design-border-options");s.length&&(t.border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("form_fields_border"in t){var s=this.$("#wph-wizard-design-form-fields-border-options");s.length&&(t.form_fields_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("button_border"in t){var s=this.$("#wph-wizard-design-button-border-options");s.length&&(t.button_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("gdpr_border"in t){var s=this.$("#wph-wizard-design-gdpr-border-options");s.length&&(t.gdpr_border?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("drop_shadow"in t){var s=this.$("#wph-wizard-design-shadow-options");s.length&&(t.drop_shadow?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_size"in t){var s=this.$("#wph-wizard-design-size-options");s.length&&(t.customize_size?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}if("customize_css"in t){var s=this.$("#wph-wizard-design-css_holder");s.length&&(t.customize_css?(s.hasClass("wpmudev-show")||s.addClass("wpmudev-show"),s.removeClass("wpmudev-hidden")):(s.removeClass("wpmudev-show"),s.addClass("wpmudev-hidden")))}},settings_view_changed:function(e){var t=e.changed;if("on_time"in t){var i=this.$("#wpmudev-display-trigger-time-options");i.length&&(t.on_time?(i.addClass("wpmudev-show"),i.removeClass("wpmudev-hidden")):(i.removeClass("wpmudev-show"),i.addClass("wpmudev-hidden"))),this.settings_view.model.set("triggers.on_time",t.on_time,{silent:!0})}"on_time_delay"in t&&this.settings_view.model.set("triggers.on_time_delay",t.on_time_delay,{silent:!0}),"on_time_unit"in t&&this.settings_view.model.set("triggers.on_time_unit",t.on_time_unit,{silent:!0}),"on_exit_intent"in t&&this.settings_view.model.set("triggers.on_exit_intent",t.on_exit_intent,{silent:!0}),"on_exit_intent_per_session"in t&&this.settings_view.model.set("triggers.on_exit_intent_per_session",t.on_exit_intent_per_session,{silent:!0}),"on_adblock"in t&&this.settings_view.model.set("triggers.on_adblock",t.on_adblock,{silent:!0})},display_triggers_changed:function(e){var t=e.changed;if("trigger"in t){var i=this.$("#wpmudev-display-trigger-"+t.trigger);i.length&&(i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"))}},update_color_palette:function(e){var t=this,i=parseInt(this.content_view.model.get("use_email_collection"));if(i){var s=this.$('option[value="'+e+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];this.design_view.model.set("customize_colors",0),this.$('input[data-attribute="customize_colors"]').removeAttr("checked"),_.each(n,function(e,i){t.$('input[data-attribute="'+i+'"]').val(e).trigger("change")})}}},reset_color_palette:function(){var e=this,t=this.$("#wph-wizard-design-palette .select2-selection__rendered").attr("title").toLowerCase().replace(/\s/g,"_"),i=parseInt(this.content_view.model.get("use_email_collection"),10);if(i){var s=this.$('option[value="'+t+'"]'),o=s.text();if("undefined"!=typeof optin_vars.palettes[o]){var n=optin_vars.palettes[o];_.each(n,function(t,i){e.$('input[data-attribute="'+i+'"]').val(t).trigger("change")})}}},use_email_collection_changed:function(e){var t=this.$("#wph-wizard-content-email"),i=this.$("#wph-wizard-content-email-options"),s=this.$("#wph-wizard-content-form_elements"),o=this.$("#wph-wizard-content-gdpr"),n=this.$("#wph-wizard-content-gdpr-message"),a=this.$("#wph-wizard-content-form_submission"),d=this.$("#wph-wizard-content-form_message"),l=this.$("#wph-wizard-content-form_success"),r=this.$("#wph-wizard-content-recaptcha");parseInt(e)?(t.removeClass("last"),i.removeClass("wpmudev-hidden_table"),i.addClass("wpmudev-show_table"),s.show(),o.show(),n.show(),a.show(),r.show(),this.after_successful_submission_changed(this.content_view.model.get("after_successful_submission")),this.design_view.model.set("style","gray_slate")):(t.hasClass("last")||t.addClass("last"),i.removeClass("wpmudev-show_table"),i.addClass("wpmudev-hidden_table"),s.hide(),o.hide(),n.hide(),a.hide(),d.hide(),l.hide(),r.hide(),this.design_view.model.set("style","cabriolet"))},after_successful_submission_changed:function(e){var t=this.$("#wph-wizard-content-form_submission_redirect_url"),i=this.$("#wph-wizard-content-form_message"),s=this.$("#wph-wizard-content-form_success");"redirect"===e?(t.length&&t.removeClass("wpmudev-hidden"),i.length&&s.length&&(i.hide(),s.hide())):(t.length&&!t.hasClass("wpmudev-hidden")&&t.addClass("wpmudev-hidden"),i.length&&s.length&&(i.show(),s.show()))},toggle_cta_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("cta_target",s.val(),{silent:!0})},toggle_submit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.content_view.model.set("after_successful_submission",s.val())},toggle_feature_image_position_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_position",s.val(),{silent:!0})},toggle_feature_image_fit_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_fit",s.val(),{silent:!1})},toggle_feature_image_horizontal_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_horizontal",s.val(),{silent:!1})},toggle_feature_image_vertical_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("feature_image_vertical",s.val(),{silent:!1})},toggle_form_fields_icon_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_icon",s.val(),{silent:!1})},toggle_form_fields_proximity_options:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.design_view.model.set("form_fields_proximity",s.val(),{silent:!1})},toggle_display_triggers:function(t){var i=e(t.target).closest("li"),s=i.find("input");i.hasClass("current")||i.addClass("current"),i.siblings().removeClass("current"),this.settings_view.model.set("triggers.trigger",s.val(),{silent:!0}),this.display_triggers_changed(this.settings_view.model.get("triggers"))},handle_email_service:function(t,i){var s=this.content_view.model.get("email_services");_.isEmpty(s)&&(s={}),i?(this.content_view.model.set("active_email_service",t),_.isEmpty(s)?s[t]={enabled:i}:_.each(s,function(i,o){o===t?s[o]=_.extend(s[o],{enabled:1}):(s[o]=_.extend(s[o],{enabled:0}),e('input[data-attribute="'+o+'_service_provider"]').removeAttr("checked"))})):(this.content_view.model.set("active_email_service",""),s[t]=_.extend(s[t],{enabled:i})),this.content_view.model.set("email_services",s)},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")},escape_key:function(e){27===e.keyCode&&this.close_preview(e)},preview_success_message_delay:function(e){var t=this.content_view.model,i=t.get("auto_close_success_message"),s=this.content_view.model.get("auto_close_time"),o=this.content_view.model.get("auto_close_unit"),n=e.$("#wph-preview-modal").addClass("wpmudev-modal-active");if(_.isTrue(i)){var a=parseInt(s),d=o;"minutes"===d&&(a*=60),a*=1e3,_.delay(function(){var e=n.find(".hustle-modal"),t=e.find(".hustle-modal-close .hustle-icon");t.length>0?t.trigger("click"):$success_msg.removeAttr("style")},a)}}})}),Hustle.define("SShare.Content_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-sshare-section-services-tpl"),target_container:e("#wpmudev-hustle-box-section-services"),init:function(e){return this.stopListening(this.model,"change",this.model_updated),this.listenTo(this.model,"change",this.model_updated),this.render()},events:{"click ul.wpmudev-tabs-menu li label":"toggle_checkbox","change .wpmudev-social-item input.wpmudev-social-item-native-enable":"toggle_icon","change .wpmudev-social-custom .wpmudev-social-item input.toggle-checkbox":"toggle_icon"},render:function(e){if(this.target_container.length){var t=this.model.toJSON();return this.setElement(this.template(_.extend({module_type:"social_sharing"},t))),this}},after_render:function(){this.target_container.length},model_updated:function(e){var t=e.changed;"service_type"in t&&this.service_type_updated(t.service_type),"click_counter"in t&&this.click_counter_updated(t.click_counter)},service_type_updated:function(t){var i=this.$("#wpmudev-sshare-counter-options"),s=e(".wph-wizard-services-icons-native"),o=e(".wph-wizard-services-icons-custom");"native"===t?(i.removeClass("wpmudev-hidden"),o.addClass("wpmudev-hidden"),s.removeClass("wpmudev-hidden")):(i.addClass("wpmudev-hidden"),s.addClass("wpmudev-hidden"),o.removeClass("wpmudev-hidden"))},click_counter_updated:function(t){var i=e("#wpmudev-sshare-counter-options .hustle-twitter-notice");"native"===t?i.removeClass("wpmudev-hidden"):i.hasClass("wpmudev-hidden")||i.addClass("wpmudev-hidden"),e("#wph-wizard-services-icons-native .wpmudev-social-item").each(function(){var i=e(this).find(".toggle-checkbox"),s=i.is(":checked"),o=e(this).find("input.wpmudev-input_number");"none"!==t&&s?o.removeClass("wpmudev-hidden"):o.hasClass("wpmudev-hidden")||o.addClass("wpmudev-hidden")}),e("#wph-wizard-services-icons-native #wpmudev-counter-title>strong").removeClass("wpmudev-hidden"),"none"===t?e("#wph-wizard-services-icons-native #wpmudev-counter-title>strong:first-child").addClass("wpmudev-hidden"):e("#wph-wizard-services-icons-native #wpmudev-counter-title>strong:nth-child(2)").addClass("wpmudev-hidden")},toggle_checkbox:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.closest("li"),s=i.find("input"),o=s.data("attribute");i.hasClass("current")||(i.addClass("current"),i.siblings().removeClass("current"),this.model.set(o,s.val()))},toggle_icon:function(e){var t=this.$(e.target),i=t.is(":checked"),s="none"!==this.model.get("click_counter"),o=t.closest(".wpmudev-social-item"),n=o.find("input.wpmudev-input_number"),a=!(!i||!s);i?o.removeClass("disabled"):o.addClass("disabled"),t.parents(".wpmudev-social-native").length>0&&(a?n.removeClass("wpmudev-hidden"):n.addClass("wpmudev-hidden"))},set_social_icons:function(){var e=this.model.toJSON();e=this.get_social_icons_data(e),this.model.set("social_icons",e.social_icons,{silent:!0})},get_social_icons_data:function(t){var i=e("#wph-wizard-services-icons-"+t.service_type+" .wpmudev-social-item"),s={};return i.each(function(){var t=e(this),i=t.find("input.toggle-checkbox"),o=i.data("id"),n=t.find("input.wpmudev-input_number"),a=t.find("input.wpmudev-input_text");if(n.length){var d=parseInt(n.val());d<0&&n.val(0)}i.is(":checked")&&(s[o]={enabled:!0,counter:n.length?n.val():"0",link:a.length?a.val():""})}),i.length&&(t.social_icons=s),t}}))}),Hustle.define("SShare.Design_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Optin.template("wpmudev-hustle-sshare-section-design-tpl"),target_container:e("#wpmudev-hustle-box-section-design"),social_icons:{},service_type:"native",click_counter:"click",excluded_rerender:["floating_social_bg","floating_counter_color","floating_counter_border","icon_bg_color","icon_color","drop_shadow_x","drop_shadow_y","drop_shadow_blur","drop_shadow_spread","drop_shadow_color","widget_icon_bg_color","widget_icon_color","widget_bg_color","widget_drop_shadow_x","widget_drop_shadow_y","widget_drop_shadow_blur","widget_drop_shadow_spread","widget_drop_shadow_color","widget_counter_border","widget_counter_color"],init:function(e){return this.on("rendered",this.create_color_pickers),this.social_icons=e.social_icons,this.service_type=e.service_type,this.click_counter=e.click_counter,this.render_design()},render_design:function(e){if(this.target_container.length){var t=this,i=this.model.toJSON();return this._handle_icons_order(),this.setElement(this.template(_.extend({module_type:"social_sharing",social_icons:t.social_icons,service_type:t.service_type,click_counter:t.click_counter},i))),this}},after_render:function(){this.target_container.length&&(this.create_color_pickers(),this.make_icons_sortable(),this._handle_preview())},create_color_pickers:function(){this.$(".wpmudev-color_picker").wpColorPicker({change:function(t,i){var s=e(this);s.val(i.color.toCSS()).trigger("change")}})},make_icons_sortable:function(){var e=this,t={items:".hustle-social-icon",revert:!0,axis:"x",containment:this.$("#wpmudev-reoder-icons"),stop:function(t,i){e._reorder_icons()}};this.$("#wph-reorder-icons").sortable(t).disableSelection()},model_updated:function(e){this._handle_preview()},_handle_preview:function(){var t=e("#wph-sshare-preview-floating .hustle-shares-floating"),i=t.find(".hustle-shares-counter"),s=t.find(".hustle-icon-container"),o=t.find(".hustle-icon-path"),n=t.find(".hustle-social-icon"),a=e("#wph-sshare-preview-widget .hustle-shares-widget"),d=a.find(".hustle-shares-counter"),l=a.find(".hustle-icon-container"),r=a.find(".hustle-icon-path"),c=a.find(".hustle-social-icon"),u=this.model.toJSON();if(t.css("background-color",u.floating_social_bg),i.css("color",u.floating_counter_color),_.isTrue(u.customize_colors)&&("rounded"===u.icon_style||"squared"===u.icon_style?(s.css("background-color",u.icon_bg_color),n.css("border-color",u.icon_bg_color)):"outline"===u.icon_style&&n.css("border-color",u.icon_bg_color),o.css("fill",u.icon_color)),_.isTrue(u.drop_shadow)){var p=""+u.drop_shadow_x+"px "+u.drop_shadow_y+"px "+u.drop_shadow_blur+"px "+u.drop_shadow_spread+"px "+u.drop_shadow_color;t.css("box-shadow",p)}if(a.css("background-color",u.widget_bg_color),d.css("color",u.widget_counter_color),_.isTrue(u.customize_widget_colors)&&("rounded"===u.icon_style||"squared"===u.icon_style?(l.css("background-color",u.widget_icon_bg_color),c.css("border-color",u.widget_icon_bg_color)):"outline"===u.icon_style&&c.css("border-color",u.widget_icon_bg_color),r.css("fill",u.widget_icon_color)),_.isTrue(u.widget_drop_shadow)){var m=""+u.widget_drop_shadow_x+"px "+u.widget_drop_shadow_y+"px "+u.widget_drop_shadow_blur+"px "+u.widget_drop_shadow_spread+"px "+u.widget_drop_shadow_color;a.css("box-shadow",m)}},_handle_icons_order:function(){var e={},t=this.social_icons,i=this.model.get("icons_order"),s=i.split(",");i&&s.length&&(_.each(s,function(i,s){"undefined"!=typeof t[i]&&(e[i]=t[i],t=_.pick(t,function(e,t){if(i!==t)return t=e}))}),Object.keys(t).length&&(e=_.extend(e,_.pick(t,function(e,t){if("undefined"!=typeof e)return t=e}))),this.social_icons=e)},_reorder_icons:function(){var t=[];e("#wph-reorder-icons .hustle-social-icon").each(function(){t.push(e(this).data("id"))}),this.model.set("icons_order",t.join())}}))}),Hustle.define("SShare.Listing",function(e,t,i){"use strict";var s=Hustle.get("Delete_Confirmation"),o=Hustle.get("Upgrade_Modal");return Backbone.View.extend({el:"#wpmudev-hustle",events:{"click .wpmudev-row .wpmudev-box-head":"toggle_module_accordion","click #hustle-free-version-create":"show_upgrade_modal","click .wpmudev-row .wpmudev-box-head .wpmudev-box-action":"module_toggle_clicked","click .social-sharing-edit":"edit","click .hustle-delete-module":"delete_module","change .social-sharing-toggle-activity":"toggle_module_activity","change .social-sharing-toggle-tracking-activity":"toggle_tracking_activity","change [name='wph-module-status']":"module_status_updated","click .module-duplicate":"duplicate","click .import-module-settings":"import_settings","change #wph-optin-service-import-form input[type=file]":"toggle_notice"},delete_confirmations:{},initialize:function(){this.delete_confirmation=new s({action:"hustle_delete_module",onSuccess:function(e){e.success&&location.reload()}});var t=this,i=e("#wpmudev-hustle-content .wpmudev-row"),n=i.length,a=n;i.each(function(){e(this).css("z-index",a),a--;var i=e(this).find(".wpmudev-dots-dropdown"),s=i.find(".wpmudev-dots-button"),o=i.find(".wpmudev-dots-nav");s.on("click",function(){e(this).toggleClass("wpmudev-active"),o.toggleClass("wpmudev-hide"),t.$(".wpmudev-dots-nav").not(o).each(function(){e(this).hasClass("wpmudev-hide")||e(this).toggleClass("wpmudev-hide")})})}),this.upgrade_modal=new o,Module.Utils.get_url_param("requires_pro")&&this.show_upgrade_modal()},module_toggle_clicked:function(t){t.stopPropagation(),e(t.target).closest(".wpmudev-box-head").click()},toggle_module_accordion:function(t){if(_.indexOf(["wpmudev-box-head","wpmudev-box-action","wpmudev-box-group","wpmudev-box-group--inner","wpmudev-group-title","wpmudev-helper"],t.target.className)!==-1){var i=e(t.target),s=i.parents(".wpmudev-row").find(".wpmudev-box-action"),o=i.parents(".wpmudev-row").find(".wpmudev-box-body");o.slideToggle("fast",function(){s.toggleClass("wpmudev-action-show"),o.toggleClass("wpmudev-hidden")})}},toggle_module_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.is(":checked"),a=i.parents(".wpmudev-row");i.prop("disabled",!0),n?(a.find(".wpmudev-box-body .wpmudev-box-disabled").removeClass("wpmudev-box-disabled").addClass("wpmudev-box-enabled"),a.find("input").prop("disabled",!1)):(a.find(".wpmudev-box-body .wpmudev-box-enabled").removeClass("wpmudev-box-enabled").addClass("wpmudev-box-disabled"),a.find("input").prop("disabled",!0)),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_sshare_module_toggle_state",id:s,_ajax_nonce:o},complete:function(){i.prop("disabled",!1)},success:function(e){e.success||i.attr("checked",!n)},error:function(){i.attr("checked",!n)}})},toggle_tracking_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_sshare_toggle_tracking_activity",id:s,type:n,_ajax_nonce:o},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},toggle_type_activity:function(t){t.stopPropagation();var i=e(t.target),s=i.data("id"),o=i.data("nonce"),n=i.data("type"),a=i.is(":checked");i.attr("disabled",!0),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_social_sharing_toggle_type_activity",id:s,type:n,_ajax_nonce:o},complete:function(){i.attr("disabled",!1)},success:function(e){e.success||i.attr("checked",!a)},error:function(e){e.success||i.attr("checked",!a)}})},edit:function(e){e.stopPropagation()},delete_module:function(t){var i=e(t.target).closest("a.hustle-delete-module"),s=i.data("id"),o=i.data("nonce");this.delete_confirmation&&(this.delete_confirmation.opts.id=s,this.delete_confirmation.opts.nonce=o,this.delete_confirmation.$el.addClass("wpmudev-modal-active"))},toggle_notice:function(t){e(t.target).val()?e("#select_file_error").addClass("wpmudev-hidden"):e("#select_file_error").removeClass("wpmudev-hidden")},import_settings:function(e){e.preventDefault(),e.stopPropagation();var t=this.$(e.target),i=t.data("id"),s=t.data("type"),o=t.data("name"),n=t.data("nonce"),a=Hustle.get("Modal_Import");this.importShown&&this.importShown.remove(),this.importShown=new a({model:{id:i,name:o,nonce:n,type:s}})},show_upgrade_modal:function(e){"undefined"!=typeof e&&e.preventDefault(),this.upgrade_modal&&this.upgrade_modal.$el.addClass("wpmudev-modal-active")},module_status_updated:function(t){var i=this.$(t.target),s=i.val(),o=i.data(),n=i.closest("li.wpmudev-tabs-menu_item");n.addClass("current"),n.siblings().removeClass("current"),o._ajax_nonce=o.nonce,"test"===s?o.action="hustle_sshare_toggle_test_activity":(o.action="hustle_sshare_module_toggle_type_state","off"===s?o.enabled="false":o.enabled="true"),e.post(ajaxurl,o,function(e){})},duplicate:function(t){var i=this,s=e(t.target),o=s.data("id"),n=s.data("nonce"),a=s.data("type");e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_social_share_duplicate",id:o,type:a,_ajax_nonce:n},success:function(e){e.success?location.reload():e.data.requires_pro&&i.show_upgrade_modal()},error:function(){location.reload()}})}})}),Hustle.define("SShare.Models",function(){"use strict";var e=Module.Model.extend({defaults:_.extend(Module.Model.prototype.defaults,{module_type:"social_sharing"})}),t=Hustle.get("Models.M").extend({defaults:{module_name:"",active:0,test_mode:0,service_type:"native",click_counter:"click",social_icons:""}}),i=Hustle.get("Models.M").extend({defaults:{icon_style:"squared",icons_order:"",customize_colors:0,icon_bg_color:"rgba(146, 158, 170, 1)",icon_color:"rgba(255, 255, 255, 1)",floating_social_bg:"rgba(4, 48, 69, 1)",floating_counter_border:"rgba(146, 158, 170, 1)",floating_counter_color:"rgba(255, 255, 255, 1)",floating_social_animate_icons:0,drop_shadow:0,drop_shadow_x:0,drop_shadow_y:0,drop_shadow_blur:0,drop_shadow_spread:0,drop_shadow_color:"rgba(0,0,0,0.2)",floating_inline_count:0,customize_widget_colors:0,widget_icon_bg_color:"rgba(146, 158, 170, 1)",widget_icon_color:"rgba(255, 255, 255, 1)",widget_bg_color:"rgba(146, 158, 170, 1)",widget_animate_icons:0,widget_drop_shadow:0,widget_drop_shadow_x:0,widget_drop_shadow_y:0,widget_drop_shadow_blur:0,widget_drop_shadow_spread:0,widget_drop_shadow_color:"rgba(0,0,0,0.2)",widget_inline_count:0,widget_counter_border:"rgba(146, 158, 170, 1)",widget_counter_color:"rgba(255, 255, 255, 1)"}}),s=Hustle.get("Models.M").extend({defaults:{floating_social_enabled:!0,widget_enabled:!0,shortcode_enabled:!0,conditions:"",location_type:"screen",location_target:"",location_align_x:"left",location_align_y:"top",location_top:0,location_bottom:0,location_right:0,location_left:0},initialize:function(e){if(_.extend(this,e),!(this.get("conditions")instanceof Backbone.Model)){_.isEmpty(this.get("conditions"))&&_.isArray(this.get("conditions"))&&(this.conditions={});var t=Hustle.get("Model");this.set("conditions",new t(this.conditions))}this.on("change",this.user_has_change,this)}}),o=Hustle.get("Models.M").extend({defaults:{widget:"",shortcode:""}});return{Base:e,Content:t,Design:i,Display_Settings:s,Types:o}}),Hustle.define("SShare.Settings_View",function(e,t,i){"use strict";return Hustle.View.extend(_.extend({},Hustle.get("Mixins.Model_Updater"),{template:Hustle.template("wpmudev-hustle-sshare-section-settings-tpl"),target_container:e("#wpmudev-hustle-box-section-settings"),message_editor:!1,events:{"click .wpmudev-copy button":"copy_shortcode"},init:function(e){return this.stopListening(this.model,"change",this.model_updated),this.listenTo(this.model,"change",this.model_updated),this.conditions_view=e.conditions_view,this.listenTo(this.model,"change:enabled",this.toggle_panel),this.conditions_view.on("toggle_condition",this.update_conditions_label),this.conditions_view.on("change:update_view_label",this.update_conditions_label),this.render()},render:function(){if(this.target_container.length){var e=this.model.toJSON();return this.setElement(this.template(_.extend({module_type:"social_sharing"},e))),this.$(".wph-conditions").replaceWith(this.conditions_view.$el),this}},after_render:function(){this.target_container.length},toggle_panel:function(e){this.$(".switch-wrap").toggleClass("open closed"),this.$el.find("#wph-floating-social-condition-labels").toggle()},update_conditions_label:function(t){e("#wph-floating-social-condition-labels").html(t.get_all_conditions_labels())},model_updated:function(e){var t=e.changed;if(console.log(t),"location_type"in t){var i=this.$("#wpmudev-sshare-selector-location-options");"selector"===t.location_type?i.removeClass("wpmudev-hidden"):i.addClass("wpmudev-hidden")}if("location_align_x"in t){var s=this.$("#wpmudev-floating-horizontal-left"),o=this.$("#wpmudev-floating-horizontal-right");"left"===t.location_align_x?(s.addClass("current"),o.removeClass("current")):(s.removeClass("current"),o.addClass("current"))}if("location_align_y"in t){var n=this.$("#wpmudev-floating-vertical-top"),a=this.$("#wpmudev-floating-vertical-bottom");"top"===t.location_align_y?(n.addClass("current"),a.removeClass("current")):(n.removeClass("current"),a.addClass("current"))}},copy_shortcode:function(t){var i=e(t.target),s=i.siblings("input");
s.prop("disabled",!1).select(),document.execCommand("copy"),s.prop("disabled",!0)}}))}),Hustle.define("SShare.View",function(e,t,i){"use strict";return Hustle.View.extend({el:".wpmudev-hustle-sshare-wizard-view",message_box_tpl:Optin.template("wpoi-social-sharing-message-box-tpl"),preview:!1,preview_model:!1,initial_data:new Backbone.Model({content:""}),events:{"click .wpmudev-button-save":"save_changes","click .wpmudev-button-continue":"save_continue","click .wpmudev-button-finish":"save_finish","click .wpmudev-button-cancel":"cancel","click .wpmudev-button-back":"back","change .wpmudev-menu .wpmudev-select":"mobile_navigate"},init:function(t){return this.content_view=t.content_view,this.design_view=t.design_view,this.settings_view=t.settings_view,this.stopListening(this.content_view.model,"change",this.update_base_model),this.stopListening(this.design_view.model,"change",this.design_view_changed),this.listenTo(this.content_view.model,"change",this.update_base_model),this.listenTo(this.design_view.model,"change",this.design_view_changed),e(document).on("change keyup keypress","input[name=module_name]",e.proxy(this.validate_modal_name,this)),this.render()},render:function(){this.content_view.target_container.html(""),this.content_view.render(),this.content_view.delegateEvents(),this.content_view.target_container.append(this.content_view.$el),this.content_view.after_render(),this.render_design_view(),this.settings_view.target_container.html(""),this.settings_view.render(),this.settings_view.delegateEvents(),this.settings_view.target_container.append(this.settings_view.$el),this.settings_view.after_render(),Hustle.Events.trigger("modules.view.rendered",this)},render_design_view:function(){this.design_view.target_container.html(""),this.design_view.render_design(),this.design_view.delegateEvents(),this.design_view.target_container.append(this.design_view.$el),this.design_view.after_render()},design_view_changed:function(e){var t=Object.keys(e.changed)[0];this.design_view.excluded_rerender.indexOf(t)!==-1?this.design_view.model_updated(e.changed):this.render_design_view()},sanitize_data:function(){_.isEmpty(this.model.get("module_name"))&&this.model.set("module_name",this.content_view.model.get("module_name"))},save:function(t){if(!Module.Validate.validate_module_name())return!1;this.sanitize_data();var i=this,s=this.model.toJSON(),o=this.content_view.model.toJSON(),n=this.design_view.model.toJSON(),a=this.settings_view.model.toJSON();return o=this.content_view.get_social_icons_data(o),e.ajax({url:ajaxurl,type:"POST",data:{action:"hustle_save_sshare_module",_ajax_nonce:t.data("nonce"),id:t.data("id")?t.data("id"):"-1",module:s,content:o,design:n,settings:a,shortcode_id:i._get_shortcode_id()},complete:function(e){e.responseJSON}})},save_changes:function(t){t.preventDefault();var i=this,s=e(t.currentTarget);i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var o=this.save(s);o?o.done(function(t){if("string"==typeof t&&(t=JSON.parse(t)),t.success){var o=window.location.pathname+window.location.search;o.indexOf("&id=")===-1&&(o=o+"&id="+t.data,window.history.replaceState({},"",o),i.$(".wpmudev-menu-services-link a, .wpmudev-menu-design-link a, .wpmudev-menu-settings-link a").each(function(){e(this).attr("href",e(this).data("link")+"&id="+t.data)})),s.data("id",t.data),s.siblings().data("id",t.data),Module.hasChanges=!1;var n=optin_vars.current.section||!1;if("settings"===n){var a=t.data;if(s.hasClass("wpmudev-button-finish"))return window.location.replace("?page="+optin_vars.current.listing_page+"&module="+a)}}}).always(function(){i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_continue:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0);var s=this.save(e(t.currentTarget));s?s.done(function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.success){var t=e.data,s=optin_vars.current.section||!1,o="";return window.onbeforeunload=null,s&&"services"!==s?"design"===s&&(o=i.$(".wpmudev-menu-settings-link a").data("link")):o=i.$(".wpmudev-menu-design-link a").data("link"),o.indexOf("&id")===-1&&(o+="&id="+t),window.location.replace(o)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},save_finish:function(t){t.preventDefault();var i=this;i.$(".wpmudev-button-save, .wpmudev-button-continue").addClass("wpmudev-button-onload").prop("disabled",!0),this.model.set("active",1,{silent:!0});var s=this.save(e(t.currentTarget));s?s.done(function(e){if(e.success){var t=e.data;return window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page+"&module="+t)}}):i.$(".wpmudev-button-save, .wpmudev-button-continue").removeClass("wpmudev-button-onload").prop("disabled",!1)},cancel:function(e){e.preventDefault(),window.onbeforeunload=null,window.location.replace("?page="+optin_vars.current.listing_page)},back:function(e){e.preventDefault();var t=this;t.$(".wpmudev-button-back").addClass("wpmudev-button-onload");var i=optin_vars.current.section;window.onbeforeunload=null,"design"===i?window.location.replace(this.$(".wpmudev-menu-services-link a").attr("href")):"settings"===i&&window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href"))},mobile_navigate:function(e){e.preventDefault();var t=e.target.value;"services"===t?window.location.replace(this.$(".wpmudev-menu-services-link a").attr("href")):"design"===t?window.location.replace(this.$(".wpmudev-menu-design-link a").attr("href")):window.location.replace(this.$(".wpmudev-menu-settings-link a").attr("href"))},validate_modal_name:function(e){Module.Validate.on_change_validate_module_name(e)},update_base_model:function(e){var t=e.changed;"module_name"in t&&this.model.set("module_name",t.module_name,{silent:!0})},_get_shortcode_id:function(){return this.content_view.model.get("module_name").trim().toLowerCase().replace(/\s+/g,"-")}})}),Hustle.define("Popup.Module",function(){"use strict";!function(){if("hustle_page_hustle_popup_listing"===pagenow){var e=Hustle.get("Popup.Listing");new e}}(),function(){if("hustle_page_hustle_popup"===pagenow){var e=Hustle.get("Pop_Up.View"),t=Hustle.get("Pop_Up.Content_View"),i=Hustle.get("Pop_Up.Design_View"),s=Hustle.get("Pop_Up.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("Pop_Up.Models.Base"),a=Hustle.get("Pop_Up.Models.Content"),d=Hustle.get("Pop_Up.Models.Design"),l=Hustle.get("Pop_Up.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new d(optin_vars.current.design||{}),u=new l(optin_vars.current.settings||{});return new e({model:r,content_view:new t({model:c,module_id:r.get("module_id")}),design_view:new i({model:_,use_email_collection:c.get("use_email_collection")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"pop-up"})})})}}()}),Hustle.define("Slidein.Module",function(){"use strict";!function(){if("hustle_page_hustle_slidein_listing"===pagenow){var e=Hustle.get("Slidein.Listing");new e}}(),function(){if("hustle_page_hustle_slidein"===pagenow){var e=Hustle.get("Slidein.View"),t=Hustle.get("Slidein.Content_View"),i=Hustle.get("Slidein.Design_View"),s=Hustle.get("Slidein.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("Slidein.Models.Base"),a=Hustle.get("Slidein.Models.Content"),d=Hustle.get("Slidein.Models.Design"),l=Hustle.get("Slidein.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new d(optin_vars.current.design||{}),u=new l(optin_vars.current.settings||{});return new e({model:r,content_view:new t({model:c,module_id:r.get("module_id")}),design_view:new i({model:_,use_email_collection:c.get("use_email_collection")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"slidein"})})})}}()}),Hustle.define("Embedded.Module",function(){"use strict";!function(){if("hustle_page_hustle_embedded_listing"===pagenow){var e=Hustle.get("Embedded.Listing");new e}}(),function(){if("hustle_page_hustle_embedded"===pagenow){var e=Hustle.get("Embedded.View"),t=Hustle.get("Embedded.Content_View"),i=Hustle.get("Embedded.Design_View"),s=Hustle.get("Embedded.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("Embedded.Models.Base"),a=Hustle.get("Embedded.Models.Content"),d=Hustle.get("Embedded.Models.Design"),l=Hustle.get("Embedded.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new d(optin_vars.current.design||{}),u=new l(optin_vars.current.settings||{});return new e({model:r,content_view:new t({model:c,module_id:r.get("module_id")}),design_view:new i({model:_,use_email_collection:c.get("use_email_collection")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"embedded"})})})}}()}),Hustle.define("SShare.Module",function(e){"use strict";!function(){if("hustle_page_hustle_sshare_listing"===pagenow){var e=Hustle.get("SShare.Listing");new e}}(),function(){if("hustle_page_hustle_sshare"===pagenow&&!parseInt(optin_vars.current.is_ss_limited)){var e=Hustle.get("SShare.View"),t=Hustle.get("SShare.Content_View"),i=Hustle.get("SShare.Design_View"),s=Hustle.get("SShare.Settings_View"),o=Hustle.get("Settings.Conditions_View"),n=Hustle.get("SShare.Models.Base"),a=Hustle.get("SShare.Models.Content"),d=Hustle.get("SShare.Models.Design"),l=Hustle.get("SShare.Models.Display_Settings"),r=new n(optin_vars.current.data||{}),c=new a(optin_vars.current.content||{}),_=new d(optin_vars.current.design||{}),u=new l(optin_vars.current.settings||{});return new e({model:r,content_view:new t({model:c}),design_view:new i({model:_,social_icons:c.get("social_icons"),service_type:c.get("service_type"),click_counter:c.get("click_counter")}),settings_view:new s({model:u,conditions_view:new o({model:u.get("conditions"),type:"social_sharing"})})})}}()}),Hustle.define("Dashboard.View",function(e,t,i){"use strict";if("toplevel_page_hustle"===pagenow&&!_.isTrue(optin_vars.is_free)){var s=Backbone.View.extend({el:".wph-dashboard",conversions_chart:null,chart_data:null,chart_options:null,empty_chart:!0,default_dataset_options:{fill:!1,cubicInterpolationMode:"monotone",borderCapStyle:"butt",borderDash:[],borderWidth:1,borderDashOffset:0,borderJoinStyle:"miter",pointBackgroundColor:"#fff",pointBorderWidth:3,pointHoverRadius:5,pointHoverBorderColor:"rgba(220,220,220,1)",pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,spanGaps:!1},events:{"click .wph-icon.i-close":"close","click .wpmudev-box-action":"hide"},initialize:function(e){return _.isEmpty(optin_vars.top_active_modules)||"undefined"==typeof google||(google.charts.load("current",{packages:["corechart","line"]}),google.charts.setOnLoadCallback(this.drawLineStyles)),this.render()},drawLineStyles:function(){var e=new google.visualization.DataTable;e.addColumn("date","Day");var t=[];if(_.each(optin_vars.top_active_modules,function(i,s){e.addColumn("number",i.module_name),t.push(i.color)}),!_.isEmpty(optin_vars.graph_date_conversions)){_.each(optin_vars.graph_date_conversions,function(t,i){var s=[new Date(t.formatted)];_.each(t.conversions,function(e){s.push(e)}),e.addRows([s])});var i={curveType:"function",legend:{position:"none"},animation:{startup:!0,duration:500,easing:"in"},colors:t,pointSize:5,lineWidth:1,interpolateNulls:!0,chartArea:{top:10,right:10,bottom:40,left:40},hAxis:{format:"d MMM",viewWindow:{min:new Date(optin_vars.graph_min_date),max:new Date(optin_vars.graph_max_date)},baseline:new Date(optin_vars.graph_min_date),baselineColor:"#D8D8D8",gridlines:{color:"transparent",count:5},textStyle:{color:"#666666",fontSize:14,fontName:"Roboto Condensed"}},vAxis:{viewWindow:{min:0},gridlines:{color:"#D8D8D8",count:5},baseline:0,baselineColor:"#D8D8D8",textStyle:{color:"#666666",fontSize:14,fontName:"Roboto Condensed"}},tooltip:{showColorCode:!0}},s=new google.visualization.LineChart(document.getElementById("hustle_chart"));s.draw(e,i)}},render:function(){e(".hustle-free-version-create").on("click",this.show_upgrade_modal),e(".wpmudev-box-head .wpmudev-icon.wpmudev-i_close").on("click",this.close_modal),e(".tabs-header li label").on("click",this.toggle_overview),e(".can-close .wph-icon.i-close").on("click",this.close),e(".can-hide .wpmudev-box-action").on("click",this.hide),e("a#sshare_view_all_stats").on("click",this.toggle_sshare_modal),e("#wpmudev-dashboard-widget-modules .wpmudev-box-head").on("click",this.toggle_module_accordion),this.handle_sshare_modal_pagination();var t=e("#conversions_chart");if(t.length)if(this.empty_chart){t.parent().css("height","100%").css("width","100%").css("display","table");var i=e('<div class="graph-no-data">'+optin_vars.messages.dashboard.not_enough_data+"</div>");i.css("display","table-cell").css("text-align","center").css("vertical-align","middle"),t.replaceWith(i)}else{var s=t.closest("#wph-module-stats").find("table.wph-table.wph-module--stats"),o=s.outerHeight();o>230?t.attr("height",o):t.attr("height",230);for(var n in this.chart_data.datasets)this.chart_data.datasets[n].data&&(this.chart_data.datasets[n].data=_.sortBy(this.chart_data.datasets[n].data,"x"));this.conversions_chart=new Chart(t,{type:"line",data:this.chart_data,options:this.chart_options})}},toggle_module_accordion:function(t){var i=e(t.target),s=i.parents(".wpmudev-box").find(".wpmudev-box-body"),o=i.parents(".wpmudev-box").find(".wpmudev-box-head");s.slideToggle("fast",function(){o.toggleClass("wpmudev-collapsed"),s.toggleClass("wpmudev-hidden")})},close_modal:function(t){t.preventDefault();var i=e(t.target).closest(".wpmudev-modal");i.removeClass("wpmudev-modal-active")},close:function(t){t.preventDefault();var i=e(t.target).closest(".wpmudev-row"),s=e(t.target).closest("#wph-welcome"),o=s.data("nonce");i.slideToggle(300,function(){e.ajax({url:ajaxurl,type:"POST",data:{action:"persist_new_welcome_close",_ajax_nonce:o},complete:function(e){i.remove()}})})},hide:function(t){t.preventDefault();var i=e(t.target).closest(".wpmudev-box-head").next(".wpmudev-box-body");i.toggleClass(".wpmudev-hide")},show_upgrade_modal:function(t){"undefined"!=typeof t&&t.preventDefault();var i=e("#wph-upgrade-modal");i.addClass("wpmudev-modal-active")},toggle_overview:function(t){t.preventDefault();var i=e(t.target),s=i.find("input").val(),o=e("#wph-"+s+"-overview"),n=i.parent();e(".wph-modules-overview").not(o).removeClass("current"),o.addClass("current"),e(".tabs-header li").not(n).removeClass("current"),n.addClass("current")},toggle_sshare_modal:function(t){t.preventDefault();var i=e("#wph-cumulative-shares-modal");i.addClass("wpmudev-modal-active")},handle_sshare_modal_pagination:function(){e("li.wph-sshare--prev_page a").on("click",e.proxy(this.sshare_modal_prev,this)),e("li.wph-sshare--next_page a").on("click",e.proxy(this.sshare_modal_next,this)),e("li.wph-sshare--page_number a").on("click",e.proxy(this.sshare_modal_goto,this))},sshare_modal_prev:function(t){t.preventDefault(),t.stopImmediatePropagation();var i=e(t.target).closest("li"),s=i.parent(),o=s.data("nonce"),n=s.find("li.wph-sshare--current_page"),a=s.find("li.wph-sshare--page_number"),d=s.find("li.wph-sshare--next_page"),l=(parseInt(s.data("total")),parseInt(n.data("page"))),r=parseInt(i.data("page"));n.data("page",r);var c=d.find("svg");if(d.data("page",l),c.length&&d.html('<a href="#">'+c[0].outerHTML+"</a>"),1==r){var _=i.find("svg");_.length&&i.html("<span>"+_[0].outerHTML+"</span>")}if(a.length)a.data("page",l),a.find("a").text(l);else{var u='<li class="wph-link wph-sshare--page_number" data-page="'+l+'"><a href="#">'+l+"</a></li>";e(u).insertAfter(n)}n.find("span").text(r),i.data("page",r-1),this.handle_sshare_modal_pagination(),this.sshare_show_page_content(r,o)},sshare_modal_next:function(t){t.preventDefault(),t.stopImmediatePropagation();var i=e(t.target).closest("li"),s=i.parent(),o=s.data("nonce"),n=s.find("li.wph-sshare--current_page"),a=s.find("li.wph-sshare--page_number"),d=s.find("li.wph-sshare--prev_page"),l=parseInt(s.data("total")),r=parseInt(n.data("page")),c=parseInt(i.data("page"));n.data("page",c);var _=d.find("svg");if(d.data("page",r),_.length&&d.html('<a href="#">'+_[0].outerHTML+"</a>"),c<l){if(a.length){var u=c+1;a.data("page",u),a.find("a").text(u),i.data("page",u)}}else{a.length&&a.remove();var p=i.find("svg");p.length&&i.html("<span>"+p[0].outerHTML+"</span>")}n.find("span").text(c),this.handle_sshare_modal_pagination(),this.sshare_show_page_content(c,o)},sshare_modal_goto:function(t){t.preventDefault(),t.stopImmediatePropagation();var i=e(t.target).closest("li"),s=i.parent();s.find("li.wph-sshare--next_page a").click()},sshare_show_page_content:function(t,i){var s=Optin.template("wpmudev-hustle-sshare-stats-modal-tpl"),o=e("#wph-cumulative-shares-modal table.wpmudev-table-paginated tbody");o.html('<div class="wph-sshare--loading_stats"><span class="on-action">Loading...</span></div>'),e.ajax({url:ajaxurl,type:"POST",data:{action:"sshare_show_page_content",page_id:t,_ajax_nonce:i},complete:function(e){var t=e.responseJSON.data,i=s(_.extend({},t));o.html(i)}})}});new s}}),function(e,t){"use strict";if("hustle_page_hustle_settings"===pagenow){var i=Hustle.get("Settings.Modules_Activity"),s=Hustle.get("Settings.Mail_Settings"),o=Hustle.get("Settings.Unsubscribe_Settings"),n=Hustle.get("Settings.Gdpr_Settings"),a=Hustle.get("Settings.reCAPTCHA_Settings");new i,new s,new o,new n,new a;e(".wpmudev-box .wpmudev-box-head").on("click",function(t){var i=e(t.target),s=i.closest(".wpmudev-box").children(".wpmudev-box-body"),o=i.closest(".wpmudev-box").children(".wpmudev-box-head");s.slideToggle("fast",function(){o.toggleClass("wpmudev-collapsed"),s.toggleClass("wpmudev-hidden")})}),e("#wpmudev-settings-widget-unsubscribe .toggle-checkbox").on("change",function(t){var i=e(t.target),s=i.closest(".wpmudev-switch-labeled").next(".wpmudev-box-gray"),o=i.closest("form"),n=o.attr("id"),a="wpmudev-settings-unsubscribe-messages"===n?"hustle_toggle_unsubscribe_messages_settings":"hustle_toggle_unsubscribe_email_settings";i.prop("checked")?s.removeClass("wpmudev-hidden"):s.addClass("wpmudev-hidden"),e.ajax({url:ajaxurl,type:"POST",data:{action:a,enabled:i.prop("checked"),_ajax_nonce:o.data("nonce")},success:function(){}})})}}(jQuery,document);
//# sourceMappingURL=maps/admin.min.js.map
